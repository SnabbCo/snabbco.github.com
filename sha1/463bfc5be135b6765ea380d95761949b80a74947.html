<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Luke Gorrie" />
  <meta name="author" content="Max Rottenkolber" />
  <meta name="author" content="Nikolay Nikolaev" />
  <meta name="author" content="Hans Huebner" />
  <meta name="author" content="Alexander Gall" />
  <meta name="author" content="Javier Guerra" />
  <meta name="author" content="Diego Pino Garcia" />
  <meta name="author" content="Andy Wingo" />
  <meta name="author" content="Antonio Nikishaev" />
  <meta name="author" content="Alexander Altshuler" />
  <meta name="author" content="Rolf Sommerhalder" />
  <meta name="author" content="Pete Kazmier" />
  <meta name="author" content="Katerina Barone-Adesi" />
  <meta name="author" content="Marcel Wiget" />
  <meta name="author" content="Mikhail Nazarov" />
  <meta name="author" content="Justin Cormack" />
  <meta name="author" content="Felix Geißler" />
  <meta name="author" content="Domen Kožar" />
  <meta name="author" content="Cosmin Apreutesei" />
  <meta name="author" content="Carlos Alberto Lopez Perez" />
  <meta name="author" content="Jeff Loughridge" />
  <meta name="author" content="Kacper Wysocki" />
  <meta name="author" content="Diego Pino" />
  <meta name="author" content="Vladimir Fedin" />
  <meta name="author" content="Tomas Korcak" />
  <meta name="author" content="Tim Upthegrove" />
  <meta name="author" content="Tim LaBerge" />
  <meta name="author" content="Stevan Markovic" />
  <meta name="author" content="Simon Leinen" />
  <meta name="author" content="Kristian Larsson" />
  <meta name="author" content="Kristian Kielhofner" />
  <meta name="author" content="Jon Olsson" />
  <meta name="author" content="Jay Fenton" />
  <meta name="author" content="James Cunningham" />
  <meta name="author" content="Hui Xiang" />
  <meta name="author" content="Gernot Nusshall" />
  <meta name="author" content="Edward Hope-Morley" />
  <meta name="author" content="Anshul Makkar" />
  <meta name="author" content="Andy Chong" />
  <meta name="author" content="Alex Kordic" />
  <meta name="author" content="Alexander Spyridakis" />
  <meta name="author" content="Adrián Pérez de Castro" />
  <title>Snabb Reference Manual</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link href="data:text/css,%2F%2A%20Rudimentary%20CSS%20for%20SnabbSwitch%20HTML%20documentation%2E%20%2A%2F%0A%0A%23TOC%20%7B%0A%20%20%20%20position%3A%20fixed%3B%0A%20%20%20%20overflow%3A%20scroll%3B%0A%20%20%20%20top%3A%200%3B%0A%20%20%20%20left%3A%200%3B%0A%20%20%20%20width%3A%2019%2E6em%3B%0A%20%20%20%20height%3A%20100%25%3B%0A%20%20%20%20margin%3A%200%3B%0A%20%20%20%20padding%3A%200%3B%0A%7D%0A%23TOC%20%3E%20header%20%7B%0A%20%20%20%20margin%2Dtop%3A%201%2E4em%3B%0A%7D%0A%23TOC%20ul%2C%20%23TOC%20ol%20%7B%0A%20%20%20%20padding%2Dleft%3A%201%2E4em%3B%0A%20%20%20%20margin%3A%200%3B%0A%7D%0A%23TOC%20%3E%20ul%2C%20%23TOC%20%3E%20ol%20%7B%0A%20%20%20%20padding%2Dtop%3A%200%2E7em%3B%0A%20%20%20%20width%3A%2025%2E2em%3B%0A%7D%0A%0Abody%20%7B%0A%20%20%20%20margin%3A%200%200%200%2021em%3B%0A%7D%0A%0A%0Abody%20%7B%0A%20%20%20%20max%2Dwidth%3A%2040em%3B%0A%20%20%20%20font%2Dfamily%3A%20sans%2Dserif%3B%0A%7D%0A%0Acode%2C%20pre%20%7B%0A%20%20%20%20color%3A%20%23333%3B%0A%20%20%20%20background%3A%20%23f7f7f7%3B%0A%7D%0A%0Apre%20%7B%0A%20%20%20%20padding%3A%200%2E6em%3B%0A%7D%0A%0Apre%20%3E%20code%20%7B%0A%20%20%20%20padding%3A%200%3B%0A%20%20%20%20background%3A%20none%3B%0A%7D%0A%0Acode%20%7B%0A%20%20%20%20padding%3A%200%200%2E2em%200%2E1em%200%2E2em%3B%0A%20%20%20%20%0A%7D%0A%0Ap%2C%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%201%2E5%3B%0A%7D%0A%0Ap%2Ecaption%20%7B%0A%20%20%20%20display%3A%20none%3B%0A%7D%0A%0Ah1%2Etitle%20%7B%0A%20%20%20%20font%2Dsize%3A%202em%3B%0A%7D%0A%0Ah2%2Eauthor%20%7B%0A%20%20%20%20display%3A%20inline%3B%0A%20%20%20%20font%2Dsize%3A%20small%3B%0A%20%20%20%20font%2Dweight%3A%20normal%3B%0A%20%20%20%20white%2Dspace%3A%20nowrap%3B%0A%7D%0A%0Ah2%2Eauthor%3Aafter%20%7B%0A%20%20content%3A%20%27%2C%20%27%3B%0A%20%20white%2Dspace%3A%20normal%3B%0A%7D%0A%0Ah2%2Eauthor%3Anth%2Dlast%2Dchild%28%2Dn%2B2%29%3Aafter%20%7B%0A%20%20content%3A%20%27%27%3B%0A%7D%0A%0Ah3%2Edate%20%7B%0A%20%20%20%20font%2Dfamily%3A%20monospace%3B%0A%20%20%20%20font%2Dsize%3A%20medium%3B%0A%20%20%20%20font%2Dweight%3A%20normal%3B%0A%7D%0A%0Adiv%23TOC%20a%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%0A%0Ah1%20a%2C%20h2%20a%2C%20h3%20a%2C%20h4%20a%2C%20h5%20a%2C%20h6%20a%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20none%3B%0A%20%20%20%20color%3A%20black%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20%20%20font%2Dsize%3A%201%2E8em%3B%0A%7D%0Ah2%20%7B%0A%20%20%20%20font%2Dsize%3A%201%2E6em%3B%0A%7D%0Ah3%20%7B%0A%20%20%20%20font%2Dsize%3A%201%2E4em%3B%0A%7D%0Ah4%20%7B%0A%20%20%20%20font%2Dsize%3A%201%2E2em%3B%0A%7D%0Ah5%20%7B%0A%20%20%20%20font%2Dsize%3A%201%2E0em%3B%0A%7D%0Ah6%20%7B%0A%20%20%20%20font%2Dweight%3A%20normal%3B%0A%20%20%20%20font%2Dsize%3A%201%2E0em%3B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%0A%7D%0A%0Adiv%2Efigure%20%3E%20img%20%7B%0A%20%20%20%20display%3A%20block%3B%0A%20%20%20%20margin%3A%20auto%3B%0A%7D%0A" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="header">
<h1 class="title">Snabb Reference Manual</h1>
<h2 class="author">Luke Gorrie</h2>
<h2 class="author">Max Rottenkolber</h2>
<h2 class="author">Nikolay Nikolaev</h2>
<h2 class="author">Hans Huebner</h2>
<h2 class="author">Alexander Gall</h2>
<h2 class="author">Javier Guerra</h2>
<h2 class="author">Diego Pino Garcia</h2>
<h2 class="author">Andy Wingo</h2>
<h2 class="author">Antonio Nikishaev</h2>
<h2 class="author">Alexander Altshuler</h2>
<h2 class="author">Rolf Sommerhalder</h2>
<h2 class="author">Pete Kazmier</h2>
<h2 class="author">Katerina Barone-Adesi</h2>
<h2 class="author">Marcel Wiget</h2>
<h2 class="author">Mikhail Nazarov</h2>
<h2 class="author">Justin Cormack</h2>
<h2 class="author">Felix Geißler</h2>
<h2 class="author">Domen Kožar</h2>
<h2 class="author">Cosmin Apreutesei</h2>
<h2 class="author">Carlos Alberto Lopez Perez</h2>
<h2 class="author">Jeff Loughridge</h2>
<h2 class="author">Kacper Wysocki</h2>
<h2 class="author">Diego Pino</h2>
<h2 class="author">Vladimir Fedin</h2>
<h2 class="author">Tomas Korcak</h2>
<h2 class="author">Tim Upthegrove</h2>
<h2 class="author">Tim LaBerge</h2>
<h2 class="author">Stevan Markovic</h2>
<h2 class="author">Simon Leinen</h2>
<h2 class="author">Kristian Larsson</h2>
<h2 class="author">Kristian Kielhofner</h2>
<h2 class="author">Jon Olsson</h2>
<h2 class="author">Jay Fenton</h2>
<h2 class="author">James Cunningham</h2>
<h2 class="author">Hui Xiang</h2>
<h2 class="author">Gernot Nusshall</h2>
<h2 class="author">Edward Hope-Morley</h2>
<h2 class="author">Anshul Makkar</h2>
<h2 class="author">Andy Chong</h2>
<h2 class="author">Alex Kordic</h2>
<h2 class="author">Alexander Spyridakis</h2>
<h2 class="author">Adrián Pérez de Castro</h2>
<h3 class="date">Version 463bfc5, Fri Apr 29 15:49:54 2016 +0200</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#snabb-api">Snabb API</a><ul>
<li><a href="#app">App</a></li>
<li><a href="#config-core.config">Config (core.config)</a></li>
<li><a href="#engine-core.app">Engine (core.app)</a></li>
<li><a href="#link-core.link">Link (core.link)</a></li>
<li><a href="#packet-core.packet">Packet (core.packet)</a></li>
<li><a href="#memory-core.memory">Memory (core.memory)</a></li>
<li><a href="#lib-core.lib">Lib (core.lib)</a></li>
<li><a href="#main">Main</a></li>
</ul></li>
<li><a href="#basic-apps-apps.basic.basic_apps">Basic Apps (apps.basic.basic_apps)</a><ul>
<li><a href="#source">Source</a></li>
<li><a href="#join">Join</a></li>
<li><a href="#split">Split</a></li>
<li><a href="#sink">Sink</a></li>
<li><a href="#tee">Tee</a></li>
<li><a href="#repeater">Repeater</a></li>
</ul></li>
<li><a href="#intel-82599-ethernet-controller-apps">Intel 82599 Ethernet Controller Apps</a><ul>
<li><a href="#intel10g-apps.intel.intel_app">Intel10G (apps.intel.intel_app)</a><ul>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#performance">Performance</a></li>
<li><a href="#hardware-limits">Hardware limits</a></li>
</ul></li>
<li><a href="#intel1g-apps.intel.intel1g.intel1g">Intel1G (apps.intel.intel1g.intel1g)</a><ul>
<li><a href="#configuration-1">Configuration</a></li>
</ul></li>
<li><a href="#loadgen-apps.intel.loadgen">LoadGen (apps.intel.loadgen)</a><ul>
<li><a href="#configuration-2">Configuration</a></li>
<li><a href="#performance-1">Performance</a></li>
</ul></li>
</ul></li>
<li><a href="#solarflare-ethernet-controller-apps">Solarflare Ethernet Controller Apps</a><ul>
<li><a href="#solarflare-apps.solarflare.solarflare">Solarflare (apps.solarflare.solarflare)</a><ul>
<li><a href="#configuration-3">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#ratelimiter-app-apps.rate_limiter.rate_limiter">RateLimiter App (apps.rate_limiter.rate_limiter)</a><ul>
<li><a href="#configuration-4">Configuration</a></li>
<li><a href="#performance-2">Performance</a></li>
</ul></li>
<li><a href="#pcapfilter-app-apps.packet_filter.pcap_filter">PcapFilter App (apps.packet_filter.pcap_filter)</a><ul>
<li><a href="#configuration-5">Configuration</a></li>
</ul></li>
<li><a href="#ipv6-apps">IPv6 Apps</a><ul>
<li><a href="#nd_light-apps.ipv6.nd_light">Nd_light (apps.ipv6.nd_light)</a><ul>
<li><a href="#configuration-6">Configuration</a></li>
</ul></li>
<li><a href="#simplekeyedtunnel-apps.keyed_ipv6_tunnel.tunnel">SimpleKeyedTunnel (apps.keyed_ipv6_tunnel.tunnel)</a><ul>
<li><a href="#configuration-7">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#vhostuser-app-apps.vhost.vhost_user">VhostUser App (apps.vhost.vhost_user)</a><ul>
<li><a href="#configuration-8">Configuration</a></li>
</ul></li>
<li><a href="#pcapreader-and-pcapwriter-apps-apps.pcap.pcap">PcapReader and PcapWriter Apps (apps.pcap.pcap)</a><ul>
<li><a href="#configuration-9">Configuration</a></li>
</ul></li>
<li><a href="#vpws-app-apps.vpn.vpws">VPWS App (apps.vpn.vpws)</a><ul>
<li><a href="#configuration-10">Configuration</a></li>
</ul></li>
<li><a href="#rawsocket-app-apps.socket.raw">RawSocket App (apps.socket.raw)</a><ul>
<li><a href="#configuration-11">Configuration</a></li>
</ul></li>
<li><a href="#libraries">Libraries</a><ul>
<li><a href="#ip-checksum-lib.checksum">IP checksum (lib.checksum)</a></li>
<li><a href="#ctable-lib.ctable">Ctable (lib.ctable)</a></li>
<li><a href="#pmu-lib.pmu">PMU (lib.pmu)</a></li>
<li><a href="#hardware">Hardware</a><ul>
<li><a href="#pci-lib.hardware.pci">PCI (lib.hardware.pci)</a></li>
<li><a href="#register-lib.hardware.register">Register (lib.hardware.register)</a></li>
</ul></li>
<li><a href="#protocols">Protocols</a><ul>
<li><a href="#protocol-header-lib.protocol.header">Protocol Header (lib.protocol.header)</a></li>
<li><a href="#ethernet-lib.protocol.ethernet">Ethernet (lib.protocol.ethernet)</a></li>
<li><a href="#ipv4-lib.protocol.ipv4">IPv4 (lib.protocol.ipv4)</a></li>
<li><a href="#ipv6-lib.protocol.ipv6">IPv6 (lib.protocol.ipv6)</a></li>
<li><a href="#tcp-lib.protocol.tcp">TCP (lib.protocol.tcp)</a></li>
<li><a href="#udp-lib.protocol.udp">UDP (lib.protocol.udp)</a></li>
<li><a href="#gre-lib.protocol.gre">GRE (lib.protocol.gre)</a></li>
<li><a href="#icmp-lib.protocol.icmp.header">ICMP (lib.protocol.icmp.header)</a></li>
<li><a href="#datagram-lib.protocol.datagram">Datagram (lib.protocol.datagram)</a></li>
</ul></li>
<li><a href="#snabb-nfv">Snabb NFV</a><ul>
<li><a href="#nfv-config-program.snabbnfv.nfvconfig">NFV config (program.snabbnfv.nfvconfig)</a></li>
<li><a href="#snabbnfv-traffic">snabbnfv traffic</a></li>
<li><a href="#snabbnfv-neutron2snabb">snabbnfv neutron2snabb</a></li>
</ul></li>
<li><a href="#watchdog-lib.watchdog.watchdog">Watchdog (lib.watchdog.watchdog)</a></li>
</ul></li>
</ul>
</div>
<p><em><strong>Note:</strong> This reference manual is a draft. The API defined in this document is not guaranteed to be stable or complete and future versions of Snabb will introduce backwards incompatible changes. With that being said, discrepancies between this document and the actual Snabb Switch implementation are considered to be bugs. Please report them in order to help improve this document.</em></p>
<h1 id="introduction"><a href="#introduction">Introduction</a></h1>
<p><em>Snabb</em> is an extensible, virtualized, Ethernet networking toolkit. With Snabb you can implement networking applications using the <em>Lua language</em>. Snabb includes all the tools you need to quickly realize your network designs and its really fast too! Furthermore, Snabb is extensible and encourages you to grow the ecosystem to match your requirements.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Architecture" /><p class="caption">Architecture</p>
</div>
<p>The Snabb Core forms a runtime environment (<em>engine</em>) which executes your <em>design</em>. A design is simply a Lua script used to drive the Snabb stack, you can think of it as your top-level “main” routine.</p>
<p>In order to add functionality to the Snabb stack you can load modules into the Snabb engine. These can be Lua modules as well as native code objects. We differentiate between two classes of modules, namely libraries and <em>Apps</em>. Libraries are simple collections of program utilities to be used in your designs, apps or other libraries, just as you might expect. Apps, on the other hand, are code objects that implement a specific interface, which is used by the Snabb engine to organize an <em>App Network</em>.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhIAAAEKCAIAAADIMiuDAAAVVklEQVR42u3df0jU9x/AcdNbc/5Cca3D3Ub9E4fIJpkMyoUMYcIqnLs/RBY0/xFEqD8U9kehxGCOgmDJ/jlBQ0eIkhK1kwIjDY2MEw/1NvPn3Uwtd9pZeqe27/dFH3Ycp6ennufpPR9/jD7XZev9eb0/z/v4M+x/AAD4LIwlAACQDQDANmfjXwAAvCAbAACyAQAgGwAAsgEAIBsAALIBAADZAACQDQAA2QAAkA0AANkAAJANAADIBgCAbAAAyAYAgGwAAMgGAIBsAABANgAAZAMAQDYAAGQDAEA2AABkAwAAsgEAIBsAALIBACAbAACyAQAgGwAAkA0AANnA7qTVasPgG1krBgZkA6FOrob/g29krex2++vXrxcWFpxO5/LyMvMDsgGygbWyYbVap6ambDabxEPKwfyAbIBsYK1s9PX1DQ0NjY+PSznm5+eZH5ANkA2slY2Ojo6enh4px+Tk5NzcHPMDsgGygbWyYTAYpBy9vb0Wi2V2dpb5AdkA2cBa2aivr793715XV9fg4OA///zD/IBsgGxgrWzcvHmzpaXlyZMnz549IxsgGyAbIBsgGwDZIBsgGwDZIBsgGwDZIBsA2QDZIBsA2QDZIBtkA2QDZANkA2QDIBtkA2QDIBtkA2QDIBtkAyAbIBtkAyAbIBtkg2yAbIBsgGyAbCD0lJSU+P6D58gG2QDZADcQYampqUajMcDZCPPC/XdX/nrl4abJpfzMmTMxMTGxsbHyi6GhIbIBsgH4VAIRGRl55cqVwGfDl9/djmxMT08nJSWlp6f//U5aWppGo7HZbGQDZAPwKRuKzMxMi8Wy6tMaGhqys7Ojo6Pz8vLMZvN2Z2ONZ/olG5cuXZI3cvv2beWwqalJDsvLy/0SjMbGRmWtMjIy9Ho92QDZwJ7NhoiPj5fXyB7PKS4uTklJkathd3e3TqdTq9UTExM7crex6nu0RHt7e1ZWVmxsbFxc3PHjx+/evevxphwOx/nz5w8cOBAeHi4PHj16VB6U+wzlORJLOTx27NjWm+G+Vrm5uYmJiQaDgWyAbGDPZkMhtxQ2m015Qm1tbWpq6tzcnPuVcesvzP34TqoHDx6oVKqTJ08ODg7K//bZs2flCTdu3HB//tWrV+U6vry8rDwogZEHnU6ncriwsCCHkpwt/qPq6uo81qqoqKiwsJBsgGxgj2dDaDSa1tZWeYJcB+W1vPvFsbOzc+svzP34IXEJhjxiMpmUw6mpKTk8cuSI+/OfPn3q/kfknkMedG2wt2/fymFERMQW/1GrrpXcfJANkA0ENa1WG7Zl8fHx1dXVSleWlpbcL4UjIyMSleC524iKilr5/+9qgHK4uLjo/keUuw2Hw+Hfu41V12rV/72tkPPLkINswM83EFu828jMzBweHlaeIK+gW1pa3C+FVVVV/rrb8GM2Xrx44ftfpHxsw2q1KodjY2N++djGyrXS6/XJycn+vdvY0PkF2SAb2N5sqFSqK1euyGtz1xOamprUarWkYmZmRsbPbDbLxbGysnKnsrFv3z6PPyiRk0caGhp8/4suXrzo/plUt27dksOysrIt/qOam5vd16q/v1/uDEpLS8kGyAb2ZjZSUlJW/bq/jo6OnJyc+Ph4eY5cFisqKjzeFRPIbCQlJcmhXJFdjzx69Gj//v2HDx9+/Pix0+mUW4eampoTJ06s8Re9fPlS/iHp6enj76SlpcmblSv71j+TqrOz07VWCQkJBQUF8gjZANnAHszGhQsX1v0uI8Hw5X7V1dUHDx70eLCrq0su1omJiXK3JAHIz89/+PDh2n/RwMDAqVOnYt45ffq0XNl3y1eJkw2QDexwNjQazf379318Mt9simyAbCCks6HT6VxfokE2yAbIBsiGn98yPSAbIBsgG2SDbIBsgGyQDbIBskE2QDbIBtkA2QDZIBtkA2QDZINskA2QDZANekA2QDZANsgG2QDZANkgG2QDZINsgGyQDbIBsgGyQTbIBsgGyAbZIBsgGyAb9IBsgGyAbJANsgGyAbJBNsgGyAbZANkgG2QDZANkg2yQDZANkA2yQTZANkA26AHZANkA2SAbZANkA2SDbJANkA2ygZ29rKjV6jD4Ji4ujmyAbCDUsyFmZ2fHxsZMJlN7e/udO3d+h3eyPrJKslayYrJuZANkA6GYDbvd/vz584GBAaPR2NbW9ge8k/WRVZK1khWTdSMbIBsIxWy8efNmenraarXK1bCnp+cxvJP1kVWStZIVk3UjGyAbCMVsOBwOeeEs10F5BT06OvoXvJP1kVWStZIVk3UjGyAbCMVsLC0tyRVQXju/evXKZrO9hHeyPrJKslayYrJuZANkA6GYDcXb/yzDO9cq7brzC7IBsgHOL8gGwGWF8wuQDXBZAecXZANcVsD5BdkAlxVwfkE2wGUFnF+QDXBZAecXZGMX0mq1fGNUF1kNLisIqvPLDg3MDiUbGxt3fgyD+89jsNvtr1+/XlhYcDqdy8vLZAM7e37ZoYHZoWSDodz8UFqt1qmpKZvNJqMpc0k2QDZCYYeSDYZy80PZ19c3NDQ0Pj4uczk/P082QDZCYYeSDYZy80PZ0dHR09Mjczk5OTk3N0c2QDZCYYeSDYZy80NpMBhkLnt7ey0WCz/9DWQjRHYo2WAoNz+U9fX19+7d6+rqGhwc5GdNg2yEyA4lGwzl5ofy5s2bLS0tT548efbsGdnAdpzfkpKSxcVFdmhQ7VCyQTbIBoI3G/Lk1NRUk8nEDiUbZIOhJBtkw6cni8jIyGvXrrFDyQbZ2K0aGxuzs7Ojo6MzMjL0ej3ZwHZnQ5GVlWWxWFZ9WkNDgzKTeXl5ZrOZTUo2yEYQKS4uTklJkXJ0d3fn5uYmJiYaDAaygQBkQ8THx0shPJ7jPpM6nU6tVk9MTLBVyQbZCAp1dXWpqalzc3OuR4qKigoLC8kGApMNxffff2+z2ZQn1NbWesykVKS8vJxskA2yERRkf7a3t7s/0tnZKS/0yAYCmQ1x6NCh1tZWecKqM3ns2DGyQTbIRrAM4tLSkvsjIyMjUVFR/v3OnWq1mmvrHibnd+tDEhMTU11drezKlTOp0WjIBtkgG8FytyFT6P6IXq9PTk7eXUOJ3bXpVsrIyBgeHlaesHImq6qquNsgG2QjWDQ3N8tLRdmWMzMzctjf36/VaktLS8kGApMNlUr1888/u38BYFNTk/tMms1mCUllZSXZIBtkI1h0dnbm5OTEx8fLaiQkJBQUFMgjZAMByIa8RjEajSuf09HR4ZpJSUhFRYXHu63IBtkgGwwlQi4bxcXF637rb3Yo2SAbDCXIRphGozEYDOxQskE2GEpgfTqd7sWLF+xQskE2GEqAHcoOJRubOq/i888/9/gInvK4t0NFV1dXfn7+J598sn///piYmMOHD586dcr1uzIlZ86ckcdjY2PlF0NDQwwlyEaQ7NC+vr7y8vLk5ORV/yA7lGysP5Til19+2dBQXr9+PSIi4ttvv+3t7V1cXJycnGxoaPjqq6+U352enk5KSkpPT//7nbS0NI1GY7PZGEqQjWDYoRKMsrIy+S2yQTY2OZQHDx6MiooaHh72cSgfPXq0b98+qcLbt29XfbOXLl2S59++fVs5bGpqkkO/f5cesgF26OZ26Nq3KexQsrH+0NTX18t/v/76ax+HUl7CyOGtW7e8vdmjR4/KE+Q+Qzm0WCxy6PevmyUbYIduboeSDbKx1aGUX5w+fVp+UVdX58tQfvTRR3I4Ojrq7c3GxsbKE5xOp3K4sLAgh3FxcQwlyEYw7FCyQTb8MJRyZyCX9QMHDsipXXcoVSqVHDocDm9vNjw8XPkmo8qh3CnLYUREBEMJshEMO5RskA0/DKX47bff5Nc//PDDukMps+vL3YZrarnbANkIqh1KNsiGf4ZS3v6XX34phw8ePPDLxzasVqtyODY2xsc2QDaCZ4eSDbLhn6EUf/755/vvv3/kyBFfPk/jiy++8PZ5GhcvXnT/TCoZXzksKytjKEE2gmGHkg2y4behFD/99JPrU8XXeNqvv/4aHh7+3Xff9fX1OZ3OkZERaYPrs8JfvnypVqvT09PH30lLS0tKSlLeJ8tQgmzs+A4lG2TDn0O5uLj42Wef+fI1qDIK+fn5H3/88XvvvffBBx98+umn33zzjet3BwYGTp06FfPO6dOnZWgYSpCN4NmhK3/2FDuUbOx9ZAPsUHYo2WAoyQbIBjuUbDCUOzqUNpvt3LlzXNHADiUbZIOhXH8oW1tbDx06pHztIcAOJRtkg6H0OpSLi4slJSXKl8uSDbBDyQbZCGmNjY3Z2dnR0dEZGRl6vX7lUJpMptTUVPfPEuGKhm3V0NCgzGReXp7ZbGaTkg2yEUSKi4tTUlKkHN3d3bm5uYmJiQaDwX0or127FhkZ6fHJhVzXsH3cZ1Kn06nV6omJCbYq2SAbQaGurk5uI+bm5lyPFBUVFRYWKkNpsViysrLCVsOlDduktrbWYyalIn7/6TJkg2yQjU2S/dne3u7+SGdnp7zQk6GsqamJj48P84KrG7bJqjPp9+/ARjbIBtnY/CB6/FDlkZERtVotQ3n58uWV75vaHK1Wy9VwD5PzG+ZXK2dSo9GQDbJBNoLlbkOm0P0RvV6fnJysDKXRaPT4SPjm7ja4O9nb/Ht+V85kVVUVdxtkg2wEi+bmZrm3kG05MzMjh/39/fLKsbS01DWU8/PzJSUlZAMBO79NTU3uM2k2myUklZWVZINskI1g0dnZmZOTo3wYIyEhoaCgQB7xGMrW1laNRkM2EJjz29HR4ZpJSUhFRYXHu63IBtkgG7tgKG02W15eHtlAIM8vO5RskI1dP5TyBOU1INkA2SAbZIOh9GkoLRZLZmYm2QDZIBtkg6HcrqEkG2SDHUo2yAZDSTZANsgG2WAoyQbIBtkgGwwl2QDZYIeSDYaSbIBssEPJBtkgGyAb7FCyQTYYSrJBNtihZGOPZEOtVofhP3FxcWQDQXV+2aGB2aFkY2NmZ2fHxsZMJlN7e/udO3d+D22yArIOshqyJrIyZAM7fn7ZoQHYoWRjY+x2+/PnzwcGBoxGY1tb2x+hTVZA1kFWQ9ZEVoZsYMfPLzs0ADuUbGzMmzdvpqenrVarnImenp7HoU1WQNZBVkPWRFaGbGDHzy87NAA7lGxsjMPhkGjLOZB6j46O/hXaZAVkHWQ1ZE1kZcgGdvz8skMDsEPJxsYsLS3J6ku3X716ZbPZXoY2WQFZB1kNWRNZGbKBHT+/7NAA7FCysRlv/7Mc2lzrsIsuK9jb2WCHBmCHkg2E4mUFnF+QDXBZAecXZANcVsD5BdlgUcBlhfMLkA1wWQHnF2QDXFbA+QXZAJcVcH5BNsBlZX1arZZvjOojWSuyAbKBUM8GP49hQz+twW63v379emFhwel0Li8vkw2QDZANrJUNq9U6NTVls9kkHlIOsgGyAbKBtbLR19c3NDQ0Pj4u5ZifnycbIBsgG1grGx0dHT09PVKOycnJubk5sgGyAbKBtbJhMBikHL29vRaLhZ/eCLIBsoF1slFfX3/v3r2urq7BwUF+VjzIBsgG1snGzZs3W1panjx58uzZM7IBsgGyAbIBsgGyQTbIBsgGyAbZIBsgGwDZIBsA2QDZIBtkA2QDZINskA2QDZANkA2QDZANskE2QDZANsgG2QDZAMgG2QDIBsgG2SAbIBsgG2SDbIBsgGyAbIBsgGyQjcBmw263nzt3jmyAbIBsrH9VXZX776789crDzenr6ysvL09OTvbLW9t0Ntra2g4dOrTR80U2QDYQutnw5Xe3IxsSjLKyst7e3p3KxuLi4o8//qhSqZT/AbIBsoG9lo2Ghobs7Ozo6Oi8vDyz2bzd2Vjjmf690G9HNhobG5W1ysjI0Ov1K7PR39+fmprqfo9FNkA2sKeyUVxcnJKSIlfD7u5unU6nVqsnJiZ25G5j1fdoifb29qysrNjY2Li4uOPHj9+9e9fjTTkcjvPnzx84cCA8PHxbs+G+Vrm5uYmJiQaDwT0b169fj4yM9PiHkA2QDeydbNTW1spL47m5OfcrY3l5efC8k+rBgwcqlerkyZODg4M2m+3s2bPyhBs3brg//+rVq3IdX15e3ta7jbq6Oo+1KioqKiwsVLJhsVjkLmTVj+iQDZAN7J1syHVQXsu7Xxw7OzuPHTsWPB8Sl2DIIyaTSTmcmpqSwyNHjrg//+nTpwF4J9WqayU3H5KNmpqaDz/80Nu/mmyAbGAnqdXqML9aWlpyvxSOjIxoNJrguduIiopa+f8cERHh/vzFxcUAZGPVtZLTIdm4fPmy6wPgWyRvkCEH2UDwklfQLS0t7pfCqqoqf91t+DEbL1682OJf5Je7DY+10uv1ycnJyjupjEaj3Hls/W4DIBsIak1NTfLyVlIxMzMj42c2m+XiWFlZuVPZ2Ldvn8cfzMzMlEcaGhp2PBvNzc3ua9Xf36/VaktLS10fEp+fn79w4QLZANnAHtfR0ZGTkxMfH6+8h6SiosLjXTGBzEZSUpIcyhXZ9cijR4/2799/+PDhx48fO53OsbGxmpqaEydOBD4bygczXGuVkJBQUFAgj3h8Au79+/c1Gg3ZANnA3hcMX+5XXV198OBBjwe7urrkYp2YmKhSqaQr+fn5Dx8+XPsv8vbR+MB8uZ/NZtPpdGQDZANkAxv45iK1tbXKfQmjBbIBskE2fPpWhsPDw5mZmYwWyAbIBtnYrm+cDpANkA2yAZANkA2yQTZANkA26AHZANkAyAbZANkAyAbZANkgGyAbZAMgGyAbZAMgGyAbZINsgGyAbNADsgGyAZANsgGyAZANsgGyQTZANsgGQDZANsgGQDZANsgG2QDZANmgB2QDZAMgG2QDZAMgG2QDZINsgGyQDYBsgGyQDYBsgGyQDbIBsoEQp1arw+CbuLg4sgGyAfw7Ozs7NjZmMpna29vv3LnzO7yT9ZFVkrWSFZN1Y3hANhCK7Hb78+fPBwYGjEZjW1vbH/BO1kdWSdZKVkzWjeEB2UAoevPmzfT0tNVqlathT0/PY3gn6yOrJGslKybrxvCAbCAUORwOeeEs10F5BT06OvoXvJP1kVWStZIVk3VjeEA2EIqWlpbkCiivnV+9emWz2V7CO1kfWSVZK1kxWTeGB2QDoevtf5bhnWuVGBiQDQAA2QAAkA0AANkAAIBsAADIBgCAbAAAyAYAgGwAAMgGAABkAwBANgAAZAMAQDYAAGQDAEA2AAAgGwAAsgEAIBsAALIBACAbAACyAQAA2QAAkA0AANkAAOyebAAAsC6yAQAgGwCA7fF/4jqdMPvOou0AAAAASUVORK5CYII=" alt="Network" /><p class="caption">Network</p>
</div>
<p>Usually, a Snabb design will create a series of apps, interconnect these in a desired way using <em>links</em> and finally pass the resulting app network on to the Snabb engine. The engine’s job is to:</p>
<ul>
<li>Pump traffic through the app network</li>
<li>Keep the app network running (e.g. restart failed apps)</li>
<li>Report on the network status</li>
</ul>
<h1 id="snabb-api"><a href="#snabb-api">Snabb API</a></h1>
<p>The core modules defined below can be loaded using Lua’s <code>require</code>. For example:</p>
<pre><code>local config = require(&quot;core.config&quot;)

local c = config.new()
...</code></pre>
<h2 id="app"><a href="#app">App</a></h2>
<p>An <em>app</em> is an isolated implementation of a specific networking function. For example, a switch, a router, or a packet filter.</p>
<p>Apps receive packets on <em>input ports</em>, perform some processing, and transmit packets on <em>output ports</em>. Each app has zero or more input and output ports. For example, a packet filter may have one input and one output port, while a packet recorder may have only an input port. Every app must implement the interface below. Methods which may be left unimplemented are marked as “optional”.</p>
<p>— Method <strong>myapp:new</strong> <em>arg</em></p>
<p><em>Required</em>. Create an instance of the app with a given argument <em>arg</em>. <code>Myapp:new</code> must return an instance of the app. The handling of <em>arg</em> is up to the app but it is encouraged to use <code>core.config</code>’s <code>parse_app_arg</code> to parse <em>arg</em>.</p>
<p>— Field <strong>myapp.input</strong></p>
<p>— Field <strong>myapp.output</strong></p>
<p>Tables of named input and output links. These tables are initialized by the engine for use in processing and are <em>read-only</em>.</p>
<p>— Method <strong>myapp:pull</strong></p>
<p><em>Optional</em>. Pull packets into the network.</p>
<p>For example: Pull packets from a network adapter into the app network by transmitting them to output ports.</p>
<p>— Method <strong>myapp:push</strong></p>
<p><em>Optional</em>. Push packets through the system.</p>
<p>For example: Move packets from input ports to output ports or to a network adapter.</p>
<p>— Method <strong>myapp:reconfig</strong> <em>arg</em></p>
<p><em>Optional</em>. Reconfigure the app with a new <em>arg</em>. If this method is not implemented the app instance is discarded and a new instance is created.</p>
<p>— Method <strong>myapp:report</strong></p>
<p><em>Optional</em>. Print a report of the current app status.</p>
<p>— Method <strong>myapp:stop</strong></p>
<p><em>Optional</em>. Stop the app and release associated external resources.</p>
<p>— Field <strong>myapp.zone</strong></p>
<p><em>Optional</em>. Name of the LuaJIT <em>profiling zone</em> used for this app (descriptive string). The default is the module name.</p>
<h2 id="config-core.config"><a href="#config-core.config">Config (core.config)</a></h2>
<p>A <em>config</em> is a description of a packet-processing network. The network is a directed graph. Nodes in the graph are <em>apps</em> that each process packets in a specific way. Each app has a set of named input and output <em>ports</em>—often called <em>rx</em> and <em>tx</em>. Edges of the graph are unidirectional <em>links</em> that carry packets from an output port to an input port.</p>
<p>The config is a purely passive data structure. Creating and manipulating a config object does not immediately affect operation. The config has to be activated using <code>engine.configure</code>.</p>
<p>— Function <strong>config.new</strong></p>
<p>Creates and returns a new empty configuration.</p>
<p>— Function <strong>config.app</strong> <em>config</em>, <em>name</em>, <em>class</em>, <em>arg</em></p>
<p>Adds an app of <em>class</em> with <em>arg</em> to the <em>config</em> where it will be assigned to <em>name</em>.</p>
<p>Example:</p>
<pre><code>config.app(c, &quot;nic&quot;, Intel82599, {pciaddr = &quot;0000:00:00.0&quot;})</code></pre>
<p>— Function <strong>config.link</strong> <em>config</em>, <em>linkspec</em></p>
<p>Add a link defined by <em>linkspec</em> to the config <em>config</em>. <em>Linkspec</em> must be a string of the format</p>
<pre><code>app_name1.output_port-&gt;app_name2.input_port</code></pre>
<p>where <code>app_name1</code> and <code>app_name2</code> are names of apps in <em>config</em> and <code>output_port</code> and <code>input_port</code> are valid output and input ports of the referenced apps respectively.</p>
<p>Example:</p>
<pre><code>config.link(c, &quot;nic1.tx-&gt;nic2.rx&quot;)</code></pre>
<h2 id="engine-core.app"><a href="#engine-core.app">Engine (core.app)</a></h2>
<p>The <em>engine</em> executes a config by initializing apps, creating links, and driving the flow of execution. The engine also performs profiling and reporting functions. It can be reconfigured during runtime. Within Snabb Switch scripts the <code>core.app</code> module is bound to the global <code>engine</code> variable.</p>
<p>— Function <strong>engine.configure</strong> <em>config</em></p>
<p>Configure the engine to use a new config <em>config</em>. You can safely call this method many times to incrementally update the running app network. The engine updates the app network as follows:</p>
<ul>
<li>Apps that did not exist in the old configuration are started.</li>
<li>Apps that do not exist in the new configuration are stopped. (The app <code>stop()</code> method is called if defined.)</li>
<li>Apps with unchanged configurations are preserved.</li>
<li>Apps with changed configurations are updated by calling their <code>reconfig()</code> method. If the <code>reconfig()</code> method is not implemented then the old instance is stopped a new one started.</li>
<li>Links with unchanged endpoints are preserved.</li>
</ul>
<p>— Function <strong>engine.main</strong> <em>options</em></p>
<p>Run the Snabb engine. <em>Options</em> is a table of key/value pairs. The following keys are recognized:</p>
<ul>
<li><code>duration</code> - Duration in seconds to run the engine for (as a floating point number). If this is set you cannot supply <code>done</code>.</li>
<li><code>done</code> - A function to be called repeatedly by <code>engine.main</code> until it returns <code>true</code>. Once it returns <code>true</code> the engine will be stopped and <code>engine.main</code> will return. If this is set you cannot supply <code>duration</code>.</li>
<li><code>report</code> - A table which configures the report printed before <code>engine.main()</code> returns. The keys <code>showlinks</code> and <code>showapps</code> can be set to boolean values to force or suppress link and app reporting individually. By default `engine.main()’ will report on links but not on apps.</li>
<li><code>measure_latency</code> - By default, the <code>breathe()</code> loop is instrumented to record the latency distribution of running the app graph. This information can be processed by the <code>snabb top</code> program. Passing <code>measure_latency=false</code> in the <em>options</em> will disable this instrumentation.</li>
<li><code>no_report</code> - A boolean value. If <code>true</code> no final report will be printed.</li>
</ul>
<p>— Function <strong>engine.now</strong></p>
<p>Returns monotonic time in seconds as a floating point number. Suitable for timers.</p>
<p>— Variable <strong>engine.busywait</strong></p>
<p>If set to true then the engine polls continuously for new packets to process. This consumes 100% CPU and makes processing latency less vulnerable to kernel scheduling behavior which can cause pauses of more than one millisecond.</p>
<p>Default: false</p>
<p>— Variable <strong>engine.Hz</strong></p>
<p>Frequency at which to poll for new input packets. The default value is ‘false’ which means to adjust dynamically up to 100us during low traffic. The value can be overridden with a constant integer saying how many times per second to poll.</p>
<p>This setting is not used when engine.busywait is true.</p>
<h2 id="link-core.link"><a href="#link-core.link">Link (core.link)</a></h2>
<p>A <em>link</em> is a <a href="http://en.wikipedia.org/wiki/Circular_buffer">ring buffer</a> used to store packets between apps. Links can be treated either like arrays—accessing their internal structure directly—or as streams of packets by using their API functions.</p>
<p>— Function <strong>link.empty</strong> <em>link</em></p>
<p>Predicate used to test if a link is empty. Returns true if <em>link</em> is empty and false otherwise.</p>
<p>— Function <strong>link.full</strong> <em>link</em></p>
<p>Predicate used to test if a link is full. Returns true if <em>link</em> is full and false otherwise.</p>
<p>— Function <strong>link.receive</strong> <em>link</em></p>
<p>Returns the next available packet (and advances the read cursor) on <em>link</em>. If the link is empty an error is signaled.</p>
<p>— Function <strong>link.front</strong> <em>link</em></p>
<p>Return the next available packet without advancing the read cursor on <em>link</em>. If the link is empty, <code>nil</code> is returned.</p>
<p>— Function <strong>link.transmit</strong> <em>link</em>, <em>packet</em></p>
<p>Transmits <em>packet</em> onto <em>link</em>. If the link is full <em>packet</em> is dropped (and the drop counter increased).</p>
<p>— Function <strong>link.stats</strong> <em>link</em></p>
<p>Returns a structure holding ring statistics for the <em>link</em>:</p>
<ul>
<li><code>txbytes</code>, <code>rxbytes</code>: Counts of transferred bytes.</li>
<li><code>txpackets</code>, <code>rxpackets</code>: Counts of transferred packets.</li>
<li><code>txdrop</code>: Count of packets dropped due to ring overflow.</li>
</ul>
<h2 id="packet-core.packet"><a href="#packet-core.packet">Packet (core.packet)</a></h2>
<p>A <em>packet</em> is a data structure describing one of the network packets that is currently being processed. The packet is used to explicitly manage the life cycle of the packet. Packets are explicitly allocated and freed by using <code>packet.allocate</code> and <code>packet.free</code>. When a packet is received using <code>link.receive</code> its ownership is acquired by the calling app. The app must then ensure to either transfer the packet ownership to another app by calling <code>link.transmit</code> on the packet or free the packet using <code>packet.free</code>. Apps may only use packets they own, e.g. packets that have not been transmitted or freed. The number of allocatable packets is limited by the size of the underlying “freelist”, e.g. a pool of unused packet objects from and to which packets are allocated and freed.</p>
<p>— Function <strong>packet.allocate</strong></p>
<p>Returns a new empty packet. An an error is raised if there are no packets left on the freelist.</p>
<p>— Function <strong>packet.free</strong> <em>packet</em></p>
<p>Frees <em>packet</em> and puts in back onto the freelist.</p>
<p>— Function <strong>packet.data</strong> <em>packet</em></p>
<p>Returns a pointer to the payload of <em>packet</em>.</p>
<p>— Function <strong>packet.length</strong> <em>packet</em></p>
<p>Returns the payload length of <em>packet</em>.</p>
<p>— Function <strong>packet.clone</strong> <em>packet</em></p>
<p>Returns an exact copy of <em>packet</em>.</p>
<p>— Function <strong>packet.append</strong> <em>packet</em>, <em>pointer</em>, <em>length</em></p>
<p>Appends <em>length</em> bytes starting at <em>pointer</em> to the end of <em>packet</em>. An error is raised if there is not enough space in <em>packet</em> to accomodate <em>length</em> additional bytes.</p>
<p>— Function <strong>packet.prepend</strong> <em>packet</em>, <em>pointer</em>, <em>length</em></p>
<p>Prepends <em>length</em> bytes starting at <em>pointer</em> to the front of <em>packet</em>. An error is raised if there is not enough space in <em>packet</em> to accomodate <em>length</em> additional bytes.</p>
<p>— Function <strong>packet.shiftleft</strong> <em>packet</em>, <em>length</em></p>
<p>Truncates <em>packet</em> by <em>length</em> bytes from the front.</p>
<p>— Function <strong>packet.from_pointer</strong> <em>pointer</em>, <em>length</em></p>
<p>Allocate packet and fill it with <em>length</em> bytes from <em>pointer</em>.</p>
<p>— Function <strong>packet.from_string</strong> <em>string</em></p>
<p>Allocate packet and fill it with the contents of <em>string</em>.</p>
<h2 id="memory-core.memory"><a href="#memory-core.memory">Memory (core.memory)</a></h2>
<p>Snabb allocates special <a href="https://en.wikipedia.org/wiki/Direct_memory_access">DMA</a> memory that can be accessed directly by network cards. The important characteristic of DMA memory is being located in contiguous physical memory at a stable address.</p>
<p>— Function <strong>memory.dma_alloc</strong> <em>bytes</em></p>
<p>Returns a pointer to <em>bytes</em> of new DMA memory.</p>
<p>— Function <strong>memory.virtual_to_physical</strong> <em>pointer</em></p>
<p>Returns the physical address (<code>uint64_t</code>) the DMA memory at <em>pointer</em>.</p>
<p>— Variable <strong>memory.huge_page_size</strong></p>
<p>Size of a single huge page in bytes. Read-only.</p>
<h2 id="lib-core.lib"><a href="#lib-core.lib">Lib (core.lib)</a></h2>
<p>The <code>core.lib</code> module contains miscellaneous utilities.</p>
<p>— Function <strong>lib.equal</strong> <em>x</em>, <em>y</em></p>
<p>Predicate to test if <em>x</em> and <em>y</em> are structurally similar (isomorphic).</p>
<p>— Function <strong>lib.can_open</strong> <em>filename</em>, <em>mode</em></p>
<p>Predicate to test if file at <em>filename</em> can be successfully opened with <em>mode</em>.</p>
<p>— Function <strong>lib.can_read</strong> <em>filename</em></p>
<p>Predicate to test if file at <em>filename</em> can be successfully opened for reading.</p>
<p>— Function <strong>lib.can_write</strong> <em>filename</em></p>
<p>Predicate to test if file at <em>filename</em> can be successfully opened for writing.</p>
<p>— Function <strong>lib.readcmd</strong> <em>command</em>, <em>what</em></p>
<p>Runs Unix shell <em>command</em> and returns <em>what</em> of its output. <em>What</em> must be a valid argument to <code>file:read</code>.</p>
<p>— Function <strong>lib.readfile</strong> <em>filename</em>, <em>what</em></p>
<p>Reads and returns <em>what</em> from file at <em>filename</em>. <em>What</em> must be a valid argument to <code>file:read</code>.</p>
<p>— Function <strong>lib.writefile</strong> <em>filename</em>, <em>value</em></p>
<p>Writes <em>value</em> to file at <em>filename</em> using <code>file:write</code>. Returns the value returned by <code>file:write</code>.</p>
<p>— Function <strong>lib.readlink</strong> <em>filename</em></p>
<p>Returns the true name of symbolic link at <em>filename</em>.</p>
<p>— Function <strong>lib.dirname</strong> <em>filename</em></p>
<p>Returns the <code>dirname(3)</code> of <em>filename</em>.</p>
<p>— Function <strong>lib.basename</strong> <em>filename</em></p>
<p>Returns the <code>basename(3)</code> of <em>filename</em>.</p>
<p>— Function <strong>lib.firstfile</strong> <em>directory</em></p>
<p>Returns the filename of the first file in <em>directory</em>.</p>
<p>— Function <strong>lib.firstline</strong> <em>filename</em></p>
<p>Returns the first line of file at <em>filename</em> as a string.</p>
<p>— Function <strong>lib.files_in_directory</strong> <em>directory</em></p>
<p>Returns an array of filenames in <em>directory</em>.</p>
<p>— Function <strong>lib.load_string</strong> <em>string</em></p>
<p>Evaluates and returns the value of the Lua expression in <em>string</em>.</p>
<p>— Function <strong>lib.load_conf</strong> <em>filename</em></p>
<p>Evaluates and returns the value of the Lua expression in file at <em>filename</em>.</p>
<p>— Function <strong>lib.store_conf</strong> <em>filename</em>, <em>value</em></p>
<p>Writes <em>value</em> to file at <em>filename</em> as a Lua expression. Supports tables, strings and everything that can be readably printed using <code>print</code>.</p>
<p>— Function <strong>lib.bits</strong> <em>bitset</em>, <em>basevalue</em></p>
<p>Returns a bitmask using the values of <em>bitset</em> as indexes. The keys of <em>bitset</em> are ignored (and can be used as comments).</p>
<p>Example:</p>
<pre><code>bits({RESET=0,ENABLE=4}, 123) =&gt; 1&lt;&lt;0 | 1&lt;&lt;4 | 123</code></pre>
<p>— Function <strong>lib.bitset</strong> <em>value</em>, <em>n</em></p>
<p>Predicate to test if bit number <em>n</em> of <em>value</em> is set.</p>
<p>— Function <strong>lib.bitfield</strong> <em>size</em>, <em>struct</em>, <em>member</em>, <em>offset</em>, <em>nbits</em>, <em>value</em></p>
<p>Combined accesor and setter function for bit ranges of integers in cdata structs. Sets <em>nbits</em> (number of bits) starting from <em>offset</em> to <em>value</em>. If <em>value</em> is not given the current value is returned.</p>
<p><em>Size</em> may be one of 8, 16 or 32 depending on the bit size of the integer being set or read.</p>
<p><em>Struct</em> must be a pointer to a cdata object and <em>member</em> must be the literal name of a member of <em>struct</em>.</p>
<p>Example:</p>
<pre><code>local struct_t = ffi.typeof[[struct { uint16_t flags; }]]
-- Assuming `s' is an instance of `struct_t', set bits 4-7 to 0xF:
lib.bitfield(16, s, 'flags', 4, 4, 0xf)
-- Get the value:
lib.bitfield(16, s, 'flags', 4, 4) -- =&gt; 0xF</code></pre>
<p>— Function <strong>string:split</strong> <em>pattern</em></p>
<p>Returns an iterator over the string split by <em>pattern</em>. <em>Pattern</em> must be a valid argument to <code>string:gmatch</code>.</p>
<p>Example:</p>
<pre><code>for word, sep in (&quot;foo!bar!baz&quot;):split(&quot;(!)&quot;) do
    print(word, sep)
end

&gt; foo   !
&gt; bar   !
&gt; baz   nil</code></pre>
<p>— Function <strong>lib.hexdump</strong> <em>string</em></p>
<p>Returns hexadecimal string for bytes in <em>string</em>.</p>
<p>— Function <strong>lib.hexundump</strong> <em>hexstring</em></p>
<p>Returns byte string for <em>hexstring</em>.</p>
<p>— Function <strong>lib.comma_value</strong> <em>n</em></p>
<p>Returns a string for decimal number <em>n</em> with magnitudes separated by commas. Example:</p>
<pre><code>comma_value(1000000) =&gt; &quot;1,000,000&quot;</code></pre>
<p>— Function <strong>lib.random_data</strong> <em>length</em></p>
<p>Returns a string of <em>length</em> bytes of random data.</p>
<p>— Function <strong>lib.bounds_checked</strong> <em>type</em>, <em>base</em>, <em>offset</em>, <em>size</em></p>
<p>Returns a table that acts as a bounds checked wrapper around a C array of <em>type</em> and <em>size</em> starting at <em>base</em> plus <em>offset</em>. <em>Type</em> must be a ctype and the caller must ensure that the allocated memory region at <em>base</em>/<em>offset</em> is at least <code>sizeof(type)*size</code> bytes long.</p>
<p>— Function <strong>lib.timer</strong> <em>s</em></p>
<p>Returns a function that accepts no parameters and acts as a predicate to test if <em>ns</em> nanoseconds have elapsed.</p>
<p>— Function <strong>lib.waitfor</strong> <em>condition</em></p>
<p>Blocks until the function <em>condition</em> returns a true value.</p>
<p>— Function <strong>lib.waitfor2</strong> <em>name</em>, <em>condition</em>, <em>attempts</em>, <em>interval</em></p>
<p>Repeatedly calls the function <em>condition</em> in <em>interval</em> (milliseconds). If <em>condition</em> returns a true value <code>waitfor2</code> returns. If <em>condition</em> does not return a true value after <em>attempts</em> <code>waitfor2</code> raises an error identified by <em>name</em>.</p>
<p>— Function <strong>lib.yesno</strong> <em>flag</em></p>
<p>Returns the string <code>&quot;yes&quot;</code> if <em>flag</em> is a true value and <code>&quot;no&quot;</code> otherwise.</p>
<p>— Function <strong>lib.align</strong> <em>value</em>, <em>size</em></p>
<p>Return the next integer that is a multiple of <em>size</em> starting from <em>value</em>.</p>
<p>— Function <strong>lib.csum</strong> <em>pointer</em>, <em>length</em></p>
<p>Computes and returns the “IP checksum” <em>length</em> bytes starting at <em>pointer</em>.</p>
<p>— Function <strong>lib.update_csum</strong> <em>pointer</em>, <em>length</em>, <em>checksum</em></p>
<p>Returns <em>checksum</em> updated by <em>length</em> bytes starting at <em>pointer</em>. The default of <em>checksum</em> is <code>0LL</code>.</p>
<p>— Function <strong>lib.finish_csum</strong> <em>checksum</em></p>
<p>Returns the finalized <em>checksum</em>.</p>
<p>— Function <strong>lib.malloc</strong> <em>etype</em></p>
<p>Returns a pointer to newly allocated DMA memory for <em>etype</em>.</p>
<p>— Function <strong>lib.deepcopy</strong> <em>object</em></p>
<p>Returns a copy of <em>object</em>. Supports tables as well as ctypes.</p>
<p>— Function <strong>lib.array_copy</strong> <em>array</em></p>
<p>Returns a copy of <em>array</em>. <em>Array</em> must not be a “sparse array”.</p>
<p>— Function <strong>lib.htonl</strong> <em>n</em></p>
<p>— Function <strong>lib.htons</strong> <em>n</em></p>
<p>Host to network byte order conversion functions for 32 and 16 bit integers <em>n</em> respectively.</p>
<p>— Function <strong>lib.ntohl</strong> <em>n</em></p>
<p>— Function <strong>lib.ntohs</strong> <em>n</em></p>
<p>Network to host byte order conversion functions for 32 and 16 bit integers <em>n</em> respectively.</p>
<h2 id="main"><a href="#main">Main</a></h2>
<p>Snabb designs can be run either with:</p>
<pre><code>snabb &lt;snabb-arg&gt;* &lt;design&gt; &lt;design-arg&gt;*</code></pre>
<p>or</p>
<pre><code>#!/usr/bin/env snabb &lt;snabb-arg&gt;*
...</code></pre>
<p>The <em>main</em> module provides an interface for running Snabb scripts. It exposes various operating system functions to scripts.</p>
<p>— Field <strong>main.parameters</strong></p>
<p>A list of command-line arguments to the running script. Read-only.</p>
<p>— Function <strong>main.exit</strong> <em>status</em></p>
<p>Cleanly exists the process with <em>status</em>.</p>
<h1 id="basic-apps-apps.basic.basic_apps"><a href="#basic-apps-apps.basic.basic_apps">Basic Apps (apps.basic.basic_apps)</a></h1>
<p>The module <em>apps.basic.basic_apps</em> provides apps with general functionality for use in you app networks.</p>
<h2 id="source"><a href="#source">Source</a></h2>
<p>The <code>Source</code> app is a synthetic packet generator. On each breath it fills each attached output link with new packets. It accepts a number as its configuration argument which is the byte size of the generated packets. By default, each packet is 60 bytes long. The packet data is initialized with zero bytes.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Source" /><p class="caption">Source</p>
</div>
<h2 id="join"><a href="#join">Join</a></h2>
<p>The <code>Join</code> app joins together packets from N input links onto one output link. On each breath it outputs as many packets as possible from the inputs onto the output.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Join" /><p class="caption">Join</p>
</div>
<h2 id="split"><a href="#split">Split</a></h2>
<p>The <code>Split</code> app splits packets from multiple inputs across multiple outputs. On each breath it transfers as many packets as possible from the input links to the output links.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Split" /><p class="caption">Split</p>
</div>
<h2 id="sink"><a href="#sink">Sink</a></h2>
<p>The <code>Sink</code> app receives all packets from any number of input links and discards them. This can be handy in combination with a <code>Source</code>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Sink" /><p class="caption">Sink</p>
</div>
<h2 id="tee"><a href="#tee">Tee</a></h2>
<p>The <code>Tee</code> app receives all packets from any number of input links and transfers each received packet to all output links. It can be used to merge and/or duplicate packet streams</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Tee" /><p class="caption">Tee</p>
</div>
<h2 id="repeater"><a href="#repeater">Repeater</a></h2>
<p>The <code>Repeater</code> app collects all packets received from the <code>input</code> link and repeatedly transfers the accumulated packets to the <code>output</code> link. The packets are transmitted in the order they were received.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Repeater" /><p class="caption">Repeater</p>
</div>
<h1 id="intel-82599-ethernet-controller-apps"><a href="#intel-82599-ethernet-controller-apps">Intel 82599 Ethernet Controller Apps</a></h1>
<h2 id="intel10g-apps.intel.intel_app"><a href="#intel10g-apps.intel.intel_app">Intel10G (apps.intel.intel_app)</a></h2>
<p>The <code>Intel10G</code> drives one port of an Intel 82599 Ethernet controller. Packets taken from the <code>rx</code> port are transmitted onto the network. Packets received from the network are put on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Intel10G" /><p class="caption">Intel10G</p>
</div>
<p>— Method <strong>Intel10G.dev:get_rxstats</strong></p>
<p>Returns a table with the following keys:</p>
<ul>
<li><code>counter_id</code> - Counter id</li>
<li><code>packets</code> - Number of packets received</li>
<li><code>dropped</code> - Number of packets dropped</li>
<li><code>bytes</code> - Total bytes received</li>
</ul>
<p>— Method <strong>Intel10G.dev:get_txstats</strong></p>
<p>Returns a table with the following keys:</p>
<ul>
<li><code>counter_id</code> - Counter id</li>
<li><code>packets</code> - Number of packets sent</li>
<li><code>bytes</code> - Total bytes sent</li>
</ul>
<h3 id="configuration"><a href="#configuration">Configuration</a></h3>
<p>The <code>Intel10G</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>pciaddr</strong></p>
<p><em>Required</em>. The PCI address of the NIC as a string.</p>
<p>— Key <strong>macaddr</strong></p>
<p><em>Optional</em>. The MAC address to use as a string. The default is a wild-card (e.g. accept all packets).</p>
<p>— Key <strong>vlan</strong></p>
<p><em>Optional</em>. A twelve bit integer (0-4095). If set, incoming packets from other VLANs are dropped and outgoing packets are tagged with a VLAN header.</p>
<p>— Key <strong>vmdq</strong></p>
<p><em>Optional</em>. Boolean, defaults to false. Enables interface virtualization. Allows to have multiple <code>Intel10G</code> apps per port. If enabled, <em>macaddr</em> must be specified.</p>
<p>— Key <strong>mirror</strong></p>
<p><em>Optional</em>. A table. If set, this app will receive copies of all selected packets on the physical port. The selection is configured by setting keys of the <em>mirror</em> table. Either <em>mirror.pool</em> or <em>mirror.port</em> may be set.</p>
<p>If <em>mirror.pool</em> is <code>true</code> all pools defined on this physical port are mirrored. If <em>mirror.pool</em> is an array of pool numbers then the specified pools are mirrored.</p>
<p>If <em>mirror.port</em> is one of “in”, “out” or “inout” all incoming and/or outgoing packets on the port are mirrored respectively. Note that this does not include internal traffic which does not enter or exit through the physical port.</p>
<p>— Key <strong>rxcounter</strong></p>
<p>— Key <strong>txcounter</strong></p>
<p><em>Optional</em>. Four bit integers (0-15). If set, incoming/outgoing packets will be counted in the selected statistics counter respectively. Multiple apps can share a counter. To retrieve counter statistics use <code>Intel10G.dev:get_rxstats()</code> and <code>Intel10G.dev:get_txstats()</code>.</p>
<p>— Key <strong>rate_limit</strong></p>
<p><em>Optional</em>. Number. Limits the maximum Mbit/s to transmit. Default is 0 which means no limit. Only applies to outgoing traffic.</p>
<p>— Key <strong>priority</strong></p>
<p><em>Optional</em>. Floating point number. Weight for the <em>round-robin</em> algorithm used to arbitrate transmission when <em>rate_limit</em> is not set or adds up to more than the line rate of the physical port. Default is 1.0 (scaled to the geometric middle of the scale which goes from 1/128 to 128). The absolute value is not relevant, instead only the ratio between competing apps controls their respective bandwidths. Only applies to outgoing traffic.</p>
<p>For example, if two apps without <em>rate_limit</em> set have the same <em>priority</em>, both get the same output bandwidth. If the priorities are 3.0/1.0, the output bandwidth is split 75%/25%. Likewise, 1.0/0.333 or 1.5/0.5 yield the same result.</p>
<p>Note that even a low-priority app can use the whole line rate unless other (higher priority) apps are using up the available bandwidth.</p>
<h3 id="performance"><a href="#performance">Performance</a></h3>
<p>The <code>Intel10G</code> app can transmit and receive at approximately 10 Mpps per processor core.</p>
<h3 id="hardware-limits"><a href="#hardware-limits">Hardware limits</a></h3>
<p>Each physical Intel 82599 port supports the use of up to:</p>
<ul>
<li>64 <em>pools</em> (virtualized <code>Intel10G</code> app instances)</li>
<li>127 MAC addresses (see the <code>macaddr</code> configuration option)</li>
<li>64 VLANs (see the <code>vlan</code> configuration option)</li>
<li>4 <em>mirror pools</em> (see the <code>mirror</code> configuration option)</li>
</ul>
<h2 id="intel1g-apps.intel.intel1g.intel1g"><a href="#intel1g-apps.intel.intel1g.intel1g">Intel1G (apps.intel.intel1g.intel1g)</a></h2>
<p>The <code>intel1g</code> app drives one port of an Intel Gigabit Ethernet controller.</p>
<p>Hardware support: - Intel i210, i350 (in progress)</p>
<p>Features: - Optionally attach to a pre-initialized NIC. - Optionally use specific TX and RX queue numbers (or none). - Configuration and statistics registers are mirrored to shared memory objects (NYI). - Receive and transmit links are optional and can have any name.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Intel1g" /><p class="caption">Intel1g</p>
</div>
<h3 id="configuration-1"><a href="#configuration-1">Configuration</a></h3>
<p>— Key <strong>pciaddr</strong></p>
<p><em>Required</em>. The PCI address of the NIC as a string.</p>
<p>— Key <strong>attach</strong></p>
<p><em>Optional</em>. True means attach to a transmit and/or receive queue of an already-initialized NIC.</p>
<p>— Key <strong>txq</strong></p>
<p><em>Optional</em>. Transmit queue number to use. <code>false</code> means no transmit function. Default: 0.</p>
<p>— Key <strong>rxq</strong></p>
<p><em>Optional</em>. Receive queue number to use. <code>false</code> means no receive function. Default: 0.</p>
<p>— Key <strong>ndesc</strong></p>
<p><em>Optional</em>. Number of DMA descriptors to use i.e. size of the DMA transmit and receive queues. Must be a multiple of 128. Default is not specified but assumed to be broadly applicable.</p>
<p>— Key <strong>rxburst</strong></p>
<p><em>Optional</em>. Maximum number of packets to receive on one breath. Default is not specified but assumed to be broadly applicable.</p>
<p>+— Key <strong>loopback</strong> <em>Optional</em>. Set to <code>&quot;MAC&quot;</code> for MAC loopback, or to <code>&quot;PHY&quot;</code> for PHY loopback modes.</p>
<h2 id="loadgen-apps.intel.loadgen"><a href="#loadgen-apps.intel.loadgen">LoadGen (apps.intel.loadgen)</a></h2>
<p><code>LoadGen</code> is a <em>load generator</em> app based on the Intel 82599 Ethernet controller. It reads up to 32,000 packets from the <code>input</code> port and transmits them repeatedly onto the network. All incoming packets are dropped.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="LoadGen" /><p class="caption">LoadGen</p>
</div>
<h3 id="configuration-2"><a href="#configuration-2">Configuration</a></h3>
<p>The <code>LoadGen</code> app accepts a string as its configuration argument. The given string denotes the PCI address of the NIC to use.</p>
<h3 id="performance-1"><a href="#performance-1">Performance</a></h3>
<p>The <code>LoadGen</code> app can transmit at line-rate (14 Mpps) without significant CPU usage.</p>
<h1 id="solarflare-ethernet-controller-apps"><a href="#solarflare-ethernet-controller-apps">Solarflare Ethernet Controller Apps</a></h1>
<h2 id="solarflare-apps.solarflare.solarflare"><a href="#solarflare-apps.solarflare.solarflare">Solarflare (apps.solarflare.solarflare)</a></h2>
<p>The <code>Solarflare</code> app drives one port of a Solarflare SFN7 Ethernet controller. Multiple instances of the Solarflare app can be instantiated on the same PCI device. Packets received from the network will be dispatched between apps based on destination MAC address and VLAN. Packets taken from the <code>rx</code> port are transmitted onto the network. Packets received from the network are put on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Solarflare" /><p class="caption">Solarflare</p>
</div>
<p>The <code>Solarflare</code> app requires <a href="http://www.openonload.org/">OpenOnload</a> version <em>201502</em> to be installed and the <code>sfc</code> module to be loaded.</p>
<h3 id="configuration-3"><a href="#configuration-3">Configuration</a></h3>
<p>The <code>Solarflare</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>pciaddr</strong></p>
<p><em>Required</em>. The PCI address of the NIC as a string.</p>
<p>— Key <strong>macaddr</strong></p>
<p><em>Optional</em>. The MAC address to use as a string. The default is a wild-card (e.g. accept all packets).</p>
<p>— Key <strong>vlan</strong></p>
<p><em>Optional</em>. A twelve bit integer (0-4095). If set, incoming packets from other VLANs are dropped and outgoing packets are tagged with a VLAN header.</p>
<h1 id="ratelimiter-app-apps.rate_limiter.rate_limiter"><a href="#ratelimiter-app-apps.rate_limiter.rate_limiter">RateLimiter App (apps.rate_limiter.rate_limiter)</a></h1>
<p>The <code>RateLimiter</code> app implements a <a href="http://en.wikipedia.org/wiki/Token_bucket">Token bucket</a> algorithm with a single bucket dropping non-conforming packets. It receives packets on the <code>input</code> port and transmits conforming packets to the <code>output</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="RateLimiter" /><p class="caption">RateLimiter</p>
</div>
<p>— Method <strong>RateLimiter:snapshot</strong></p>
<p>Returns throughput statistics in form of a table with the following fields:</p>
<ul>
<li><code>rx</code> - Number of packets received</li>
<li><code>tx</code> - Number of packets transmitted</li>
<li><code>time</code> - Current time in nanoseconds</li>
</ul>
<h2 id="configuration-4"><a href="#configuration-4">Configuration</a></h2>
<p>The <code>RateLimiter</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>rate</strong></p>
<p><em>Required</em>. Rate in bytes per second to which throughput should be limited.</p>
<p>— Key <strong>bucket_capacity</strong></p>
<p><em>Required</em>. Bucket capacity in bytes. Should be equal or greater than <em>rate</em>. Otherwise the effective rate may be limted.</p>
<p>— Key <strong>initial_capacity</strong></p>
<p><em>Optional</em>. Initial bucket capacity in bytes. Defaults to <em>bucket_capacity</em>.</p>
<h2 id="performance-2"><a href="#performance-2">Performance</a></h2>
<p>The <code>RateLimiter</code> app is able to process more than 20 Mpps per CPU core. Refer to its selftest for details.</p>
<h1 id="pcapfilter-app-apps.packet_filter.pcap_filter"><a href="#pcapfilter-app-apps.packet_filter.pcap_filter">PcapFilter App (apps.packet_filter.pcap_filter)</a></h1>
<p>The <code>PcapFilter</code> app receives packets on the <code>input</code> port and transmits conforming packets to the <code>output</code> port. In order to conform, a packet must match the <em><a href="http://www.tcpdump.org/manpages/pcap-filter.7.html">pcap-filter</a> expression</em> of the <code>PcapFilter</code> instance and/or belong to a <em>sanctioned connection</em>. For a connection to be sanctioned it must be tracked in a <em>state table</em> by a <code>PcapFilter</code> app using the same state table. All <code>PcapFilter</code> apps share a global namespace of <em>state table identifiers</em>. Multiple <code>PcapFilter</code> apps—e.g. for inbound and outbound traffic—can refer to the same connection by sharing a state table identifer.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="PcapFilter" /><p class="caption">PcapFilter</p>
</div>
<h2 id="configuration-5"><a href="#configuration-5">Configuration</a></h2>
<p>The <code>PcapFilter</code> app accepts a table as its configuration argument. The following keys are available:</p>
<p>— Key <strong>filter</strong></p>
<p><em>Required</em>. A string containing a <a href="http://www.tcpdump.org/manpages/pcap-filter.7.html">pcap-filter</a> expression.</p>
<p>— Key <strong>state_table</strong></p>
<p><em>Optional</em>. A string naming a state table. If set, packets passing any <em>rule</em> will be tracked in the specified state table and any packet that belongs to a tracked connection in the specified state table will be let pass.</p>
<h1 id="ipv6-apps"><a href="#ipv6-apps">IPv6 Apps</a></h1>
<h2 id="nd_light-apps.ipv6.nd_light"><a href="#nd_light-apps.ipv6.nd_light">Nd_light (apps.ipv6.nd_light)</a></h2>
<p>The <code>nd_light</code> app implements a small subset of IPv6 neighbor discovery (RFC4861). It has two duplex ports, <code>north</code> and <code>south</code>. The <code>south</code> port attaches to a network on which neighbor discovery (ND) must be performed. The <code>north</code> port attaches to an app that processes IPv6 packets (including full ethernet frames). Packets transmitted to the <code>north</code> port must be wrapped in full Ethernet frames (which may be empty).</p>
<p>The <code>nd_light</code> app replies to neighbor solicitations for which it is configured as a target and performs rudimentary address resolution for its configured <em>next-hop</em> address. If address resolution succeeds, the Ethernet headers of packets from the <code>north</code> port will be overwritten with headers containing the discovered destination address and the configured source address before they are transmitted over the <code>south</code> port. All packets from the <code>north</code> port are discarded as long as ND has not yet succeeded. Packets received from the <code>south</code> port are transmitted to the <code>north</code> port unaltered.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAa4AAACMCAIAAACrhNpEAAALUElEQVR42u3dTUhU7x7A8Xx/CytLFDGQWiQSaBSEL2VRizZCyCwMgspNEIItDFqGLRJctKhVhi/pLUrRFnW1BCG1lIwpLbV/pY6amd2adMz3rPuj5/4Pc2d0nL+OznHm+1nNmRnH6fGcr89pZh43/AYAr7eBIQAAUggAVin8BQBehhQCACkEAFIIAKQQAEghAJBCACCFAEAKAYAUAgApBABSCACkEABIIQCQQgAghQBACgGAFAIAKQQAUggApBAASCEAkEIAIIUAQAoBgBQCACkEAFIIAKQQAEghAJBCACCFAEAK8c/Fx8dvgCvISLI7kUKsV3IM/4YryEhaLJYfP35MTU3NzMz8/PmTvYsUghR6YwoHBwdHRkbMZrMEUWrI3kUKQQq9MYWdnZ09PT1DQ0NSw8nJSfYuUghS6I0pfPbsWXt7u9Tw8+fP4+Pj7F2kEKTQG1NYW1srNXzz5s3AwMDo6Ch7FykEKfTGFN69e/fx48dtbW0fPnz49u0bexcpBCn0xhTeuXOnrq7u+fPn79+/J4WkELatEY6vIYWkEKSQFJJCUghSSApJISkEKdRhtiorK5OTk4ODgyMiIjIyMnp6erQ7yI6elpYWGhoaEhKSmpoqmzZfOzU1lZubGxkZ6evrq12pcfK7kEJSCFLo/hQmJiYajcaxsbH8/HzZTE9P1zoogZN+9fX1mUwmuSCbWg3V1xYWFsrXzs3NLTkrXOy7kEJSCFKoixS2tLSoTYvFIptBQUFqU6aBstnc3Kw2m5qaZFMmidZf29bW5uQJsvZdpIbW34UUkkKQQl2kcHp6Wm3Oz89bh0xOitVH7q0TJldaf639J08XS+Fi34UUkkKQQl2kcLFrnEnhP31Mx19LCkkhSKHuUmhzgiwX7E+Q7R/Tx8eHFJJCkELPSaF62USCaDKZ+vv75YL9yyb2jxkTE6PWLCGFpBCk0BNS+OvvN9OE/JGSklJbW7tkzoqLi6OiouzfTEMKSSFIIXRUfypGCkkhSCEpJIWkEJ4oLy/P+SWUSeEap9BisZw+fZq9lBRiLSZ6SUlJRqNR5ylU/0Pq/H2cub+T93T+oVybwsbGxri4OP18Ap0UkkIPT6EIDg4uLCwkhTpJ4ezs7MWLF/39/XW1GAcpJIWen0Ll0KFDAwMDC96tsrLy2LFjYWFhWVlZ3d3d+k+hCx/ZtSmsqqpSI5mWllZUVGSfwq6uLpmn2y/MAVKINUqh2Lx5s8xWbO6Tk5Oze/duOYZfvnxpMBiio6OHh4ddkjZ5TOsVd3p7e7U73Lp1a+fOnQEBAQkJCWVlZSucFVZUVCz2aI6fic34rPBfbT2SmZmZW7dura2ttU7htWvX5DksuEYRSCHWLoWKTP3MZrO6Q3l5uUxSxsfHrY/nS5cuuSSFiYmJEgWLxXL58mW14o66tb6+XjZTU1P7/1Af3Vl2ChsaGuSylM70x/79++3vudgzceGsUHJsM5Lnzp07e/asSqHMx2W2uOCPg72UFMI9KRSxsbFSELmDHL1NTU3Wh3RLS8u+fftcksLW1la1KYFQK+6oTTlVV38eU20+ffp0JSk8fPiw+hCk2mxsbLS/p/ZMtBWGXJ7CBUdSJomSwtLS0m3bti32s2AvJYXeS7XAjeRMuaSkRLVybm7O+gDu6+uTULokhTMzM9reZV0cOUuVy9oESuVp2Sl0/GiOn4kLU7jgSEZHR0sK8/PztRdJ3Ej2Og49Usis8P8Oid7eXnUHmcvU1dVZH8A3b9501axwsWvWPoUOnpsLZ4U2I1lUVJSQkKBOkI1Go8wQmRWSQugihTI3KSwsnJ2d1e5QU1MjMxfJ3/fv32U36O7ulkP6+vXrq5rC9PR0l58ga6fAC54gO3huarmglafw/v371iPZ1dUVHx9/4cIF7WWTycnJ8+fPk0JSCDenUGYlC77XWpJ0/PhxOWWW+8jBXFBQYHOi5/IUPnr0yOUvm0heBwYGFnvZxMFzU8sFSblWXsOWlhZtJLds2ZKdnS3X2LyZpr6+PjY2lhSSQrgnhTIfWfITeC58e92SASopKdmxY0dISEhiYmJpaalL3kyjHu3GjRtyk5+fn/PPRFsuaG3eYm02mw0GAykkhVjTFMocRGYiTt7ZAz7/+/r1a/mH7Nq1S+efQS4vL1fzR/ZSUohVJ7MP7S2EHpzCzMzMFy9eTE9Pv337Vr06X1ZWpv/lGHp7e3lVlxTif+dK+lmbZP2msKqqau/evQEBAeHh4RKXmpoaFun69WddIuuXyEAKdaqhoUFXa5PoIYWLvSfOIxfpWoMfaFJSUkdHB8caKdQp+V0tv7H1tjYJ6xV6XgrVukRXr17loCOFuiO/pfW2NonbV6bxGEuuTLP2KVSOHj262LpEpJAUuoH8ftbb2iSrsTKNd1pyZRo3plB92lJ+53EMkkI3k9/J8ptZbx+9WqWVabyQ45Vp9JBC5eTJk86/qYAUwvVnoOpNZHpL4SqtTOOFHKxMo6sUiri4OLUuEUjhWissLLQ/L9aJ1ViZxjtfKrEfydDQUB3+xDdu3KjWJQIpdAOj0WjzaolOZoWrsTKNd84KHaxMo59ZYVpamrYuEUihe0xOTubl5ekqhau0Mo0XWnJlGren0N/f/8qVK7zpmhTqRUNDg67WJlmNlWm8kzMr07grhdJlJ/8GLCnE2jGbzVlZWXpbm4S3WHvkW6xFTk7OkusSkUJS6DZytOhqbRJS6HkplPOP2tpajjVSqHcDAwP6WZuEFHpYCg0Gw5cvXzjKSCFIoVenEKQQpJAUuvI/HB1fQwpBCkEKSSFIIUghKQQphE5SODg4eOrUqdjY2MDAwKioqBMnTjx58kS7VZ5JWlpaaGhoSEhIamqqbDpZugU/C6AuV1ZWJicnBwcHR0REZGRk9PT0kEKQQrg5hepPS1dXV09NTQ0NDVVUVBw4cEDroK+vr2Srr6/PZDLJBdnUaihf5ePj42DSt1grExMTjUbj2NhYfn6++uOrpBCkEG5OYVhYmHxTmQnOz8/b3KT+zHRzc7PabGpqUp9E1n7ofn5+y0hhS0uL2pQaymZQUBApBCmEm1MoaVOFkrPgpKSk3Nzcjx8/qpvkpFiut1gs1uWSK1eYwunpabUp8V2//3tICkEKPSqF/f39Z86c2b59u/UKNE6mUM6XtceRwDmZQsfXkEKQQrjzFeTR0dHbt2/LE5BT5gVPkOWCdSgDAwNlc2JiQm22trbadM3Hx4cUghRifaTwyJEj1dXVIyMjMzMzDx8+VH/XSd2kXjaRIJpMJpk8ygXrl00OHjwody4oKJBp46tXr/bs2WPTtZiYGNns7OwkhSCF0HsKGxoaDAZDZGSkzPLkNDk7O3t4eFi7Vb2ZJuSPlJQU6wUaenp6MjIyIiIiNm3aJDfdu3fPpmvFxcVRUVH2b6YhhSCF4DPIHoIUghSSQpBCkEJSCFIIUkgKQQpBCkkhSCFIISkEKQQpJIUghSCFpBCkEKSQFIIUwoHo6OgNcIXw8HBSSAqxjo2Ojvb393d0dDQ1NT148OBfWC4ZPRlDGUkZTxlVdi1SiPXEYrF8+vTp3bt3RqOxsbHx31guGT0ZQxlJGU9tgSyQQqwPExMTX79+HRwclGO4vb29FcsloydjKCMp46ktgQVSiPVhenpapjBy9MpcxmQy/YXlktGTMZSRlPHUFnwGKcT6MDc3J8etzGLGxsbMZvN/sFwyejKGMpIynjKq7FqkEOvP/N9+Yrm0MWR3IoUAQAoBgBQCACkEAFIIAKQQAEghAJBCACCFAEAKAYAUAgApBABSCACkEABIIQCQQgAghQBACgGAFAIAKQQAUggApBAASCEAkEIAIIUA4CkpBACvRQoBgBQCwO/f/wW33RtmA5WfcAAAAABJRU5ErkJggg==" alt="nd_light" /><p class="caption">nd_light</p>
</div>
<h3 id="configuration-6"><a href="#configuration-6">Configuration</a></h3>
<p>The <code>nd_light</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>local_mac</strong></p>
<p><em>Required</em>. Local MAC address as a string or in binary representation.</p>
<p>— Key <strong>local_ip</strong></p>
<p><em>Required</em>. Local IPv6 address as a string or in binary representation.</p>
<p>— Key <strong>next_hop</strong></p>
<p><em>Required</em>. IPv6 address of <em>next hop</em> as a string or in binary representation.</p>
<p>— Key <strong>delay</strong></p>
<p><em>Optional</em>. Neighbor solicitation retransmission delay in milliseconds. Default is 1,000ms.</p>
<p>— Key <strong>retrans</strong></p>
<p><em>Optional</em>. Number of neighbor solicitation retransmissions. Default is unlimited retransmissions.</p>
<h2 id="simplekeyedtunnel-apps.keyed_ipv6_tunnel.tunnel"><a href="#simplekeyedtunnel-apps.keyed_ipv6_tunnel.tunnel">SimpleKeyedTunnel (apps.keyed_ipv6_tunnel.tunnel)</a></h2>
<p>The <code>SimpleKeyedTunnel</code> app implements “a simple L2 Ethernet over IPv6 tunnel encapsulation” as described in <a href="http://tools.ietf.org/html/draft-mkonstan-keyed-ipv6-tunnel-01">Keyed IPv6 Tunnel</a>. It has two duplex ports, <code>encapsulated</code> and <code>decapsulated</code>. Packets transmitted on the <code>decapsulated</code> input port will be encapsulated and put on the <code>encapsulated</code> output port. Packets transmitted on the <code>encapsulated</code> input port will be decapsulated and put on the <code>decapsulated</code> output port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="SimpleKeyedTunnel" /><p class="caption">SimpleKeyedTunnel</p>
</div>
<h3 id="configuration-7"><a href="#configuration-7">Configuration</a></h3>
<p>The <code>SimpleKeyedTunnel</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>local_address</strong></p>
<p><em>Required</em>. Local IPv6 address as a string.</p>
<p>— Key <strong>remote_address</strong></p>
<p><em>Required</em>. Remote IPv6 address as a string.</p>
<p>— Key <strong>local_cookie</strong></p>
<p><em>Required</em>. Local cookie, 8 bytes encoded in a hexadecimal string.</p>
<p>— Key <strong>remote_cookie</strong></p>
<p><em>Required</em>. Remote cookie, 8 bytes encoded in a hexadecimal string.</p>
<p>— Key <strong>local_session</strong></p>
<p><em>Optional</em>. Unsigned integer, 32 bit. If set, the <code>session_id</code> field of the L2TPv3 header will be overwritten with this value.</p>
<p>— Key <strong>hop_limit</strong></p>
<p><em>Optional</em>. Unsigned integer. Sets the <em>hop limit</em>. Default is 64.</p>
<p>— Key <strong>default_gateway_MAC</strong></p>
<p><em>Optional</em>. Destination MAC as a string. Not required if overwritten by an app such as <code>nd_light</code>.</p>
<h1 id="vhostuser-app-apps.vhost.vhost_user"><a href="#vhostuser-app-apps.vhost.vhost_user">VhostUser App (apps.vhost.vhost_user)</a></h1>
<p>The <code>VhostUser</code> app implements portions of the <a href="http://ozlabs.org/~rusty/virtio-spec/virtio-paper.pdf">Virtio</a> protocol for virtual ethernet I/O interfaces. In particular, <code>VhostUser</code> supports the virtio <em>vring</em> data structure for packet I/O in shared memory (DMA) and the Linux <em>vhost</em> API for creating vrings attached to <a href="https://www.kernel.org/doc/Documentation/networking/tuntap.txt">tuntap</a> devices.</p>
<p>With <code>VhostUser</code> SnabbSwitch can be used as a virtual ethernet interface by <em>QEMU virtual machines</em>. When connected via a UNIX socket, packets can be sent to the virtual machine by transmitting them on the <code>rx</code> port and packets send by the virtual machine will arrive on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="VhostUser" /><p class="caption">VhostUser</p>
</div>
<h2 id="configuration-8"><a href="#configuration-8">Configuration</a></h2>
<p>The <code>VhostUser</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>socket_path</strong></p>
<p><em>Optional</em>. A string denoting the path to the UNIX socket to connect on. Unless given all incoming packets will be dropped.</p>
<p>— Key <strong>is_server</strong></p>
<p><em>Optional</em>. Listen and accept an incoming connection on <em>socket_path</em> instead of connecting to it.</p>
<h1 id="pcapreader-and-pcapwriter-apps-apps.pcap.pcap"><a href="#pcapreader-and-pcapwriter-apps-apps.pcap.pcap">PcapReader and PcapWriter Apps (apps.pcap.pcap)</a></h1>
<p>The <code>PcapReader</code> and <code>PcapWriter</code> apps can be used to inject and log raw packet data into and out of the app network using the <a href="http://wiki.wireshark.org/Development/LibpcapFileFormat/">Libpcap File Format</a>. <code>PcapReader</code>reads raw packets from a PCAP file and transmits them on its <code>output</code> port while <code>PcapWriter</code> writes packets received on its <code>input</code> port to a PCAP file.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="PcapReader" /><p class="caption">PcapReader</p>
</div>
<h2 id="configuration-9"><a href="#configuration-9">Configuration</a></h2>
<p>Both <code>PcapReader</code> and <code>PcapWriter</code> expect a filename string as their configuration arguments to read from and write to respectively.</p>
<h1 id="vpws-app-apps.vpn.vpws"><a href="#vpws-app-apps.vpn.vpws">VPWS App (apps.vpn.vpws)</a></h1>
<p>The <code>VPWS</code> app implements a so-called Virtual Private Wire Service (VPWS). It provides a L2 VPN on top of IP (v4/v6) and GRE.</p>
<p>This app has two duplex ports, <code>customer</code> and <code>uplink</code>. The former transports Ethernet frames while the latter transports Ethernet frames encapsulated in IP/GRE. Packets transmitted on the <code>customer</code> input port are encapsulated and put on the <code>uplink</code> output port. Packets transmitted on the <code>uplink</code> input port are decapsulated and put on the <code>customer</code> output port.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaQAAADSCAIAAACKIiMKAAAVc0lEQVR42u2daUxUV/+ARUYWWQURRIhQjVqiARKbRkBQoXltKgkxGJVoXL7UNra2CU1M2g+NppGWD8bU1KiNEDdabcAPWGzRiSwR1HQKuNSl7OJeCiiIC33f37+nvf/JzDBO7eDcGZ7nAznnzr13LmfOeeZ37vKbMf8FABgFjKEJAADZAQB4nOz+AADwOJAdACA7AABkBwCA7AAAkB0AALIDAEB2AADIDgAA2QEAskN2AIDsAACQHQAAsgMAQHYAAMgOAADZAQAgOwAAZAcAyA7ZAQCyAwBAdgAAyA4AANkBACA7AABkBwCA7AAAkB0AIDtkBwDIDgAA2QEAIDsAAGQHemXWrFlj4G+kNegSyA48Exnh/wVtbIwZ09fX9/Dhw0ePHj1+/PjZs2f0EGQHyM4zZdfZ2Xnnzp3u7m5RnviOHoLsANl5puwuXbrU3Nzc1dUlvhsYGKCHIDtAdp4puzNnzjQ2Norvbt++/eDBA3oIsgNk55myq6ioEN9dvHixo6Ojp6eHHoLsANl5puy+/fbbH3/88fz587/++utvv/1GD0F2gOw8U3YlJSUnTpw4d+7c9evXkR2y88ABLyA7QHbIDtkhO2QHyA7ZITtkB8jO6TQ1NS1fvjwqKmrcuHEJCQmHDh0aTljmSzo7O9esWRMTE+Pj4xMZGbly5cqqqirz1TS0zaXHp6WljR8/3t/fPzU1VarWO9+9e3d8fLzsc86cOeXl5Vu3bo2OjpZNZMOLFy+ar19dXZ2VlRUUFBQcHJySkiIrW+zq0aNHmzZtioiIGDt2LLJDdjDaZXf27FlRT2xsbGVl5cOHDy9dupSXl6cNWi8vr+Fkl5GRIeXS0lJxSldX18GDB+fPn28nspPuLtKZN29ea2trW1ubFKRq7ju1SU5Ozr1797755htVXbp06f379w8fPixl2URb2Wg0GgyG9PR0NX5Wr14tKxQXF5vvqrCw0GQyPX36lMgO2QGy+yMzM1O6Y1lZmc1B6+3tPZzsAgICpCzR3NDQkCPTWAnlZEltba2q1tTUSFXiNYtNLl++LOX+/n7z6pMnT6Qs4Z62smhOljQ2Nqrq7du3pTpjxgzzXZ0/f55pLLIDZPcXMkOU7mizC9qXnXhKVWUPSUlJMmG8ceOGHdlJ/KieCVfV3t5eqcpCi03Ea+ZV7VFKix2qw7ZAO1qLbZEdsgNk95c1uru7bQ5a87Ndg4OD5sZpb29ft26dzH8111iHaS8gOwer6rDv3LkznG5ceHkE2SE7ZKdHFi1aJN3x2LFj1i/JtFFekhmlqtbX19uUSE9PjzqnJhNbbaGXl5f9aawU7PvRfnXBggVSPXLkCLJDdoDsHKKurs7Pz2/q1KknT54Ur125cmXNmjXm58UKCgokHGtoaEhOTjaXSGZmZmlpqcRWMls8fvy4LM/KytJ2Gx0drdJdWFygEOW1tbVJVCgFmxcoHKzW1NSIi+Pj4+X4JeSUfRYVFck+kR2yA2Q3LCKyZcuWTZo0yWAwmN960tzcnJ2dHRYWFhISkpKSImGUuUSMRmNubm5ERIRIRyaz69evv3XrlrbPffv2RUZG2rz1xP9PZIcVFRV2wjH7VUEGT05OTnh4uBy2uDUvL+/06dPIDtkBsgNkh+wA2QGyQ3aA7CA/P9/xFLvI7gVk19fXt3btWnoasgPXB2tJSUkmkwnZjYTsqqur4+LiRu3D1MgO9CU7wc/Pr7CwENk5UXZPnjzZvHmzwWAYzZkjkB3oTnaKBQsWdHR02Fzt6NGjixcvDggIWLFixS+//OIsX8yePVve99SpU6oqBanOmTNHqUTh5eUVGRmZl5d38+ZNWf7KK6/IwqtXr0q5oKBAyp999pmUZYmU5VW1q59++um1117z9fUNCgpKTEx0rua+++471RppaWl79+61lt3ly5clXraZMwKQHbhedkJoaKhEKxbrbNy4UawkI/znn3/Ozc2Nioq6deuWU6yxbds2edMPP/xQVT/44AOpykJNdlJ4/Pjxjh07pJyZmSnVd955R8oHDx6Usnr8WRwtZVki5Q0bNqhdqXsnz549e/fuXdnEiaYzb42lS5eGh4dXVFSYy+7LL7+USHm4BDmA7EAXslNI+KY9ZnfgwAEJUh48eGA+2j/99FOniKOtrU0Ct+nTp6vqtGnTpNre3m4uO+Hhw4dSDgwMlHJZWZmUN23aNDAw4PsnPj4+/f39SpSlpaVqE/XUXWNjo3NjOlGqRWu8++67b7/9tpKdxMUS8dlsUnoasgM9yk6IiYkxGo2ygoztmpoa8wFfV1c3d+5cZ+lDpV2QqbFM/dRjdtoZMYvIbtGiRVLt7e01GAwpKSk//PCDmsPK3++//z41NVWW9/T0qM3/85//yHJZMn/+/M8//1x06ZSjtdkaEuiJ7IqLiydOnDhce9LTkB3YRj0h60JkPltUVKRs+PTpU/Ph3draKip0luy++uorlaHviy++kMKuXbvMZafO2U2aNGn58uU3btzQ/Ojv7y+hXGRkpBzblClT3n///YCAADGgtltx4scff/zqq6+qnYj7nHVRwro1ZF4vstuyZYt2OcKFSM9h+CA7cDSykwHT0tKiVpBY5sSJE+bD++uvv3ZiZHf//v1x48alp6dLCCYFqVpEdtZs3bpVXgoJCVFn6N577z0pyxKbk+uTJ0+qbF3OiuwsWmPv3r0JCQlqGmsymdQlFyI7ZAd6l53EJhJkaan3hLKyMolcRHC///67dAOZb8qA37lzpxNPhL311lvef7JkyRLzGGo42Z09e1a9qi7jVlVVqeqZM2e0dbKzs2trawcHB9Wrr7/+ulMO9dixY+atIVPvWbNmffTRR9oFioGBAXX2ENkhO9Cv7CQqsXl3sUgkJydHJrayjgz1goICi6ncv0Tl0RKk4IjshoaGwsLCIiIinj17pqpyVHJ4qqp48803ZXrr6+srQd8bb7whVnLW0dbV1WmtMWHChPXr18sSi1tPKisrZaaP7JAd6FF2Eo8897kxbip2/Kbi7u7u3NxcZIfsQEeykxhEIhEHV8Zx/+hxsQMHDqgYkJ6G7MDFSPRhM3M9snNWIoCWlhaukCI7eD5iIv3kzEB2OkzxlJ+fb35BCZCdW2I0GnWVMwPZ6VB2Km9NU1MT4wXZuSXyXS3f2HrLmYHs9Ck7lbdm+/btDBxk52bIt7TecmaMUNYTN+W5WU9evuwUWVlZw+WtAWSnO+T7WW85M0Yu64k78tysJy6UnXrOT76ZGEfITtfId7J8M+vtYaMRzXridtjPeqIH2SlWrVrl+EV2ZIfsXvY8Ud2QpTfZjXTWE/fCTtYTXclOiIuLU3lrANnpi8LCQuvZq04Y0awnbndRwro1VO48vREYGKjy1gCy0x0mk8niuoROIrsRzXridpGdnawn+ons0tLStLw1gOz0yMDAQH5+vq5k9xKynrgRz8164nLZGQyGbdu2cZsxsnMPjEajrnJmjHTWE/fCkawnrpKdmNfBX8UEZKcXuru7V6xYobecGdxUrNubioWNGzc6/nvngOz0hYwlXeXMQHb6lJ3MAyoqKhgvyM696ejo0E/ODGSnQ9nl5ubevXuXkYLsANl5uOwA2QGyQ3b2TvNZlx3fCtkBskN2yA7ZAbJDdvqT3UhvhewA2SE7JwvLOl4rLi5OSEjw8fGZNm3a/v37nxvZqfLRo0fnzZvn5+cXFhaWnZ3d3Nxs8x2bmpqmTJni7e29Y8cOZAfIDtmN4Gfh5eVlX3birNbW1vb29tTUVPUzu47ILjEx0WQy9fb2btmyRaoZGRnWa1ZVVYWGhgYFBZWXlxPZAbJDdiP7WUhUZV92tbW1qioFqS5cuNAR2dXV1alqX1+fVH19fS3WLCsrk7gvNja2oaGBaSwgO2TnetmJrVRVwjSphoeHOyK7wcFBVR0aGrJ+dc+ePfK+c+fO7erq4pwdIDtk9zI+i7Fjx2pVMdRzZRcWFuaI7OwLNDg4WOV/95jkoMgOkJ2uZefj4yMH0N/fr6r19fXOmsbal538sxIhSmHmzJlXr15FdoDskN3Ikp6eLgdQUFAg4VtDQ0NycrK1mFJTU9va2rQLFJWVlf9edlK4cOHC5MmTVdIXbZ/IDpAdshsRmpubs7OzZWYaEhKSkpJy5MgRazEVFRUlJib6+/vHx8cXFxfbV5jjshPk/506dapKn7dz505kB8gO2bnsk/LIG4CRHSA7ZIfskB0gO2QHyA6Q3Sh8NhaQHSA7ZIfskB0gO2SH7ADZITtkh+wA2SE7QHaA7JAdIDvQG1FRUWPgb4KDg5EdsgOPpaenp729vampqaampry8/NDoRlpA2kFaQ9pEWobugezAc+jr67t58+a1a9dMJlN1dfX3oxtpAWkHaQ1pEy2fEiA78AT6+/vv37/f2dkpI7yxsbF+dCMtIO0grSFtomVbAmQHnsDg4KCEMDK2JZZpa2u7OrqRFpB2kNaQNtES/AKyA0/g6dOnMqoliunt7e3u7r43upEWkHaQ1pA2kZaheyA78DSG/ubZ6EZrB7oEsgMAQHYAAMgOAADZAQAgOwAAZAcAgOwAANkhOwBAdgAAyA4AANkBACA7AABkBwCA7AAAkB0AALJ7PuqXpWgHAGSH7AAA2SE7AEB2TqepqWn58uVRUVHjxo1LSEg4dOjQcMIyX9LZ2blmzZqYmBgfH5/IyMiVK1dWVVWZr6ahbX7ixIm0tLTx48f7+/unpqZK1Xrnu3fvjo+Pl33OmTOnvLx869at0dHRsolsePHiRfP1q6urs7KygoKCgoODU1JSZGWLXT169GjTpk0RERFjx46lswKMdtmdPXtW1BMbG1tZWfnw4cNLly7l5eVpyvDy8hpOdhkZGVIuLS0Vp3R1dR08eHD+/Pl2IjtRm0hn3rx5ra2tbW1tUpCque/UJjk5Offu3fvmm29UdenSpffv3z98+LCUZRNtZaPRaDAY0tPT1Y/Mr169WlYoLi4231VhYaHJZOIXXgCQ3f+RmZkpXigrK7M5FfX29h5OdgEBAVKWaM7mD6lYy05COVlSW1urqjU1NVKVeM1ik8uXL//x5++umlefPHkiZQn3tJVFc7KksbFRVW/fvi3VGTNmmO/q/Pnz9FEAZPcXMkMUL0hw9E9lJ55SVdlDUlKSTBhv3LhhR3YSP8oS7Qfhe3t7pSoLLTYRr5lXHz9+bHOH6rAt0I7WYlsAQHZ/WaO7u9um7MzPdg0ODpobp729fd26dTL/1VxjHaa9gOwcrKrDvnPnjs1/issjAMjOkkWLFokXjh07Zv2STBvlJZlRqmp9fb1NifT09KhzajKx1RZ6eXnZn8ZKwb4f7VcXLFgg1SNHjiA7AGTnEHV1dX5+flOnTj158qR47cqVK2vWrFEvqfNiBQUFEo41NDQkJyebSyQzM7O0tFRiK5ktHj9+XJZnZWVpu42OjpYlly5d0paoCxSivLa2NokKpWDzAoWD1ZqaGnFxfHy8HL+EnLLPoqIi2SeyA0B2wyIiW7Zs2aRJkwwGg/mtJ83NzdnZ2WFhYSEhISkpKRJGmUvEaDTm5uZGRESIdGQyu379+lu3bmn73LdvX2RkpM1bT/z/RHZYUVFhJxyzXxXOnTuXk5MTHh4uhy1uzcvLO336NLIDQHYAAMgOAADZAQCyQ3YAgOwAAJAdAACyAwBAdgAAyA4AANl5GuoJWbcmNDR01qxZGzZsaGlpcXl7NjU1rVq1avr06XJUYzwa6TkMH2QHL5Xu7m5RzObNm8Uv1dXVLjySsrIyOYZt27ZdvnzZZhYcQHbIDpxASUlJXFzcwMCAS9795s2bEydONBqNfBCA7GDESUtLO3DggEveeuvWrTKB5SMAZAcvg127drnKOOJZiyQ0AMgORopz584lJSW55K1DQ0Pv3r3LRwDIDl4GLS0tcXFxLnlr0v8BsnMPuru7165d6wH/hURYL/99+/r6AgMDPbuH5Ofna7/lBMjOXTEajRIQeUZs4pL/woUR5cts2KSkpKamJsYLsnNL5LtavrENBoPH5GF3yX9hMplmz57t8bIT/Pz8tm/fzsBBdm6GfEvLd7X5bfHI7sUoKirKzc0dDbJTZGVldXR0MIKQnXsg38/yLW3xDBCyezGWLFmyd+/e0SM79ZTe0aNHGUfITtfId7J8M9t84BHZvQBGo3HixIke/3yYzQ6zatUqHoxDdjpFvo3tPKOO7P4RfX19u3btkvYsKyvz+J4zXJ+Ji4vjITlkp0cKCwutZ6+elG/Dvuycm+VFWnLx4sVnzpxxykfjphlTAgMDi4qKGFnITo+YTCaL6xJEdi5H/xlTbHaYtLQ0PWTWQnYwLAMDA/n5+chOJ7hFxhSLrmIwGETN3GaM7NwDGV0xMTHIzuW4RcYU834ya9YsmR8wgpCdOyEzphUrViA71+IWGVO0TrJx40ZXJQ1EdvBvKSkpUSfFkZ1LcIuMKdKwMg8gjRWyc3s6Ojo841cF3FF2bnHMubm55LBCdoA4XpzRkDEFkB0gO0/OmGJ+Itjxk8Iec/oY2cHIIlGSez3A5MEZU5AdsoMRZO7cue719JIHZ0x5MW0hOwCH+OSTTzZu3OhGB6zzjCnW6rGO14qLixMSEnx8fKZNm7Z///7nRnaqfPTo0Xnz5vn5+YWFhWVnZzc3N9t8x6ampilTpnh7e+/YsQPZAfw/165dCw0NdZeEuvrPmCLe8fLysi87cVZra2t7e3tqaqpUT5065YjsEhMTZQrf29u7ZcsWqWZkZFivWVVVJZ9mUFBQeXk5kR2AJbt27YqKiiopKdHzva/ukjFFvCNRlX3Z1dbWqqoUpLpw4UJHZFdXV6c1hVR9fX0t1pSWkbgvNja2oaGBaSyAbSoqKtLS0rR08zrEuRlTXCs7sZWqSpgm1fDwcEdkNzg4qKpDQ0PWr+7Zs0fed+7cuV1dXZ7RJ5EdgN5lN3bsWK0qhnqu7MLCwhyRnX2BBgcHq/zvHpMcFNkB6BofHx+RTn9/v6rW19c7axprX3bnzp2TCFEKM2fOvHr1KrIDgJElPT1djFNQUCDhW0NDQ3JysrWYUlNT29ratAsUlZWV/152Urhw4cLkyZOlPGHCBG2fyA4ARoTm5ubs7GyZmYaEhKSkpBw5csRaTEVFRYmJif7+/vHx8cXFxfYV5rjshOvXr0+dOlWlz9u5cyeyAwDX4Kk3ACM7AEB2yA4A2QGyAwBkh+wAANkBACA7AABkBwCA7AAAkB0AALIDAEB2AADIDgCQHbIDAGQHAIDsAACQHQAAsgMAQHYAAMgOAADZAQAgOwBAdsgOAJAdAACyAwBAdgAAyA4AwIWyAwDwYJAdACA7AABP4X8j+bdDy5lBGgAAAABJRU5ErkJggg==" alt="VPWS" /><p class="caption">VPWS</p>
</div>
<h2 id="configuration-10"><a href="#configuration-10">Configuration</a></h2>
<p>The <code>vpws</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>local_vpn_ip</strong></p>
<p><em>Required</em>. Local VPN IPv6 address as a string or in binary representation.</p>
<p>— Key <strong>remote_vpn_ip</strong></p>
<p><em>Required</em>. Remote VPN IPv6 address as a string or in binary representation.</p>
<p>— Key <strong>local_mac</strong></p>
<p><em>Required</em>. Local MAC address as a string or in binary representation.</p>
<p>— Key <strong>remote_mac</strong></p>
<p><em>Optional</em>. Remote MAC address as a string or in binary representation. Default is <code>02:00:00:00:00:00</code>.</p>
<p>If <em>remote_mac</em> is not supplied, the <code>uplink</code> port needs to be connected to something that performs address resolution and overwrites the Ethernet header (e.g. the <code>nd_light</code> app).</p>
<p>— Key <strong>checksum</strong></p>
<p><em>Optional</em>. Enables GRE checksumming if set to a true value.</p>
<p>— Key <strong>label</strong></p>
<p><em>Optional</em>. A GRE key (32 bit unsigned integer). Enables GRE keying if supplied.</p>
<h1 id="rawsocket-app-apps.socket.raw"><a href="#rawsocket-app-apps.socket.raw">RawSocket App (apps.socket.raw)</a></h1>
<p>The <code>RawSocket</code> app is a bridge between Linux network interfaces (<code>eth0</code>, <code>lo</code>, etc.) and a Snabb app network. Packets taken from the <code>rx</code> port are transmitted over the selected interface. Packets received on the interface are put on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="RawSocket" /><p class="caption">RawSocket</p>
</div>
<h2 id="configuration-11"><a href="#configuration-11">Configuration</a></h2>
<p>The <code>RawSocket</code> app accepts a string as its configuration argument. The string denotes the interface to bridge to.</p>
<h1 id="libraries"><a href="#libraries">Libraries</a></h1>
<h3 id="ip-checksum-lib.checksum"><a href="#ip-checksum-lib.checksum">IP checksum (lib.checksum)</a></h3>
<p>The checksum module provides an optimized ones-complement checksum routine.</p>
<p>— Function <strong>ipsum</strong> <em>pointer</em> <em>length</em> <em>initial</em></p>
<p>Return the ones-complement checksum for the given region of memory.</p>
<p><em>pointer</em> is a pointer to an array of data to be checksummed. <em>initial</em> is an unsigned 16-bit number in host byte order which is used as the starting value of the accumulator. The result is the IP checksum over the data in host byte order.</p>
<p>The <em>initial</em> argument can be used to verify a checksum or to calculate the checksum in an incremental manner over chunks of memory. The synopsis to check whether the checksum over a block of data is equal to a given value is the following</p>
<pre><code>if ipsum(pointer, length, value) == 0 then
  -- checksum correct
else
  -- checksum incorrect
end</code></pre>
<p>To chain the calculation of checksums over multiple blocks of data together to obtain the overall checksum, one needs to pass the one’s complement of the checksum of one block as initial value to the call of ipsum() for the following block, e.g.</p>
<pre><code>local sum1 = ipsum(data1, length1, 0)
local total_sum = ipsum(data2, length2, bit.bnot(sum1))</code></pre>
<p>This function takes advantage of SIMD hardware when available.</p>
<h3 id="ctable-lib.ctable"><a href="#ctable-lib.ctable">Ctable (lib.ctable)</a></h3>
<p>A <em>ctable</em> is a hash table whose keys and values are instances of FFI data types. In Lua parlance, an FFI value is a “cdata” value, hence the name “ctable”.</p>
<p>A ctable is parameterized for the specific types for its keys and values. This allows for the table to be stored in an efficient manner. Adding an entry to a ctable will copy the value into the table. Logically, the table “owns” the value. Lookup can either return a pointer to the value in the table, or copy the value into a user-supplied buffer, depending on what is most convenient for the user.</p>
<p>As an implementation detail, the table is stored as an open-addressed robin-hood hash table with linear probing. This means that to look up a key in the table, we take its hash value (using a user-supplied hash function), map that hash value to an index into the table by scaling the hash to the table size, and then scan forward in the table until we find an entry whose hash value is greater than or equal to the hash in question. Each entry stores its hash value, and empty entries have a hash of <code>0xFFFFFFFF</code>. If the entry’s hash matches and the entry’s key is equal to the one we are looking for, then we have our match. If the entry’s hash is greater than our hash, then we have a failure. Hash collisions are possible as well of course; in that case we continue scanning forward.</p>
<p>The distance travelled while scanning for the matching hash is known as the <em>displacement</em>. The table measures its maximum displacement, for a number of purposes, but you might be interested to know that a maximum displacement for a table with 2 million entries and a 40% load factor is around 8 or 9. Smaller tables will have smaller maximum displacements.</p>
<p>The ctable has two lookup interfaces. One will perform the lookup as described above, scanning through the hash table in place. The other will fetch all entries within the maximum displacement into a buffer, then do a branchless binary search over that buffer. This second streaming lookup can also fetch entries for multiple keys in one go. This can amortize the cost of a round-trip to RAM, in the case where you expect to miss cache for every lookup.</p>
<p>To create a ctable, first create a parameters table specifying the key and value types, along with any other options. Then call <code>ctable.new</code> on those parameters. For example:</p>
<pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> <span class="kw">ctable</span> <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'lib.ctable'</span><span class="ot">)</span>
<span class="kw">local</span> <span class="kw">ffi</span> <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'ffi'</span><span class="ot">)</span>
<span class="kw">local</span> <span class="kw">params</span> <span class="ot">=</span> <span class="ot">{</span>
   <span class="kw">key_type</span> <span class="ot">=</span> <span class="kw">ffi</span><span class="ot">.</span>typeof<span class="ot">(</span><span class="st">'uint32_t'</span><span class="ot">),</span>
   <span class="kw">value_type</span> <span class="ot">=</span> <span class="kw">ffi</span><span class="ot">.</span>typeof<span class="ot">(</span><span class="st">'int32_t[6]'</span><span class="ot">),</span>
   <span class="kw">hash_fn</span> <span class="ot">=</span> <span class="kw">ctable</span><span class="ot">.</span><span class="kw">hash_i32</span><span class="ot">,</span>
   <span class="kw">max_occupancy_rate</span> <span class="ot">=</span> <span class="dv">0.4</span><span class="ot">,</span>
   <span class="kw">initial_size</span> <span class="ot">=</span> <span class="fu">math.ceil</span><span class="ot">(</span><span class="kw">occupancy</span> <span class="ot">/</span> <span class="dv">0.4</span><span class="ot">)</span>
<span class="ot">}</span>
<span class="kw">local</span> <span class="kw">ctab</span> <span class="ot">=</span> <span class="kw">ctable</span><span class="ot">.</span>new<span class="ot">(</span><span class="kw">params</span><span class="ot">)</span></code></pre>
<p>— Function <strong>ctable.new</strong> <em>parameters</em></p>
<p>Create a new ctable. <em>parameters</em> is a table of key/value pairs. The following keys are required:</p>
<ul>
<li><code>key_type</code>: An FFI type (LuaJIT “ctype”) for keys in this table.</li>
<li><code>value_type</code>: An FFI type (LuaJT “ctype”) for values in this table.</li>
<li><code>hash_fn</code>: A function that takes a key and returns a hash value.</li>
</ul>
<p>Hash values are unsigned 32-bit integers in the range <code>[0, 0xFFFFFFFF)</code>. That is to say, <code>0xFFFFFFFF</code> is the only unsigned 32-bit integer that is not a valid hash value. The <code>hash_fn</code> must return a hash value in the correct range.</p>
<p>Optional entries that may be present in the <em>parameters</em> table include:</p>
<ul>
<li><code>initial_size</code>: The initial size of the hash table, including free space. Defaults to 8 slots.</li>
<li><code>max_occupancy_rate</code>: The maximum ratio of <code>occupancy/size</code>, where <code>occupancy</code> denotes the number of entries in the table, and <code>size</code> is the total table size including free entries. Trying to add an entry to a “full” table will cause the table to grow in size by a factor of</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Defaults to 0.9, for a 90% maximum occupancy ratio.</li>
</ol>
<ul>
<li><code>min_occupancy_rate</code>: Minimum ratio of <code>occupancy/size</code>. Removing an entry from an “empty” table will shrink the table.</li>
</ul>
<h4 id="methods"><a href="#methods">Methods</a></h4>
<p>Users interact with a ctable through methods. In these method descriptions, the object on the left-hand-side of the method invocation should be a ctable.</p>
<p>— Method <strong>:resize</strong> <em>size</em></p>
<p>Resize the ctable to have <em>size</em> total entries, including empty space.</p>
<p>— Method <strong>:insert</strong> <em>hash</em>, <em>key</em>, <em>value</em>, <em>updates_allowed</em></p>
<p>An internal helper method that does the bulk of updates to hash table. <em>hash</em> is the hash of <em>key</em>. This method takes the hash as an explicit parameter because it is used when resizing the table, and that way we avoid calling the hash function in that case. <em>key</em> and <em>value</em> are FFI values for the key and the value, of course.</p>
<p><em>updates_allowed</em> is an optional parameter. If not present or false, then the <code>:insert</code> method will raise an error if the <em>key</em> is already present in the table. If <em>updates_allowed</em> is the string <code>&quot;required&quot;</code>, then an error will be raised if <em>key</em> is <em>not</em> already in the table. Any other true value allows updates but does not require them. An update will replace the existing entry in the table.</p>
<p>Returns the index of the inserted entry.</p>
<p>— Method <strong>:add</strong> <em>key</em>, <em>value</em>, <em>updates_allowed</em></p>
<p>Add an entry to the ctable, returning the index of the added entry. See the documentation for <code>:insert</code> for a description of the parameters.</p>
<p>— Method <strong>:update</strong> <em>key</em>, <em>value</em></p>
<p>Update the entry in a ctable with the key <em>key</em> to have the new value <em>value</em>. Throw an error if <em>key</em> is not present in the table.</p>
<p>— Method <strong>:lookup_ptr</strong> <em>key</em></p>
<p>Look up <em>key</em> in the table, and if found return a pointer to the entry. Return nil if the value is not found.</p>
<p>An entry pointer has three fields: the <code>hash</code> value, which must not be modified; the <code>key</code> itself; and the <code>value</code>. Access them as usual in Lua:</p>
<pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> <span class="kw">ptr</span> <span class="ot">=</span> <span class="kw">ctab</span>:lookup<span class="ot">(</span><span class="kw">key</span><span class="ot">)</span>
<span class="kw">if</span> <span class="kw">ptr</span> <span class="kw">then</span> <span class="fu">print</span><span class="ot">(</span><span class="kw">ptr</span><span class="ot">.</span><span class="kw">value</span><span class="ot">)</span> <span class="kw">end</span></code></pre>
<p>Note that pointers are only valid until the next modification of a table.</p>
<p>— Method <strong>:lookup_and_copy</strong> <em>key</em>, <em>entry</em></p>
<p>Look up <em>key</em> in the table, and if found, copy that entry into <em>entry</em> and return true. Otherwise return false.</p>
<p>— Method <strong>:remove_ptr</strong> <em>entry</em></p>
<p>Remove an entry from a ctable. <em>entry</em> should be a pointer that points into the table. Note that pointers are only valid until the next modification of a table.</p>
<p>— Method <strong>:remove</strong> <em>key</em>, <em>missing_allowed</em></p>
<p>Remove an entry from a ctable, keyed by <em>key</em>.</p>
<p>Return true if we actually do find a value and remove it. Otherwise if no entry is found in the table and <em>missing_allowed</em> is true, then return false. Otherwise raise an error.</p>
<p>— Method <strong>:selfcheck</strong></p>
<p>Run an expensive internal diagnostic to verify that the table’s internal invariants are fulfilled.</p>
<p>— Method <strong>:dump</strong></p>
<p>Print out the entries in a table. Can be expensive if the table is large.</p>
<p>— Method <strong>:iterate</strong></p>
<p>Return an iterator for use by <code>for in</code>. For example:</p>
<pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">for</span> <span class="kw">entry</span> <span class="kw">in</span> <span class="kw">ctab</span>:iterate<span class="ot">()</span> <span class="kw">do</span>
   <span class="fu">print</span><span class="ot">(</span><span class="kw">entry</span><span class="ot">.</span><span class="kw">key</span><span class="ot">,</span> <span class="kw">entry</span><span class="ot">.</span><span class="kw">value</span><span class="ot">)</span>
<span class="kw">end</span></code></pre>
<h4 id="hash-functions"><a href="#hash-functions">Hash functions</a></h4>
<p>Any hash function will do, as long as it produces values in the <code>[0, 0xFFFFFFFF)</code> range. In practice we include some functions for hashing byte sequences of some common small lengths.</p>
<p>— Function <strong>ctable.hash_32</strong> <em>number</em></p>
<p>Hash a 32-bit integer. As a <code>hash_fn</code> parameter, this will only work if your key type’s Lua representation is a Lua number. For example, use <code>hash_32</code> on <code>ffi.typeof('uint32_t')</code>, but use <code>hashv_32</code> on <code>ffi.typeof('uint8_t[4]')</code>.</p>
<p>— Function <strong>ctable.hashv_32</strong> <em>ptr</em></p>
<p>Hash the first 32 bits of a byte sequence.</p>
<p>— Function <strong>ctable.hashv_48</strong> <em>ptr</em></p>
<p>Hash the first 48 bits of a byte sequence.</p>
<p>— Function <strong>ctable.hashv_64</strong> <em>ptr</em></p>
<p>Hash the first 64 bits of a byte sequence.</p>
<h3 id="pmu-lib.pmu"><a href="#pmu-lib.pmu">PMU (lib.pmu)</a></h3>
<p>The CPU’s PMU (Performance Monitoring Unit) collects information about specific <em>performance events</em> such as cache misses, branch mispredictions, and utilization of internal CPU resources like execution units. This module provides an API for counting events with the PMU.</p>
<p>Hundreds of low-level counters are available. The exact list depends on CPU model. See pmu_cpu.lua for our definitions.</p>
<h4 id="high-level-interface"><a href="#high-level-interface">High-level interface</a></h4>
<p>— Function <strong>is_available</strong></p>
<p>If the PMU hardware is available then return true. Otherwise return two values: false and a string briefly explaining why. (Cooperation from the Linux kernel is required to acess the PMU.)</p>
<p>— Function <strong>profile</strong> <em>function</em> <em>[event_list]</em> <em>[aux]</em></p>
<p>Call <em>function</em>, return the result, and print a human-readable report of the performance events that were counted during execution.</p>
<p>— Function <strong>measure</strong> <em>function</em> <em>[event_list]</em></p>
<p>Call <em>function</em> and return two values: the result and a table of performance event counter tallies.</p>
<h4 id="low-level-interface"><a href="#low-level-interface">Low-level interface</a></h4>
<p>— Function <strong>setup</strong> <em>event_list</em></p>
<p>Setup the hardware performance counters to track a given list of events (in addition to the built-in fixed-function counters).</p>
<p>Each event is a Lua string pattern. This could be a full event name:</p>
<pre><code>mem_load_uops_retired.l1_hit</code></pre>
<p>or a more general pattern that matches several counters:</p>
<pre><code>mem_load.*l._hit</code></pre>
<p>Return the number of overflowed counters that could not be tracked due to hardware constraints. These will be the last counters in the list.</p>
<p>Example:</p>
<pre><code>setup({&quot;uops_issued.any&quot;,
       &quot;uops_retired.all&quot;,
       &quot;br_inst_retired.conditional&quot;,
       &quot;br_misp_retired.all_branches&quot;}) =&gt; 0</code></pre>
<p>— Function <strong>new_counter_set</strong></p>
<p>Return a <code>counter_set</code> object that can be used for accumulating events. The counter_set will be valid only until the next call to setup().</p>
<p>— Function <strong>switch_to</strong> <em>counter_set</em></p>
<p>Switch to a new set of counters to accumulate events in. Has the side-effect of committing the current accumulators to the previous record.</p>
<p>If <em>counter_set</em> is nil then do not accumulate events.</p>
<p>— Function <strong>to_table</strong> <em>counter_set</em></p>
<p>Return a table containing the values accumulated in <em>counter_set</em>.</p>
<p>Example:</p>
<pre><code>to_table(cs) =&gt;
  {
   -- Fixed-function counters
   instructions                 = 133973703,
   cycles                       = 663011188,
   ref-cycles                   = 664029720,
   -- General purpose counters selected with setup()
   uops_issued.any              = 106860997,
   uops_retired.all             = 106844204,
   br_inst_retired.conditional  =  26702830,
   br_misp_retired.all_branches =       419
  }</code></pre>
<p>— Function <strong>report</strong> <em>counter_set</em> <em>[aux]</em></p>
<p>Print a textual report on the values accumulated in a counter set. Optionally include auxiliary application-level counters. The ratio of each event to each auxiliary counter is also reported.</p>
<p>Example:</p>
<pre><code>report(my_counter_set, {packet = 26700000, breath = 208593})</code></pre>
<p>prints output approximately like:</p>
<pre><code>EVENT                                   TOTAL     /packet     /breath
instructions                      133,973,703       5.000     642.000
cycles                            663,011,188      24.000    3178.000
ref-cycles                        664,029,720      24.000    3183.000
uops_issued.any                   106,860,997       4.000     512.000
uops_retired.all                  106,844,204       4.000     512.000
br_inst_retired.conditional        26,702,830       1.000     128.000
br_misp_retired.all_branches              419       0.000       0.000
packet                             26,700,000       1.000     128.000
breath                                208,593       0.008       1.000</code></pre>
<h2 id="hardware"><a href="#hardware">Hardware</a></h2>
<h3 id="pci-lib.hardware.pci"><a href="#pci-lib.hardware.pci">PCI (lib.hardware.pci)</a></h3>
<p>The <code>lib.hardware.pci</code> module provides functions that abstract common operations on PCI devices on Linux. In order to drive a PCI device using <a href="https://en.wikipedia.org/wiki/Direct_memory_access">Direct memory access (DMA)</a> one must:</p>
<ol style="list-style-type: decimal">
<li>Unbind the PCI device using <code>pci.unbind_device_from_linux</code>.</li>
<li>Enable PCI bus mastering for device using <code>pci.set_bus_master</code> in order to enable DMA.</li>
<li>Memory map PCI device configuration space using <code>pci.map_pci_memory</code>.</li>
<li>Control the PCI device by manipulating the memory referenced by the pointer returned by <code>pci.map_pci_memory</code>.</li>
<li>Disable PCI bus master for device using <code>pci.set_bus_master</code>.</li>
<li>Unmap PCI device configuration space using <code>pci.close_pci_resource</code>.</li>
</ol>
<p>The correct ordering of these steps is absolutely critical.</p>
<p>— Variable <strong>pci.devices</strong></p>
<p>An array of supported hardware devices. Must be populated by calling <code>pci.scan_devices</code>. Each entry is a table as returned by <code>pci.device_info</code>.</p>
<p>— Function <strong>pci.canonical</strong> <em>pciaddress</em></p>
<p>Returns the canonical representation of a PCI address. The canonical representation is preferred internally in Snabb and for presenting to users. It shortens addresses with leading zeros like this: <code>0000:01:00.0</code> becomes <code>01:00.0</code>.</p>
<p>— Function <strong>pci.qualified</strong> <em>pciaddress</em></p>
<p>Returns the fully qualified representation of a PCI address. Fully qualified addresses have the form <code>0000:01:00.0</code> and so this function undoes any abbreviation in the canonical representation.</p>
<p>— Function <strong>pci.scan_devices</strong></p>
<p>Scans for available PCI devices and populates the <code>pci.devices</code> table.</p>
<p>— Function <strong>pci.device_info</strong> <em>pciaddress</em></p>
<p>Returns a table containing information about the PCI device by <em>pciaddress</em>. The table has the following keys:</p>
<ul>
<li><code>pciaddress</code>—String denoting the PCI address of the device. E.g. <code>&quot;0000:83:00.1&quot;</code>.</li>
<li><code>vendor</code>—Identification string e.g. <code>&quot;0x8086&quot;</code> for Intel.</li>
<li><code>device</code>—Identification string e.g. <code>&quot;0x10fb&quot;</code> for 82599 chip.</li>
<li><code>interface</code>—Name of Linux interface using this device e.g. <code>&quot;eth0&quot;</code>.</li>
<li><code>status</code>—String denoting the Linux operational status, or <code>nil</code> if not known.</li>
<li><code>driver</code>—String denoting the Lua module that supports this hardware e.g. <code>&quot;apps.intel.intel10g&quot;</code>.</li>
<li><code>usable</code>—String denoting if the device was suitable to use when scanned. One of <code>&quot;yes&quot;</code> or <code>&quot;no&quot;</code>.</li>
</ul>
<p>— Function <strong>pci.which_driver</strong> <em>vendor</em>, <em>model</em></p>
<p>Returns the module name for a suitable device driver (if available) for a device of <em>model</em> from <em>vendor</em>.</p>
<p>— Function <strong>pci.unbind_device_from_linux</strong> <em>pciaddress</em></p>
<p>Forces Linux to unbind the device identified by <em>pciaddress</em> from any kernel drivers.</p>
<p>— Function <strong>pci.set_bus_master</strong> <em>pciaddress</em>, <em>enable</em></p>
<p>Enables or disables PCI bus mastering for device identified by <em>pciaddress</em> depending on whether <em>enable</em> is a true or a false value. PCI bus mastering must be enabled in order to perform DMA on the PCI device.</p>
<p>— Function <strong>pci.map_pci_memory</strong> <em>pciaddress</em>, <em>n</em></p>
<p>Memory maps configuration space <em>n</em> of PCI device identified by <em>pciaddress</em>. Returns a pointer to the memory mapped region and a file descriptor of the opened sysfs resource file. PCI bus mastering must be enabled on device identified by <em>pciaddress</em> before calling his function.</p>
<p>— Function <strong>pci.close_pci_resource</strong> <em>file_descriptor</em>, <em>pointer</em></p>
<p>Closes memory mapped <em>file_descriptor</em> of sysfs resource file and unmaps it from <em>pointer</em> as returned by <code>pci.map_pci_memory</code>.</p>
<h3 id="register-lib.hardware.register"><a href="#register-lib.hardware.register">Register (lib.hardware.register)</a></h3>
<p>The <code>lib.hardware.register</code> module provides an abstraction for hardware device registers. This abstraction can be used to declaratively specify and conveniently manipulate structured memory regions via DMA. The functions <code>register.define</code> and <code>register.define_array</code> construct <code>Register</code> objects based on a <em>register description</em> string. The resulting <code>Register</code> objects can be used to manipulate the defined registers using the methods <code>Register:read</code>, <code>Register:write</code>, <code>Register:set</code>, <code>Register:clr</code>, <code>Register:wait</code> and <code>Register:reset</code> (exact set depends on the <em>register mode</em>).</p>
<p>A register description is a string with one <code>Register</code> object definition per line. A <code>Register</code> object definition must be expressed using the following grammar:</p>
<pre><code>Register   ::= Name Offset Indexing Mode Longname
Name       ::= &lt;identifier&gt;
Indexing   ::= &quot;-&quot;
           ::= &quot;+&quot; OffsetStep &quot;*&quot; Min &quot;..&quot; Max
Mode       ::= &quot;RO&quot; | &quot;RW&quot; | &quot;RC&quot;
Longname   ::= &lt;string&gt;
Offset ::= OffsetStep ::= Min ::= Max ::= &lt;number&gt;</code></pre>
<p>A <code>Register</code> object definition is made up of the following properties:</p>
<ul>
<li><em>Name</em>—A string to be used to refer to the <code>Register</code> object. Must be a valid Lua identifier, e.g. <code>&quot;foo&quot;</code>, <code>&quot;foo_bar&quot;</code>, <code>&quot;FOO&quot;</code> etc.</li>
<li><em>Offset</em>—Integer specifying the offset from the base pointer (as supplied to <code>register.define</code> and <code>register.define_array</code>).</li>
<li><em>Indexing</em>—Optional. Three integers specifying the offset step as well as minimum and maximum indexes in bytes.</li>
<li><em>Mode</em>—One of <code>&quot;RO&quot;</code>, <code>&quot;RW&quot;</code> or <code>&quot;RC&quot;</code> standing for <em>read-only</em>, <em>read-write</em> and <em>counter</em> modes respectively. Counter mode is for counter registers that clear back to zero when read.</li>
<li><em>Longname</em>—A string describing the register (used for self-documentation).</li>
</ul>
<p>For instance, the following <code>Register</code> object definition defines a register range “TXDCTL” in read-write mode starting at offset 0x06028 with 128 registers each of length 0x40.</p>
<pre><code>TXDCTL 0x06028 +0x40*0..127 RW Transmit Descriptor Control</code></pre>
<p>The next example defines a singular register “TPT” in counter mode located at offset 0x01428.</p>
<pre><code>TPT 0x01428 - RC Total Packets Transmitted</code></pre>
<p>— Function <strong>register.define</strong> <em>description</em>, <em>table</em>, <em>base_pointer</em>, <em>n</em></p>
<p>Creates <code>Register</code> objects for <em>description</em> relative to <em>base_pointer</em>. The resulting <code>Register</code> objects will become a named entries in <em>table</em> using the names defined in <em>description</em>. If an entry in <em>description</em> defines an indexing range then <em>n</em> specifies the index of the register within that range. <em>N</em> defaults to 0.</p>
<p>— Function <strong>register.define_array</strong> <em>description</em>, <em>table</em>, <em>base_pointer</em></p>
<p>Creates <code>Register</code> objects for <em>description</em> relative to <em>base_pointer</em>. The resulting <code>Register</code> objects will become a named entries in <em>table</em> using the names defined in <em>description</em>. If an entry in <em>description</em> defines an indexing range, an array of <code>Register</code> objects will be created instead of a singular <code>Register</code> object.</p>
<p>— Function <strong>register.dump</strong> <em>table</em></p>
<p>Prints a pretty-printed register dump of a <em>table</em> of registers.</p>
<p>— Method <strong>Register:read</strong></p>
<p>Returns the value of register. For convenience register objects can be called without arguments instead of calling <code>Register:read</code>. E.g. <code>reg:read()</code> is equivalent to <code>reg()</code>.</p>
<p>— Method <strong>Register:write</strong> <em>value</em></p>
<p>Sets the value of register to <em>value</em>. Only available on registers in read-write mode. For convenience register objects can be called with an argument instead of calling <code>Register:write</code>. E.g. <code>reg:write(value)</code> is equivalent to <code>reg(value)</code>.</p>
<p>If register is in counter mode it is assumed that the register will be reset to zero upon reading. The read value is added to a <em>register accumulator</em> and the sum of all reads is returned.</p>
<p>— Method <strong>Register:set</strong> <em>bitmask</em></p>
<p>Sets bits of register according to <em>bitmask</em>. Only available on registers in read-write mode.</p>
<p>— Method <strong>Register:clr</strong> <em>bitmask</em></p>
<p>Clears bits of register according to <em>bitmask</em>. Only available on registers in read-write mode.</p>
<p>— Method <strong>Register:wait</strong> <em>bitmask</em>, <em>value</em></p>
<p>Blocks until applying <em>bitmask</em> to the register equals <em>value</em>. If <em>value</em> is not supplied blocks until all bits in the mask are set instead. Only available on registers in read-write and read-only modes.</p>
<p>— Method <strong>Register:reset</strong></p>
<p>Reset the register accumulator to 0. Only available on registers in counter mode.</p>
<p>— Method <strong>Register:print</strong></p>
<p>Prints the register state to standard output.</p>
<h2 id="protocols"><a href="#protocols">Protocols</a></h2>
<h3 id="protocol-header-lib.protocol.header"><a href="#protocol-header-lib.protocol.header">Protocol Header (lib.protocol.header)</a></h3>
<p>The <code>lib.protocol.header</code> module contains the base class from which the supported protocol classes are derived. It defines generic methods on all protocol subclasses.</p>
<p>— Method <strong>header:new_from_mem</strong> <em>memory</em>, <em>length</em></p>
<p>Creates and returns a header object by “overlaying” the respective header structure over <em>length</em> bytes of <em>memory</em>.</p>
<p>— Method <strong>header:header</strong></p>
<p>Returns the raw header as a <em>cdata</em> object.</p>
<p>— Method <strong>header:sizeof</strong></p>
<p>Returns the byte size of header.</p>
<p>— Method <strong>header:eq</strong> <em>header</em></p>
<p>Generic equality predicate. Returns <code>true</code> if <em>header</em> is equal to self and <code>false</code> otherwise.</p>
<p>— Method <strong>header:copy</strong> <em>destination</em>, <em>relocate</em></p>
<p>Copies the header to <em>destination</em>. The caller must ensure that there is enough space at <em>destination</em>. If <em>relocate</em> is a true value, <em>destination</em> is promoted to be the active storage for the header.</p>
<p>— Method <strong>header:clone</strong></p>
<p>Returns a copy of the header object.</p>
<p>— Method <strong>header:upper_layer</strong></p>
<p>Returns the protocol class that can handle the “upper layer protocol” or <code>nil</code> if the protocol is not supported or the protocol has no upper layer.</p>
<p>For instance, on an Ethernet header object this method might return a IPv4 or IPv6 header class.</p>
<h3 id="ethernet-lib.protocol.ethernet"><a href="#ethernet-lib.protocol.ethernet">Ethernet (lib.protocol.ethernet)</a></h3>
<p>The <code>lib.protocol.ethernet</code> module contains a class for representing <em>Ethernet headers</em>. The <code>ethernet</code> protocol class supports two upper layer protocols: <code>lib.protocol.ipv4</code> and <code>lib.protocol.ipv6</code>.</p>
<p>— Method <strong>ethernet:new</strong> <em>config</em></p>
<p>Returns a new Ethernet header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>dst</code> - Destination MAC (binary representation). Default is <code>00:00:00:00:00:00</code>.</li>
<li><code>src</code> - Source MAC (binary representation). Default is <code>00:00:00:00:00:00</code>.</li>
<li><code>type</code> - Either <code>0x0800</code> or <code>0x86dd</code> for IPv4/6 individually. Default is <code>0x0</code>.</li>
</ul>
<p>— Method <strong>ethernet:src</strong> <em>mac</em></p>
<p>— Method <strong>ethernet:dst</strong> <em>mac</em></p>
<p>— Method <strong>ethernet:type</strong> <em>type</em></p>
<p>Combined accessor and setter methods. These methods set the values of the source, destination and type fields of an Ethernet header. If no argument is given the current value is returned.</p>
<p>Example:</p>
<pre><code>local eth = ethernet:new({src = ethernet:pton(&quot;00:00:00:00&quot;),
                          dst = ethernet:pton(&quot;00:00:00:00&quot;),
                          type = 0x86dd})
eth:dst(ethernet:pton(&quot;54:52:00:01&quot;))
ethernet:ntop(eth:dst()) =&gt; &quot;54:52:00:01&quot;</code></pre>
<p>— Method <strong>ethernet:src_eq</strong> <em>mac</em></p>
<p>— Method <strong>ethernet:dst_eq</strong> <em>mac</em></p>
<p>Predicate methods to test if <em>mac</em> is equal to the source or destination addresses individually.</p>
<p>— Method <strong>ethernet:swap</strong></p>
<p>Swaps the values of the source and destination fields.</p>
<p>— Function <strong>ethernet:pton</strong> <em>string</em></p>
<p>Returns the binary representation of MAC address denoted by <em>string</em>.</p>
<p>— Function <strong>ethernet:ntop</strong> <em>mac</em></p>
<p>Returns the string representation of <em>mac</em> address.</p>
<p>— Function <strong>ethernet:ipv6_mcast</strong> <em>ip</em></p>
<p>Returns the MAC address for IPv6 multicast <em>ip</em> as defined by RFC2464, section 7.</p>
<h3 id="ipv4-lib.protocol.ipv4"><a href="#ipv4-lib.protocol.ipv4">IPv4 (lib.protocol.ipv4)</a></h3>
<p>The <code>lib.protocol.ipv4</code> module contains a class for representing <em>IPv4 headers</em>. The <code>ipv4</code> protocol class supports four upper layer protocols: <code>lib.protocol.tcp</code>, <code>lib.protocol.udp</code>, <code>lib.protocol.gre</code> and <code>lib.protocol.icmp.header</code>.</p>
<p>— Method <strong>ipv4:new</strong> <em>config</em></p>
<p>Returns a new IPv4 header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>dst</code> - Destination IPv4 address (binary representation). Default is <code>0.0.0.0</code>.</li>
<li><code>src</code> - Source IPv4 address (binary representation). Default is <code>0.0.0.0</code>.</li>
<li><code>protocol</code> - The upper layer protocol, can be 6 (TCP), 17 (UDP), 47 (GRE) or 58 (ICMP). Default is 255.</li>
<li><code>dscp</code> - “Differentiated Services Code Point” field (6 bit unsigned integer). Default is 0.</li>
<li><code>ecn</code> - “Explicit Congestion Notification” field (2 bit unsigned integer). Default is 0.</li>
<li><code>id</code> - “Identification” field (16 bit unsigned integer). Default is 0.</li>
<li><code>flags</code> - “Don’t Fragment (DF)” and “More Fragments (MF)” fields (3 bit unsigned integer). Default is 0.</li>
<li><code>frag_off</code> - “Fragment Offset” field (13 bit unsigned integer). Default is 0.</li>
<li><code>ttl</code> - “Time To Live” field (8 bit unsigned integer). Default is 0.</li>
</ul>
<p>— Method <strong>ipv4:dst</strong> <em>ip</em></p>
<p>— Method <strong>ipv4:src</strong> <em>ip</em></p>
<p>— Method <strong>ipv4:protocol</strong> <em>protocol</em></p>
<p>— Method <strong>ipv4:dscp</strong> <em>dscp</em></p>
<p>— Method <strong>ipv4:ecn</strong> <em>ecn</em></p>
<p>— Method <strong>ipv4:id</strong> <em>id</em></p>
<p>— Method <strong>ipv4:flags</strong> <em>flags</em></p>
<p>— Method <strong>ipv4:frag_off</strong> <em>frag_off</em></p>
<p>— Method <strong>ipv4:ttl</strong> <em>ttl</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of an IPv4 header. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv4:version</strong> <em>version</em></p>
<p>Combined accessor and setter method for the “Version” field (4 bit unsigned integer). Defaults to 4 (set automatically by <code>new</code>). Sets the “Version” field to <em>version</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv4:ihl</strong> <em>ihl</em></p>
<p>Combined accessor and setter method for the “Internet Header Length” field (4 bit unsigned integer). Set automatically by <code>new</code>. Sets the “Internet Header Length” field to <em>ihl</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv4:total_length</strong> <em>length</em></p>
<p>Combined accessor and setter method for the “Total Length” field (16 bit unsigned integer). Defaults to header length (set automatically by <code>new</code>). Sets the “Total Length” field to <em>length</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv4:checksum</strong></p>
<p>Computes and sets the IPv4 header checksum. Its called automatically by <code>new</code> but must be called after the header is changed.</p>
<p>— Method <strong>ipv4:dst_eq</strong> <em>ip</em></p>
<p>— Method <strong>ipv4:src_eq</strong> <em>ip</em></p>
<p>Predicate methods to test if <em>ip</em> is equal to the source or destination addresses individually.</p>
<p>— Function <strong>ipv4:pton</strong> <em>string</em></p>
<p>Returns the binary representation of IPv4 address denoted by <em>string</em>.</p>
<p>— Function <strong>ipv4:ntop</strong> <em>ip</em></p>
<p>Returns the string representation of <em>ip</em> address.</p>
<h3 id="ipv6-lib.protocol.ipv6"><a href="#ipv6-lib.protocol.ipv6">IPv6 (lib.protocol.ipv6)</a></h3>
<p>The <code>lib.protocol.ipv6</code> module contains a class for representing <em>IPv6 headers</em>. The <code>ipv6</code> protocol class supports four upper layer protocols: <code>lib.protocol.tcp</code>, <code>lib.protocol.udp</code>, <code>lib.protocol.gre</code> and <code>lib.protocol.icmp.header</code>.</p>
<p>— Method <strong>ipv6:new</strong> <em>config</em></p>
<p>Returns a new IPv6 header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>dst</code> - Destination IPv6 address (binary representation). Default is <code>0::0</code>.</li>
<li><code>src</code> - Source IPv6 address (binary representation). Default is <code>0::0</code>.</li>
<li><code>traffic_class</code> - “Traffic Class” field (8 bit unsigned integer). Default is 0.</li>
<li><code>flow_label</code> - “Flow Label” field (20 bit unsigned integer). Default is 0.</li>
<li><code>next_header</code> - “Next Header” field (8 bit unsigned integer). Default is 0.</li>
<li><code>hop_limit</code> - “Hop Limit” field (8 bit unsigned integer). Default is 0.</li>
</ul>
<p>— Method <strong>ipv6:dst</strong> <em>ip</em></p>
<p>— Method <strong>ipv6:src</strong> <em>ip</em></p>
<p>— Method <strong>ipv6:traffic_class</strong> <em>traffic_class</em></p>
<p>— Method <strong>ipv6:flow_label</strong> <em>flow_label</em></p>
<p>— Method <strong>ipv6:next_header</strong> <em>next_header</em></p>
<p>— Method <strong>ipv6:hop_limit</strong> <em>hop_limit</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of an IPv6 header. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:version</strong> <em>version</em></p>
<p>Combined accessor and setter method for the version field (4 bit unsigned integer). Defaults to 4 (set automatically by <code>new</code>). Sets the “Version” field to <em>version</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:dscp</strong> <em>dscp</em></p>
<p>Combined accessor and setter method for the “Differentiated Services Code Point” field (6 bit unsigned integer). Default is 0. This is a sub-field of the “Traffic Class” field. Sets the “Differentiated Services Code Point” field to <em>dscp</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:ecn</strong> <em>ecn</em></p>
<p>Combined accessor and setter method for the “Explicit Congestion Notification” (2 bit unsigned integer). Default is 0. This is a sub-field of the “Traffic Class” field. Sets the “Explicit Congestion Notification” field to <em>ecn</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:payload_length</strong> <em>length</em></p>
<p>Combined accessor and setter method for the “Payload Length” field (16 bit unsigned integer). Default is 0. Sets the “Payload Length” field to <em>length</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:dst_eq</strong> <em>ip</em></p>
<p>— Method <strong>ipv6:src_eq</strong> <em>ip</em></p>
<p>Predicate methods to test if <em>ip</em> is equal to the source or destination addresses individually.</p>
<p>— Function <strong>ipv6:pton</strong> <em>string</em></p>
<p>Returns the binary representation of IPv6 address denoted by <em>string</em>.</p>
<p>— Function <strong>ipv6:ntop</strong> <em>ip</em></p>
<p>Returns the string representation of <em>ip</em> address.</p>
<p>— Function <strong>ipv6:solicited_node_mcast</strong> <em>ip</em></p>
<p>Returns the solicited-node multicast address from the given unicast <em>ip</em>.</p>
<h3 id="tcp-lib.protocol.tcp"><a href="#tcp-lib.protocol.tcp">TCP (lib.protocol.tcp)</a></h3>
<p>The <code>lib.protocol.tcp</code> module contains a class for representing <em>TCP headers</em>.</p>
<p>— Method <strong>tcp:new</strong> <em>config</em></p>
<p>Returns a new TCP header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>src_port</code> - “Source Port Number” field (16 bit unsigned integer). Default is 0.</li>
<li><code>dst_port</code> - “Destination Port Number” field (16 bit unsigned integer). Default is 0.</li>
<li><code>seq_num</code> - “Sequence Number” field (32 bit unsigned integer). Default is 0.</li>
<li><code>ack_num</code> - “Acknowledgement Number” field (32 bit unsigned integer). Default is 0.</li>
<li><code>window_size</code> - “Window Size” field (16 bit unsigned integer). Default is 0.</li>
<li><code>offset</code> - “Data Offset” field (4 bit unsigned integer). Default is 0.</li>
<li><code>ns</code> - “NS” flag (1 bit). Default is 0.</li>
<li><code>cwr</code> - “CWR” flag (1 bit). Default is 0.</li>
<li><code>ece</code> - “ECE” flag (1 bit). Default is 0.</li>
<li><code>urg</code> - “URG” flag (1 bit). Default is 0.</li>
<li><code>ack</code> - “ACK” flag (1 bit). Default is 0.</li>
<li><code>psh</code> - “PSH” flag (1 bit). Default is 0.</li>
<li><code>rst</code> - “RST” flag (1 bit). Default is 0.</li>
<li><code>syn</code> - “SYN” flag (1 bit). Default is 0.</li>
<li><code>fin</code> - “FIN” flag (1 bit). Default is 0.</li>
</ul>
<p>— Method <strong>tcp:src_port</strong> <em>port</em></p>
<p>— Method <strong>tcp:dst_port</strong> <em>port</em></p>
<p>— Method <strong>tcp:seq_num</strong> <em>seq_num</em></p>
<p>— Method <strong>tcp:ack_num</strong> <em>ack_num</em></p>
<p>— Method <strong>tcp:window_size</strong> <em>window_size</em></p>
<p>— Method <strong>tcp:offset</strong> <em>offset</em></p>
<p>— Method <strong>tcp:ns</strong> <em>ns</em></p>
<p>— Method <strong>tcp:cwr</strong> <em>cwr</em></p>
<p>— Method <strong>tcp:ece</strong> <em>ece</em></p>
<p>— Method <strong>tcp:urg</strong> <em>urg</em></p>
<p>— Method <strong>tcp:ack</strong> <em>ack</em></p>
<p>— Method <strong>tcp:psh</strong> <em>psh</em></p>
<p>— Method <strong>tcp:rst</strong> <em>rst</em></p>
<p>— Method <strong>tcp:syn</strong> <em>syn</em></p>
<p>— Method <strong>tcp:fin</strong> <em>fin</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of a TCP header. If no argument is given the current value is returned.</p>
<p>— Method <strong>tcp:flags</strong> <em>flags</em></p>
<p>Combined accessor and setter method for the TCP header flags (NS, CRW, ECE, URG, ACK, PSH, RST, SYN and FIN). Sets the header’s flags accoring to <em>flags</em> (9 bit unsigned intetger). If no argument is given the current flags are returned.</p>
<p>— Method <strong>tcp:checksum</strong> <em>payload</em>, <em>length</em>, <em>ip</em></p>
<p>Computes and sets the “Checksum” field for <em>length</em> bytes of <em>payload</em> and optionally <em>ip</em>. If no argument is given the current value of the “Checksum” field is returned.</p>
<h3 id="udp-lib.protocol.udp"><a href="#udp-lib.protocol.udp">UDP (lib.protocol.udp)</a></h3>
<p>The <code>lib.protocol.udp</code> module contains a class for representing <em>UDP headers</em>.</p>
<p>— Method <strong>udp:new</strong> <em>config</em></p>
<p>Returns a new UDP header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>src_port</code> - “Source Port Number” field (16 bit unsigned integer). Default is 0.</li>
<li><code>dst_port</code> - “Destination Port Number” field (16 bit unsigned integer). Default is 0.</li>
</ul>
<p>— Method <strong>udp:src_port</strong> <em>port</em></p>
<p>— Method <strong>udp:dst_port</strong> <em>port</em></p>
<p>Combined accessor and setter methods for the source and destination port fields. Sets the source or destination port individually. Returns the current port if called without arguments. Default is 8 (the UDP header length).</p>
<p>— Method <strong>udp:length</strong> <em>length</em></p>
<p>Combined accessor and setter method for the “Length” field. Sets the “Length” field* to <em>length</em> (a 16 bit unsigned integer). If no argument is given the current value of the “Length” field is returned.</p>
<p>— Method <strong>udp:checksum</strong> <em>payload</em>, <em>length</em>, <em>ip</em></p>
<p>Computes and sets the “Checksum” field for <em>length</em> bytes of <em>payload</em> and optionally <em>ip</em>. If no argument is given the current value of the “Checksum” field is returned.</p>
<h3 id="gre-lib.protocol.gre"><a href="#gre-lib.protocol.gre">GRE (lib.protocol.gre)</a></h3>
<p>The <code>lib.protocol.gre</code> module contains a class for representing <em>GRE headers</em>. The <code>gre</code> protocol class only supports the checksum and key extensions and the <code>lib.protocol.ethernet</code> upper layer protocol.</p>
<p>— Method <strong>gre:new</strong> <em>config</em></p>
<p>Returns a new GRE header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>protocol</code> - Upper layer protocol. May be <code>0x6558</code> (Ethernet). Default is <code>nil</code>.</li>
<li><code>checksum</code> - Set to <code>true</code> to enable checksumming. Default is <code>false</code>.</li>
<li><code>key</code> - 32 bit unsigned integer. Enables keying if supplied. Default is <code>nil</code>.</li>
</ul>
<p>— Method <strong>gre:checksum</strong> <em>payload</em>, <em>length</em></p>
<p>Combined accessor and setter method for the checksum field. Computes and sets the checksum field for <em>length</em> bytes of <em>payload</em>. If no argument is given the current checksum is returned. Returns <code>nil</code> if checksumming is disabled.</p>
<p>— Method <strong>gre:checksum_check</strong> <em>payload</em>, <em>length</em></p>
<p>Predicate to verify <em>length</em> bytes of <em>payload</em> against the header checkum. Return <code>nil</code> if checksumming is disabled.</p>
<p>— Method <strong>gre:key</strong> <em>key</em></p>
<p>Combined accessor and setter method for the key field. Sets the key field to <em>key</em>. If no argument is given the current key is returned. Returns <code>nil</code> if keying is disabled.</p>
<p>— Method <strong>gre:protocol</strong> <em>protocol</em></p>
<p>Combined accessor and setter method for the upper layer protocol. Sets the upper layer protocol to <em>protocol</em>. If no argument is given the current upper layer protocol is returned.</p>
<h3 id="icmp-lib.protocol.icmp.header"><a href="#icmp-lib.protocol.icmp.header">ICMP (lib.protocol.icmp.header)</a></h3>
<p>The <code>lib.protocol.icmp.header</code> module contains a class for representing <em>ICMP headers</em>. The <code>icmp</code> protocol class currently supports two upper layer protocols: <code>lib.protocol.icmp.nd.ns</code> and <code>lib.protocol.icmp.nd.na</code>. These upper layer protocols implement the headers necessary to perform “Neighbor Discovery”.</p>
<p>— Method <strong>icmp:new</strong> <em>type</em>, <em>code</em></p>
<p>Returns a new ICMP header of <em>type</em> which may be either 135 or 136 for <code>lib.protocol.icmp.nd.ns</code> or <code>lib.protocol.icmp.nd.na</code> respectively. Optionally <em>code</em> can be supplied to set the “Code” field for the type.</p>
<p>— Method <strong>icmp:type</strong> <em>type</em></p>
<p>— Method <strong>icmp:code</strong> <em>code</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of an ICMP header. If no argument is given the current value is returned.</p>
<p>— Method <strong>icmp:checksum</strong> <em>payload</em>, <em>length</em>, <em>ipv6</em></p>
<p>Computes and sets the “Checksum” field for <em>length</em> bytes of <em>payload</em>. If the lower protocol layer is <code>lib.protocol.ipv6</code> then <em>ipv6</em> must be set to a true value.</p>
<p>— Method <strong>icmp:checksum_check</strong> <em>payload</em>, <em>length</em>, <em>ipv6</em></p>
<p>Predicate to test if the header’s “Checksum” field matches <em>length</em> bytes of <em>payload</em>. If the lower protocol layer is <code>lib.protocol.ipv6</code> then <em>ipv6</em> must be set to a true value.</p>
<h4 id="neighbor-solicitation-lib.protocol.icmp.nd.ns"><a href="#neighbor-solicitation-lib.protocol.icmp.nd.ns">Neighbor Solicitation (lib.protocol.icmp.nd.ns)</a></h4>
<p>— Method <strong>ns:new</strong> <em>target</em></p>
<p>Returns a new <em>Neighbor Solicitation</em> header. <em>Target</em> is the IP address used for the “Target Address” field.</p>
<p>— Method <strong>ns:target</strong> <em>target</em></p>
<p>Combined accessor and setter method for the “Target Address” field. Sets the “Target Address” field to <em>target</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ns:target_eq</strong> <em>target</em></p>
<p>Predicate to test if the header’s value in the “Target Address” field is equivalent to <em>target</em>.</p>
<h4 id="neighbor-advertisement-lib.protocol.icmp.nd.na"><a href="#neighbor-advertisement-lib.protocol.icmp.nd.na">Neighbor Advertisement (lib.protocol.icmp.nd.na)</a></h4>
<p>— Method <strong>na:new</strong> <em>target</em>, <em>router</em>, <em>solicited</em>, <em>override</em></p>
<p>Returns a new <em>Neighbor Advertisement</em> header. <em>Target</em> is the IP address used for the “Target Address” field. <em>Router</em>, <em>solicited</em> and <em>override</em> can be boolean values to set the “Router”, “Solicited” and “Override” flags respectively. The default for the flags is 0.</p>
<p>— Method <strong>ns:target</strong> <em>target</em></p>
<p>— Method <strong>ns:router</strong> <em>router</em></p>
<p>— Method <strong>ns:solicited</strong> <em>solicited</em></p>
<p>— Method <strong>ns:override</strong> <em>override</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of an Neighbor Advertisement header. If no argument is given the current value is returned.</p>
<p>— Method <strong>ns:target_eq</strong> <em>target</em></p>
<p>Predicate to test if the header’s value in the “Target Address” field is equivalent to <em>target</em>.</p>
<h4 id="neighbor-discovery-options-lib.protocol.icmp.nd.header"><a href="#neighbor-discovery-options-lib.protocol.icmp.nd.header">Neighbor Discovery Options (lib.protocol.icmp.nd.header)</a></h4>
<p>Both Neighbor Solicitation and Advertisement (<code>lib.protocol.icmp.nd.ns</code> and <code>lib.protocol.icmp.nd.na</code>) headers implement an <code>options</code> method for parsing <em>TLV Options</em> contained in the their payloads.</p>
<p>Example:</p>
<pre><code> -- Parse datagram with ICMP/NA packet
local na = dgram:parse()
 -- Parse TLV Options
local options = na:options(dgram:payload())</code></pre>
<p>— Method <strong>nd:options</strong> <em>payload</em>, <em>length</em></p>
<p>Parses and returns an array of TLV Options (see <code>lib.protocol.icmp.nd.options.tlv</code>) from <em>length</em> bytes of <em>payload</em>.</p>
<h4 id="tlv-option-lib.protocol.icmp.nd.options.tlv"><a href="#tlv-option-lib.protocol.icmp.nd.options.tlv">TLV Option (lib.protocol.icmp.nd.options.tlv)</a></h4>
<p>The <code>lib.protocol.icmp.nd.options.tlv</code> module contains a class for representing TLV Options. Currently only two types of options are implemented: “Source Link-Layer Address” (<code>&quot;src_ll_addr&quot;</code>) and “Target Link-Layer Address” (<code>&quot;tgt_ll_address&quot;</code>). Both are represented by the <code>lladdr</code> class (see <code>lib.protocol.icmp.nd.options.lladdr</code>).</p>
<p>— Method <strong>tlv:new</strong> <em>type</em>, <em>data</em></p>
<p>Returns a new TLV Option object for <em>data</em> of <em>type</em>. <em>Type</em> may be either 1 for “Source Link-Layer Address” or 2 for “Target Link-Layer Address”. <em>Data</em> must be a <code>lladdr</code> object.</p>
<p>— Method <strong>tlv:name</strong></p>
<p>Returns a string denoting the type of the option. Either <code>&quot;src_ll_addr&quot;</code> for “Source Link-Layer Address” or <code>&quot;tgt_ll_address&quot;</code> for “Target Link-Layer Address”.</p>
<p>— Method <strong>tlv:length</strong></p>
<p>Returns the the size of the TLV Option as multiples of 8 bytes.</p>
<p>— Method <strong>tlv:type</strong> <em>type</em></p>
<p>Combined accessor and setter method. Sets the type field (see <code>new</code>) to <em>type</em>. If no argument is given the current value of the type field is returned.</p>
<p>— Method <strong>tlv:option</strong></p>
<p>Returns an object of the class denoted by the type field. Currently that only includes <code>lladdr</code> instances.</p>
<h4 id="link-layer-address-option-lib.protocol.icmp.nd.options.lladdr"><a href="#link-layer-address-option-lib.protocol.icmp.nd.options.lladdr">Link-Layer Address Option (lib.protocol.icmp.nd.options.lladdr)</a></h4>
<p>The <code>lib.protocol.icmp.nd.options.lladdr</code> module contains a class for representing Link-Layer Address Options.</p>
<p>— Method <strong>lladdr:new</strong> <em>address</em></p>
<p>Returns a new Link-Layer Option object for MAC <em>address</em> in binary representation.</p>
<p>— Method <strong>lladdr:name</strong></p>
<p>Returns the string <code>&quot;ll_addr&quot;</code>.</p>
<p>— Method <strong>lladdr:addr</strong> <em>address</em></p>
<p>Combined accessor and setter method. Sets the address field (see <code>new</code>) to <em>address</em>. If no argument is given the current value of the address field is returned.</p>
<h3 id="datagram-lib.protocol.datagram"><a href="#datagram-lib.protocol.datagram">Datagram (lib.protocol.datagram)</a></h3>
<p>The <code>lib.protocol.datagram</code> module provides basic mechanisms for parsing, building and manipulating a hierarchy of protocol headers and the associated payload contained in a data packet. In particular, it supports:</p>
<ul>
<li>Parsing and in-place manipulation of protocol headers in a received packet</li>
<li>In-place decapsulation by removing leading protocol headers</li>
<li>Adding headers to an existing packet</li>
<li>Creation of a new packet</li>
<li>Appending payload to a packet</li>
</ul>
<p>It mediates between packets as defined in <code>core.packet</code> and <em>protocol classes</em> which are defined as classes derived from the protocol header base class in the <code>lib.protocol.header</code> module.</p>
<p>The contents of a datagram instance are logically divided into three areas: The payload, parsed headers and pushed headers. The datagram payload is a sequence of bytes either inherited from the packet given to <code>datagram:new</code> or appended using <code>datagram:payload</code>. The headers in the payload can be parsed using <code>datagram:parse_match</code>, which will shrink the payload by the header. Finally, synthetic headers can be prepended to the datagram using <code>datagram:push</code>. To get the whole datagram as a packet use <code>datagram:packet</code>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Datagram" /><p class="caption">Datagram</p>
</div>
<p>A datagram can be used in two modes of operation, called “immediate commit” and “delayed commit”. In immediate commit mode, the <code>push</code> and <code>pop</code> methods immediately modify the underlying packet. However, this can be undesireable.</p>
<p>Even though the manipulations are relatively fast by using SIMD instructions to move and copy data when possible, performance-aware applications usually try to avoid as much of them as possible. This creates a conflict if the caller performs operations to push or parse a sequence of protocol headers in immediate commit mode.</p>
<p>This problem can be avoided by using delayed commit mode. In this mode, the <code>push</code> methods add the data to a separate buffer as intermediate storage. The buffer is prepended to the actual packet in a single operation by calling <code>datagram:commit</code>.</p>
<p>The <code>pop</code> methods are made light-weight in delayed commit mode as well by keeping track of an additional offset that indicates where the actual packet starts in the packet buffer. Each call to one of the <code>pop</code> methods simply increases the offset by the size of the popped piece of data. The accumulated actions will be applied as a single operation by <code>datagram:commit</code>.</p>
<p>The <code>push</code> and <code>pop</code> methods can be freely mixed in delayed commit mode.</p>
<p>Due to the destructive nature of these methods in immediate commit mode, they cannot be applied when the parse stack is not empty, because moving the data in the packet buffer will invalidate the parsed headers. The <code>push</code> and <code>pop</code> methods will raise an error in that case.</p>
<p>The buffer used in delayed commit mode has a fixed size of 512 bytes. This limits the size of data that can be pushed in a single operation. A sequence of push/commit operations can be used to push an arbitrary amount of data in chunks of up to 512 bytes.</p>
<p>— Method <strong>datagram:new</strong> <em>packet</em>, <em>protocol</em>, <em>options</em></p>
<p>Creates a datagram for <em>packet</em> or from scratch if <em>packet</em> is <code>nil</code>. <em>Protocol</em> will be used by <code>parse_match</code> to parse the packet payload. If <em>protocol</em> is not <code>nil</code> it is set as the initial upper layer protocol. If <em>options</em> is not <code>nil</code> it must be a table that selects configurable properties of the class. Currently, the only option is the selection of immediate or delayed commit mode by setting the key <code>delayed_commit</code> to <code>false</code> or <code>true</code>, respectively. The default is immediate commit mode.</p>
<p>— Method <strong>datagram:push</strong> <em>header</em></p>
<p>Prepends <em>header</em> to the front of the datagram. This method destructively modifies the underlying packet in immediate commit mode and raises an error if the parse stack is not empty.</p>
<p>In delayed commit mode, <em>header</em> is prepended to an intermediate buffer.</p>
<p>— Method <strong>datagram:push_raw</strong> <em>data</em>, <em>length</em></p>
<p>This method behaves like the <em>datagram:push</em> method for an arbitrary chunk of memory of length <em>length</em> located at the address pointed to by <em>data</em>.</p>
<p>— Method <strong>datagram:parse_match</strong> <em>protocol</em>, <em>check</em></p>
<p>Attempts to parse the next header in the datagram, thereby removing it from the payload. Returns a header instance of class <em>protocol</em> on success. If <em>protocol</em> is <code>nil</code> the current upper layer protocol as set by <code>datagram:new</code> or previous calls to <code>parse_match</code> is used.</p>
<p>If neither <em>protocol</em> nor the upper layer protocol is set or the constructor of the protocol class returns <code>nil</code>, the parsing operation has failed and <code>parse_match</code> returns <code>nil</code>. The datagram remains unchanged.</p>
<p>If the protocol class instance has been created successfully, it is passed as single argument to the anonymous function <em>check</em>.</p>
<p>If <em>check</em> returns a false value, the parsing has failed and <code>parse_match</code> returns <code>nil</code>. The packet remains unchanged.</p>
<p>If <em>check</em> is not supplied or if it returned a true value, the parsing has succeeded and the current upper layer protocol of the datagram is set to the value returned by <code>header:upper_layer</code>.</p>
<p>— Method <strong>datagram:parse</strong> <em>protocols_and_checks</em></p>
<p>A wrapper around <code>parse_match</code> that allows parsing of a sequence of headers with a single method call.</p>
<p>If <em>protocols_and_checks</em> is a sequence of protocol class and check function pairs, <code>parse_match</code> is called for each pair. Returns the header object of the last header parsed or <code>nil</code> if any of the calls to <code>parse_match</code> return <code>nil</code>.</p>
<p>If called with a <code>nil</code> argument, this method is equivalent to <code>parse_match</code> called without arguments.</p>
<p>— Method <strong>datagram:parse_n</strong> <em>n</em></p>
<p>A wrapper around <code>parse_match</code> that parses the next <em>n</em> protocol headers using the current upper layer protocol and subsequent values of <code>header:upper_layer</code>. It returns the last header object or <code>nil</code> if less than <em>n</em> headers could be parsed successfully.</p>
<p>— Method <strong>datagram:unparse</strong> <em>n</em></p>
<p>Undoes the last <em>n</em> calls to <code>parse_match</code> on the datagram. E.g. prepends <em>n</em> parsed headers back to the payload. The sequence of parsed headers can be obtained by calling <code>stack</code>.</p>
<p>— Method <strong>datagram:pop</strong> <em>n</em></p>
<p>Removes the leading <em>n</em> parsed headers from the datagram. Note that headers added via <code>push</code> can not be removed using <code>pop</code>. The caller has to ensure that the datagram contains at least <em>n</em> headers that were parsed using <code>parse_match</code>. The sequence of parsed headers can be obtained by calling <code>stack</code>. This method destructively modifies the underlying packet in immediate commit mode and raises an error if the parse stack is not empty.</p>
<p>In delayed commit mode, the packet is not modified and the parse stack remains valid.</p>
<p>For instance let <em>d</em> be an datagram with an Ethernet header followed by an IPv6 header. Assuming we have parsed both headers using <code>d:parse_n(2)</code>, we could call <code>d:pop(1)</code> to decapsulate the IPv6 packet from its Ethernet header.</p>
<p>— Method <strong>datagram:pop_raw</strong> <em>length</em>, <em>ulp</em></p>
<p>Removes <em>length</em> bytes from the beginning of the datagram. If <em>ulp</em> is given it is set as the current upper layer protocol. This method destructively modifies the underlying packet in immediate commit mode and raises an error if the parse stack is not empty.</p>
<p>In delayed commit mode, the packet is not modified and the parse stack remains valid.</p>
<p>— Method <strong>datagram:stack</strong></p>
<p>Returns the parsed header objects as a sequence.</p>
<p>— Method <strong>datagram:packet</strong></p>
<p>Returns a packet (see <code>core.packet</code>) containing the datagram (including pushed headers).</p>
<p>— Method <strong>datagram:payload</strong> <em>pointer</em>, <em>length</em></p>
<p>Combined payload accessor and setter method. Returns a pointer to the datagram payload and its byte size.</p>
<p>If <em>pointer</em> and <em>length</em> are supplied then <em>length</em> bytes starting from <em>pointer</em> are appended to the datagram’s payload.</p>
<p>— Method <strong>datagram:data</strong></p>
<p>Returns the location and size of the buffer of the underlying packet. This is a shortcut to <em>datagram:packet</em> followed by calls to <em>packet.data</em> and <em>pakcet.length</em>.</p>
<ul>
<li>Method <strong>datagram:commit</strong></li>
</ul>
<p>If called in delayed commit mode, the operations accumulated by the <code>push</code> and <code>pop</code> methods since the creation of the datagram or the last invocation of <em>datagram:commit</em> are commited to the underlying packet. An error is raised if the parse stack is not empty.</p>
<p>The method can be safely called in immediate commit mode.</p>
<h2 id="snabb-nfv"><a href="#snabb-nfv">Snabb NFV</a></h2>
<h3 id="nfv-config-program.snabbnfv.nfvconfig"><a href="#nfv-config-program.snabbnfv.nfvconfig">NFV config (program.snabbnfv.nfvconfig)</a></h3>
<p>The <code>program.snabbnfv.nfvconfig</code> module implements a <a href="https://en.wikipedia.org/wiki/Network_Functions_Virtualization">Network Functions Virtualization</a> component based on Snabb. It introduces a simple configuration file format to describe NFV configurations which it then compiles to app networks. This NFV component is compatible with <a href="https://wiki.openstack.org/wiki/Neutron">OpenStack Neutron</a>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="NFV" /><p class="caption">NFV</p>
</div>
<p>— Function <strong>nfvconfig.load</strong> <em>file</em>, <em>pci_address</em>, <em>socket_path</em></p>
<p>Loads the NFV configuration from <em>file</em> and compiles an app network using <em>pci_address</em> and <em>socket_path</em> for the underlying NIC driver and <code>VhostUser</code> apps. Returns the resulting engine configuration.</p>
<h4 id="nfv-configuration-format"><a href="#nfv-configuration-format">NFV Configuration Format</a></h4>
<p>The configuration file format understood by <code>program.snabbnfv.nfvconfig</code> is based on <em>Lua expressions</em>. Initially, it contains a list of NFV <em>ports</em>:</p>
<pre><code>return { &lt;port-1&gt;, ..., &lt;port-n&gt; }</code></pre>
<p>Each port is defined by a range of properties which correspond to the configuration parameters of the underlying apps (NIC driver, <code>VhostUser</code>, <code>PcapFilter</code>, <code>RateLimiter</code>, <code>nd_light</code> and <code>SimpleKeyedTunnel</code>):</p>
<pre><code>port := { port_id        = &lt;id&gt;,          -- A unique string
          mac_address    = &lt;mac-address&gt;, -- MAC address as a string
          vlan           = &lt;vlan-id&gt;,     -- ..
          ingress_filter = &lt;filter&gt;,       -- A pcap-filter(7) expression
          egress_filter  = &lt;filter&gt;,       -- ..
          tunnel         = &lt;tunnel-conf&gt;,
          rx_police_gbps = &lt;n&gt;,           -- Allowed input rate in Gbps
          tx_police_gbps = &lt;n&gt; }          -- Allowed output rate in Gbps</code></pre>
<p>The <code>tunnel</code> section deviates a little from <code>SimpleKeyedTunnel</code>’s terminology:</p>
<pre><code>tunnel := { type          = &quot;L2TPv3&quot;,     -- The only type (for now)
            local_cookie  = &lt;cookie&gt;,     -- As for SimpleKeyedTunnel
            remote_cookie = &lt;cookie&gt;,     -- ..
            next_hop      = &lt;ip-address&gt;, -- Gateway IP
            local_ip      = &lt;ip-address&gt;, -- ~ `local_address'
            remote_ip     = &lt;ip-address&gt;, -- ~ `remote_address'
            session       = &lt;32bit-int&gt;   -- ~ `session_id' }</code></pre>
<h3 id="snabbnfv-traffic"><a href="#snabbnfv-traffic">snabbnfv traffic</a></h3>
<p>The <code>snabbnfv traffic</code> program loads and runs a NFV configuration using <code>program.snabbnfv.nfvconfig</code>. It can be invoked like so:</p>
<pre><code>./snabb snabbnfv traffic &lt;file&gt; &lt;pci-address&gt; &lt;socket-path&gt;</code></pre>
<p><code>snabbnfv traffic</code> runs the loaded configuration indefinitely and automatically reloads the configuration file if it changes (at most once every second).</p>
<h3 id="snabbnfv-neutron2snabb"><a href="#snabbnfv-neutron2snabb">snabbnfv neutron2snabb</a></h3>
<p>The <code>snabbnfv neutron2snabb</code> program converts Neutron database CSV dumps to the format used by <code>program.snabbnfv.nfvconfig</code>. For more info see <a href="doc/architecture.md">Snabb NFV Architecture</a>. It can be invoked like so:</p>
<pre><code>./snabb snabbnfv neutron2snabb &lt;csv-directory&gt; &lt;output-directory&gt; [&lt;hostname&gt;]</code></pre>
<p><code>snabbnfv neutron2snabb</code> reads the Neutron configuration <em>csv-directory</em> and translates them to one <code>lib.nfv.conig</code> configuration file per physical network. If <em>hostname</em> is given, it overrides the hostname provided by <code>hostname(1)</code>.</p>
<h2 id="watchdog-lib.watchdog.watchdog"><a href="#watchdog-lib.watchdog.watchdog">Watchdog (lib.watchdog.watchdog)</a></h2>
<p>The <code>lib.watchdog.watchdog</code> module implements a per-thread watchdog functionality. Its purpose is to watch and kill processes which fail to call the watchdog periodically (e.g. hang).</p>
<p>It does so by using <em>alarm(3)</em> and <em>ualarm(3)</em> to have the OS send a <em>SIGALRM</em> to the process after a specified timeout. Because the process does not handle the signal it will be killed and exit with status <em>142</em>.</p>
<p>— Function <strong>watchdog.set</strong> <em>milliseconds</em></p>
<p>Set watchdog timeout to <em>milliseconds</em>. Values for <em>milliseconds</em> greater than 1,000 are truncated to the next second. For example:</p>
<pre><code>watchdog.set(1100) == watchdog.set(2000)</code></pre>
<p>— Function <strong>watchdog.reset</strong></p>
<p>Starts the timout if the watchdog has not yet been started and resets the timeout otherwise. If the timeout is reached the process will be killed.</p>
<p>— Function <strong>watchdog.stop</strong></p>
<p>Disables the timeout.</p>
</body>
</html>
