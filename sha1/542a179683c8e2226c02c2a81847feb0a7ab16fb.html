<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Mike Pall" />
  <meta name="author" content="Luke Gorrie" />
  <meta name="author" content="Andy Wingo" />
  <meta name="author" content="Max Rottenkolber" />
  <meta name="author" content="Diego Pino Garcia" />
  <meta name="author" content="Asumu Takikawa" />
  <meta name="author" content="Jessica Tallon" />
  <meta name="author" content="Diego Pino" />
  <meta name="author" content="Alexander Gall" />
  <meta name="author" content="Cosmin Apreutesei" />
  <meta name="author" content="Nikolay Nikolaev" />
  <meta name="author" content="Katerina Barone-Adesi" />
  <meta name="author" content="Hans Huebner" />
  <meta name="author" content="Javier Guerra" />
  <meta name="author" content="Marcel Wiget" />
  <meta name="author" content="Nicola Larosa" />
  <meta name="author" content="Pete Bristow" />
  <meta name="author" content="Adrian Perez de Castro" />
  <meta name="author" content="Adrián Pérez de Castro" />
  <meta name="author" content="Nicola tekNico Larosa" />
  <meta name="author" content="Antonio Nikishaev" />
  <meta name="author" content="Domen Kožar" />
  <meta name="author" content="Alexander Altshuler" />
  <meta name="author" content="Rolf Sommerhalder" />
  <meta name="author" content="Timo Buhrmester" />
  <meta name="author" content="Pete Kazmier" />
  <meta name="author" content="Mikhail Nazarov" />
  <meta name="author" content="Kristian Larsson" />
  <meta name="author" content="Justin Cormack" />
  <meta name="author" content="Felix Geißler" />
  <meta name="author" content="R. Matthew Emerson" />
  <meta name="author" content="Michael G" />
  <meta name="author" content="Christian Graf" />
  <meta name="author" content="Carlos Alberto Lopez Perez" />
  <meta name="author" content="Jeff Loughridge" />
  <meta name="author" content="Kacper Wysocki" />
  <meta name="author" content="Adrian Perez" />
  <meta name="author" content="Vladimir Fedin" />
  <meta name="author" content="Vincenzo Maffione" />
  <meta name="author" content="Tomas Korcak" />
  <meta name="author" content="Tim Upthegrove" />
  <meta name="author" content="Tim LaBerge" />
  <meta name="author" content="Stevan Markovic" />
  <meta name="author" content="Simon Leinen" />
  <meta name="author" content="Ryan Hartlage" />
  <meta name="author" content="Peter Cawley" />
  <meta name="author" content="Kristian Kielhofner" />
  <meta name="author" content="Jon Olsson" />
  <meta name="author" content="Jianbo Liu" />
  <meta name="author" content="Jay Fenton" />
  <meta name="author" content="James Cunningham" />
  <meta name="author" content="Hui Xiang" />
  <meta name="author" content="Gernot Nusshall" />
  <meta name="author" content="Fabian Bonk" />
  <meta name="author" content="Edward Hope-Morley" />
  <meta name="author" content="Ben Agricola" />
  <meta name="author" content="Anshul Makkar" />
  <meta name="author" content="Andy Chong" />
  <meta name="author" content="Alex Kordic" />
  <meta name="author" content="Alexandr Kostrikov" />
  <meta name="author" content="Alexander Spyridakis" />
  <title>Snabb Reference Manual</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link href="data:text/css;charset=utf-8,%0A%23TOC%20%7B%0Aposition%3A%20fixed%3B%0Aoverflow%3A%20scroll%3B%0Atop%3A%200%3B%0Aleft%3A%200%3B%0Awidth%3A%2019%2E6em%3B%0Aheight%3A%20100%25%3B%0Amargin%3A%200%3B%0Apadding%3A%200%3B%0A%7D%0A%23TOC%20%3E%20header%20%7B%0Amargin%2Dtop%3A%201%2E4em%3B%0A%7D%0A%23TOC%20ul%2C%20%23TOC%20ol%20%7B%0Apadding%2Dleft%3A%201%2E4em%3B%0Amargin%3A%200%3B%0A%7D%0A%23TOC%20%3E%20ul%2C%20%23TOC%20%3E%20ol%20%7B%0Apadding%2Dtop%3A%200%2E7em%3B%0Awidth%3A%2025%2E2em%3B%0A%7D%0Abody%20%7B%0Amargin%3A%200%200%200%2021em%3B%0A%7D%0Abody%20%7B%0Amax%2Dwidth%3A%2040em%3B%0Afont%2Dfamily%3A%20sans%2Dserif%3B%0A%7D%0Acode%2C%20pre%20%7B%0Acolor%3A%20%23333%3B%0Abackground%3A%20%23f7f7f7%3B%0A%7D%0Apre%20%7B%0Apadding%3A%200%2E6em%3B%0A%7D%0Apre%20%3E%20code%20%7B%0Apadding%3A%200%3B%0Abackground%3A%20none%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%200%2E2em%200%2E1em%200%2E2em%3B%0A%7D%0Ap%2C%20li%20%7B%0Aline%2Dheight%3A%201%2E5%3B%0A%7D%0Ap%2Ecaption%20%7B%0Adisplay%3A%20none%3B%0A%7D%0Ah1%2Etitle%20%7B%0Afont%2Dsize%3A%202em%3B%0A%7D%0Ah2%2Eauthor%20%7B%0Adisplay%3A%20inline%3B%0Afont%2Dsize%3A%20small%3B%0Afont%2Dweight%3A%20normal%3B%0Awhite%2Dspace%3A%20nowrap%3B%0A%7D%0Ah2%2Eauthor%3Aafter%20%7B%0Acontent%3A%20%27%2C%20%27%3B%0Awhite%2Dspace%3A%20normal%3B%0A%7D%0Ah2%2Eauthor%3Anth%2Dlast%2Dchild%28%2Dn%2B2%29%3Aafter%20%7B%0Acontent%3A%20%27%27%3B%0A%7D%0Ah3%2Edate%20%7B%0Afont%2Dfamily%3A%20monospace%3B%0Afont%2Dsize%3A%20medium%3B%0Afont%2Dweight%3A%20normal%3B%0A%7D%0Adiv%23TOC%20a%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%20a%2C%20h2%20a%2C%20h3%20a%2C%20h4%20a%2C%20h5%20a%2C%20h6%20a%20%7B%0Atext%2Ddecoration%3A%20none%3B%0Acolor%3A%20black%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%201%2E8em%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%201%2E6em%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E4em%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E2em%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201%2E0em%3B%0A%7D%0Ah6%20%7B%0Afont%2Dweight%3A%20normal%3B%0Afont%2Dsize%3A%201%2E0em%3B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Adiv%2Efigure%20%3E%20img%20%7B%0Adisplay%3A%20block%3B%0Amargin%3A%20auto%3B%0A%7D%0A" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="header">
<h1 class="title">Snabb Reference Manual</h1>
<h2 class="author">Mike Pall</h2>
<h2 class="author">Luke Gorrie</h2>
<h2 class="author">Andy Wingo</h2>
<h2 class="author">Max Rottenkolber</h2>
<h2 class="author">Diego Pino Garcia</h2>
<h2 class="author">Asumu Takikawa</h2>
<h2 class="author">Jessica Tallon</h2>
<h2 class="author">Diego Pino</h2>
<h2 class="author">Alexander Gall</h2>
<h2 class="author">Cosmin Apreutesei</h2>
<h2 class="author">Nikolay Nikolaev</h2>
<h2 class="author">Katerina Barone-Adesi</h2>
<h2 class="author">Hans Huebner</h2>
<h2 class="author">Javier Guerra</h2>
<h2 class="author">Marcel Wiget</h2>
<h2 class="author">Nicola Larosa</h2>
<h2 class="author">Pete Bristow</h2>
<h2 class="author">Adrian Perez de Castro</h2>
<h2 class="author">Adrián Pérez de Castro</h2>
<h2 class="author">Nicola ‘tekNico’ Larosa</h2>
<h2 class="author">Antonio Nikishaev</h2>
<h2 class="author">Domen Kožar</h2>
<h2 class="author">Alexander Altshuler</h2>
<h2 class="author">Rolf Sommerhalder</h2>
<h2 class="author">Timo Buhrmester</h2>
<h2 class="author">Pete Kazmier</h2>
<h2 class="author">Mikhail Nazarov</h2>
<h2 class="author">Kristian Larsson</h2>
<h2 class="author">Justin Cormack</h2>
<h2 class="author">Felix Geißler</h2>
<h2 class="author">R. Matthew Emerson</h2>
<h2 class="author">Michael G</h2>
<h2 class="author">Christian Graf</h2>
<h2 class="author">Carlos Alberto Lopez Perez</h2>
<h2 class="author">Jeff Loughridge</h2>
<h2 class="author">Kacper Wysocki</h2>
<h2 class="author">Adrian Perez</h2>
<h2 class="author">Vladimir Fedin</h2>
<h2 class="author">Vincenzo Maffione</h2>
<h2 class="author">Tomas Korcak</h2>
<h2 class="author">Tim Upthegrove</h2>
<h2 class="author">Tim LaBerge</h2>
<h2 class="author">Stevan Markovic</h2>
<h2 class="author">Simon Leinen</h2>
<h2 class="author">Ryan Hartlage</h2>
<h2 class="author">Peter Cawley</h2>
<h2 class="author">Kristian Kielhofner</h2>
<h2 class="author">Jon Olsson</h2>
<h2 class="author">Jianbo Liu</h2>
<h2 class="author">Jay Fenton</h2>
<h2 class="author">James Cunningham</h2>
<h2 class="author">Hui Xiang</h2>
<h2 class="author">Gernot Nusshall</h2>
<h2 class="author">Fabian Bonk</h2>
<h2 class="author">Edward Hope-Morley</h2>
<h2 class="author">Ben Agricola</h2>
<h2 class="author">Anshul Makkar</h2>
<h2 class="author">Andy Chong</h2>
<h2 class="author">Alex Kordic</h2>
<h2 class="author">Alexandr Kostrikov</h2>
<h2 class="author">Alexander Spyridakis</h2>
<h3 class="date">Version 542a179, Fri Aug 24 10:08:41 2018 +0200</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#snabb-api">Snabb API</a><ul>
<li><a href="#app">App</a></li>
<li><a href="#config-core.config">Config (core.config)</a></li>
<li><a href="#engine-core.app">Engine (core.app)</a></li>
<li><a href="#link-core.link">Link (core.link)</a></li>
<li><a href="#packet-core.packet">Packet (core.packet)</a></li>
<li><a href="#memory-core.memory">Memory (core.memory)</a></li>
<li><a href="#shared-memory-core.shm">Shared Memory (core.shm)</a><ul>
<li><a href="#counter-core.counter">Counter (core.counter)</a></li>
<li><a href="#histogram-core.histogram">Histogram (core.histogram)</a></li>
</ul></li>
<li><a href="#lib-core.lib">Lib (core.lib)</a></li>
<li><a href="#multiprocess-operation-core.worker">Multiprocess operation (core.worker)</a></li>
<li><a href="#main">Main</a></li>
</ul></li>
<li><a href="#basic-apps-apps.basic.basic_apps">Basic Apps (apps.basic.basic_apps)</a><ul>
<li><a href="#source">Source</a></li>
<li><a href="#join">Join</a></li>
<li><a href="#split">Split</a></li>
<li><a href="#sink">Sink</a></li>
<li><a href="#tee">Tee</a></li>
<li><a href="#repeater">Repeater</a></li>
<li><a href="#truncate">Truncate</a></li>
<li><a href="#sample">Sample</a></li>
</ul></li>
<li><a href="#intel-82599-ethernet-controller-apps">Intel 82599 Ethernet Controller Apps</a><ul>
<li><a href="#intel82599-apps.intel.intel_app">Intel82599 (apps.intel.intel_app)</a><ul>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#performance">Performance</a></li>
<li><a href="#hardware-limits">Hardware limits</a></li>
</ul></li>
<li><a href="#loadgen-apps.intel.loadgen">LoadGen (apps.intel.loadgen)</a><ul>
<li><a href="#configuration-1">Configuration</a></li>
<li><a href="#performance-1">Performance</a></li>
</ul></li>
</ul></li>
<li><a href="#intel-i210-i350-82599-ethernet-controller-apps-apps.intel_mp.intel_mp">Intel i210 / i350 / 82599 Ethernet Controller apps (apps.intel_mp.intel_mp)</a><ul>
<li><a href="#caveats">Caveats</a></li>
<li><a href="#configuration-2">Configuration</a><ul>
<li><a href="#rss-hashing-methods">RSS hashing methods</a></li>
<li><a href="#default-rss-queue">Default RSS Queue</a></li>
<li><a href="#hardware-limits-1">Hardware limits</a></li>
</ul></li>
</ul></li>
<li><a href="#solarflare-ethernet-controller-apps">Solarflare Ethernet Controller Apps</a><ul>
<li><a href="#solarflare-apps.solarflare.solarflare">Solarflare (apps.solarflare.solarflare)</a><ul>
<li><a href="#configuration-3">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#ratelimiter-app-apps.rate_limiter.rate_limiter">RateLimiter App (apps.rate_limiter.rate_limiter)</a><ul>
<li><a href="#configuration-4">Configuration</a></li>
<li><a href="#performance-2">Performance</a></li>
</ul></li>
<li><a href="#pcapfilter-app-apps.packet_filter.pcap_filter">PcapFilter App (apps.packet_filter.pcap_filter)</a><ul>
<li><a href="#configuration-5">Configuration</a></li>
<li><a href="#special-counters">Special Counters</a></li>
</ul></li>
<li><a href="#ipv4-apps">IPv4 Apps</a><ul>
<li><a href="#arp-apps.ipv4.arp">ARP (apps.ipv4.arp)</a><ul>
<li><a href="#configuration-6">Configuration</a></li>
</ul></li>
<li><a href="#reassembler-apps.ipv4.reassemble">Reassembler (apps.ipv4.reassemble)</a><ul>
<li><a href="#configuration-7">Configuration</a></li>
</ul></li>
<li><a href="#fragmenter-apps.ipv4.fragment">Fragmenter (apps.ipv4.fragment)</a><ul>
<li><a href="#configuration-8">Configuration</a></li>
</ul></li>
<li><a href="#icmp-echo-responder-apps.ipv4.echo">ICMP Echo responder (apps.ipv4.echo)</a><ul>
<li><a href="#configuration-9">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#ipv6-apps">IPv6 Apps</a><ul>
<li><a href="#nd_light-apps.ipv6.nd_light">Nd_light (apps.ipv6.nd_light)</a><ul>
<li><a href="#configuration-10">Configuration</a></li>
<li><a href="#special-counters-1">Special Counters</a></li>
</ul></li>
<li><a href="#simplekeyedtunnel-apps.keyed_ipv6_tunnel.tunnel">SimpleKeyedTunnel (apps.keyed_ipv6_tunnel.tunnel)</a><ul>
<li><a href="#configuration-11">Configuration</a></li>
<li><a href="#special-counters-2">Special Counters</a></li>
</ul></li>
<li><a href="#fragmenter-apps.ipv6.fragment">Fragmenter (apps.ipv6.fragment)</a><ul>
<li><a href="#configuration-12">Configuration</a></li>
</ul></li>
<li><a href="#icmp-echo-responder-apps.ipv6.echo">ICMP Echo responder (apps.ipv6.echo)</a><ul>
<li><a href="#configuration-13">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#vhostuser-app-apps.vhost.vhost_user">VhostUser App (apps.vhost.vhost_user)</a><ul>
<li><a href="#configuration-14">Configuration</a></li>
</ul></li>
<li><a href="#virtionet-app-apps.virtio_net.virtio_net">VirtioNet App (apps.virtio_net.virtio_net)</a><ul>
<li><a href="#configuration-15">Configuration</a></li>
</ul></li>
<li><a href="#pcap-savefile-apps">Pcap Savefile Apps</a><ul>
<li><a href="#pcapreader-and-pcapwriter-apps-apps.pcap.pcap">PcapReader and PcapWriter Apps (apps.pcap.pcap)</a><ul>
<li><a href="#configuration-16">Configuration</a></li>
</ul></li>
<li><a href="#tap-apps.pcap.tap">Tap (apps.pcap.tap)</a><ul>
<li><a href="#configuration-17">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#rawsocket-app-apps.socket.raw">RawSocket App (apps.socket.raw)</a><ul>
<li><a href="#configuration-18">Configuration</a></li>
</ul></li>
<li><a href="#unixsocket-app-apps.socket.unix">UnixSocket App (apps.socket.unix)</a><ul>
<li><a href="#configuration-19">Configuration</a></li>
</ul></li>
<li><a href="#tap-app-apps.tap.tap">Tap app (apps.tap.tap)</a><ul>
<li><a href="#configuration-20">Configuration</a></li>
</ul></li>
<li><a href="#vlan-apps">VLAN Apps</a><ul>
<li><a href="#tagger-apps.vlan.vlan">Tagger (apps.vlan.vlan)</a><ul>
<li><a href="#configuration-21">Configuration</a></li>
</ul></li>
<li><a href="#untagger-apps.vlan.vlan">Untagger (apps.vlan.vlan)</a><ul>
<li><a href="#configuration-22">Configuration</a></li>
</ul></li>
<li><a href="#vlanmux-apps.vlan.vlan">VlanMux (apps.vlan.vlan)</a><ul>
<li><a href="#configuration-23">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#bridge-apps">Bridge Apps</a><ul>
<li><a href="#configuration-24">Configuration</a></li>
<li><a href="#flooding-bridge-apps.bridge.flooding">Flooding bridge (apps.bridge.flooding)</a><ul>
<li><a href="#configuration-25">Configuration</a></li>
</ul></li>
<li><a href="#learning-bridge-apps.bridge.learning">Learning bridge (apps.bridge.learning)</a><ul>
<li><a href="#configuration-26">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#ipfix-and-netflow-apps">IPFIX and NetFlow apps</a><ul>
<li><a href="#ipfix-apps.ipfix.ipfix">IPFIX (apps.ipfix.ipfix)</a><ul>
<li><a href="#configuration-27">Configuration</a></li>
<li><a href="#to-do-list">To-do list</a></li>
</ul></li>
</ul></li>
<li><a href="#ipsec-apps">IPsec Apps</a><ul>
<li><a href="#aes128gcm-apps.ipsec.esp">AES128gcm (apps.ipsec.esp)</a><ul>
<li><a href="#configuration-28">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#test-apps">Test Apps</a><ul>
<li><a href="#match-apps.test.match">Match (apps.test.match)</a><ul>
<li><a href="#configuration-29">Configuration</a></li>
</ul></li>
<li><a href="#synth-apps.test.synth">Synth (apps.test.synth)</a><ul>
<li><a href="#configuration-30">Configuration</a></li>
</ul></li>
</ul></li>
<li><a href="#snabbwall-apps">SnabbWall Apps</a><ul>
<li><a href="#l7spy-apps.wall.l7spy">L7Spy (apps.wall.l7spy)</a></li>
<li><a href="#filter-apps.wall.filter">Filter (apps.wall.filter)</a></li>
<li><a href="#scanner-apps.wall.scanner">Scanner (apps.wall.scanner)</a><ul>
<li><a href="#subclassing">Subclassing</a></li>
<li><a href="#ndpiscanner-apps.wall.scanner.ndpi">NdpiScanner (apps.wall.scanner.ndpi)</a></li>
</ul></li>
<li><a href="#utilities">Utilities</a><ul>
<li><a href="#southandnorth-apps.wall.util">SouthAndNorth (apps.wall.util)</a></li>
</ul></li>
</ul></li>
<li><a href="#rss-app-apps.rss.rss">RSS app (apps.rss.rss)</a><ul>
<li><a href="#flow-director">Flow-director</a></li>
<li><a href="#packet-replication">Packet replication</a></li>
<li><a href="#weighted-links">Weighted links</a></li>
<li><a href="#packet-meta-data">Packet meta-data</a></li>
<li><a href="#ipv6-extension-header-elimination">IPv6 extension header elimination</a></li>
<li><a href="#vlan-pseudo-tagging">VLAN pseudo-tagging</a></li>
<li><a href="#configuration-31">Configuration</a></li>
<li><a href="#meta-data-api">Meta-data API</a></li>
</ul></li>
<li><a href="#inter-process-links-apps.interlink.">Inter-process links (apps.interlink.*)</a><ul>
<li><a href="#configuration-32">Configuration</a></li>
</ul></li>
<li><a href="#libraries">Libraries</a><ul>
<li><a href="#ip-checksum-lib.checksum">IP checksum (lib.checksum)</a></li>
<li><a href="#ctable-lib.ctable">Ctable (lib.ctable)</a></li>
<li><a href="#pmu-lib.pmu">PMU (lib.pmu)</a></li>
<li><a href="#snabb-program-configuration-with-yang-lib.yang">Snabb program configuration with YANG (<code>lib.yang</code>)</a></li>
<li><a href="#hardware">Hardware</a><ul>
<li><a href="#pci-lib.hardware.pci">PCI (lib.hardware.pci)</a></li>
<li><a href="#register-lib.hardware.register">Register (lib.hardware.register)</a></li>
</ul></li>
<li><a href="#protocols">Protocols</a><ul>
<li><a href="#protocol-header-lib.protocol.header">Protocol Header (lib.protocol.header)</a></li>
<li><a href="#ethernet-lib.protocol.ethernet">Ethernet (lib.protocol.ethernet)</a></li>
<li><a href="#ipv4-lib.protocol.ipv4">IPv4 (lib.protocol.ipv4)</a></li>
<li><a href="#ipv6-lib.protocol.ipv6">IPv6 (lib.protocol.ipv6)</a></li>
<li><a href="#tcp-lib.protocol.tcp">TCP (lib.protocol.tcp)</a></li>
<li><a href="#udp-lib.protocol.udp">UDP (lib.protocol.udp)</a></li>
<li><a href="#gre-lib.protocol.gre">GRE (lib.protocol.gre)</a></li>
<li><a href="#icmp-lib.protocol.icmp.header">ICMP (lib.protocol.icmp.header)</a></li>
<li><a href="#datagram-lib.protocol.datagram">Datagram (lib.protocol.datagram)</a></li>
</ul></li>
<li><a href="#ipsec">IPsec</a><ul>
<li><a href="#encapsulating-security-payload-lib.ipsec.esp">Encapsulating Security Payload (lib.ipsec.esp)</a></li>
</ul></li>
<li><a href="#snabb-nfv">Snabb NFV</a><ul>
<li><a href="#nfv-config-program.snabbnfv.nfvconfig">NFV config (program.snabbnfv.nfvconfig)</a></li>
<li><a href="#snabbnfv-traffic">snabbnfv traffic</a></li>
<li><a href="#snabbnfv-neutron2snabb">snabbnfv neutron2snabb</a></li>
</ul></li>
<li><a href="#lisper">LISPER</a><ul>
<li><a href="#lisper-program.lisper">LISPER (program.lisper)</a></li>
</ul></li>
<li><a href="#ptree">Ptree</a><ul>
<li><a href="#ptree-program.ptree">Ptree (program.ptree)</a></li>
</ul></li>
<li><a href="#watchdog-lib.watchdog.watchdog">Watchdog (lib.watchdog.watchdog)</a></li>
</ul></li>
<li><a href="#snabblab">Snabblab</a><ul>
<li><a href="#guidelines">Guidelines</a></li>
<li><a href="#servers">Servers</a></li>
<li><a href="#get-started">Get started</a></li>
<li><a href="#using-the-lab">Using the lab</a></li>
<li><a href="#questions">Questions</a></li>
<li><a href="#thanks">Thanks</a></li>
</ul></li>
</ul>
</div>
<p><em><strong>Note:</strong> This reference manual is a draft. The API defined in this document is not guaranteed to be stable or complete and future versions of Snabb will introduce backwards incompatible changes. With that being said, discrepancies between this document and the actual Snabb Switch implementation are considered to be bugs. Please report them in order to help improve this document.</em></p>
<h1 id="introduction">Introduction</h1>
<p><em>Snabb</em> is an extensible, virtualized, Ethernet networking toolkit. With Snabb you can implement networking applications using the <em>Lua language</em>. Snabb includes all the tools you need to quickly realize your network designs and its really fast too! Furthermore, Snabb is extensible and encourages you to grow the ecosystem to match your requirements.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Architecture" />
<p class="caption">Architecture</p>
</div>
<p>The Snabb Core forms a runtime environment (<em>engine</em>) which executes your <em>design</em>. A design is simply a Lua script used to drive the Snabb stack, you can think of it as your top-level “main” routine.</p>
<p>In order to add functionality to the Snabb stack you can load modules into the Snabb engine. These can be Lua modules as well as native code objects. We differentiate between two classes of modules, namely libraries and <em>Apps</em>. Libraries are simple collections of program utilities to be used in your designs, apps or other libraries, just as you might expect. Apps, on the other hand, are code objects that implement a specific interface, which is used by the Snabb engine to organize an <em>App Network</em>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Network" />
<p class="caption">Network</p>
</div>
<p>Usually, a Snabb design will create a series of apps, interconnect these in a desired way using <em>links</em> and finally pass the resulting app network on to the Snabb engine. The engine’s job is to:</p>
<ul>
<li>Pump traffic through the app network</li>
<li>Keep the app network running (e.g. restart failed apps)</li>
<li>Report on the network status</li>
</ul>
<h1 id="snabb-api">Snabb API</h1>
<p>The core modules defined below can be loaded using Lua’s <code>require</code>. For example:</p>
<pre><code>local config = require(&quot;core.config&quot;)

local c = config.new()
...</code></pre>
<h2 id="app">App</h2>
<p>An <em>app</em> is an isolated implementation of a specific networking function. For example, a switch, a router, or a packet filter.</p>
<p>Apps receive packets on <em>input ports</em>, perform some processing, and transmit packets on <em>output ports</em>. Each app has zero or more input and output ports. For example, a packet filter may have one input and one output port, while a packet recorder may have only an input port. Every app must implement the interface below. Methods which may be left unimplemented are marked as “optional”.</p>
<p>— Method <strong>myapp:new</strong> <em>arg</em></p>
<p><em>Required</em>. Create an instance of the app with a given argument <em>arg</em>. <code>Myapp:new</code> must return an instance of the app. The handling of <em>arg</em> is up to the app but it is encouraged to use <code>core.config</code>’s <code>parse_app_arg</code> to parse <em>arg</em>.</p>
<p>— Field <strong>myapp.input</strong></p>
<p>— Field <strong>myapp.output</strong></p>
<p>Tables of named input and output links. These tables are initialized by the engine for use in processing and are <em>read-only</em>.</p>
<p>— Field <strong>myapp.appname</strong></p>
<p>Name of the app. <em>Read-only</em>.</p>
<p>— Field <strong>myapp.shm</strong></p>
<p>Can be set to a specification for <code>core.shm.create_frame</code>. When set, this field will be initialized to a frame of shared memory objects by the engine.</p>
<p>— Field <strong>myapp.config</strong></p>
<p>Can be set to a specification for <code>core.lib.parse</code>. When set, the specification will be used to validate the app’s arg when it is configured using <code>config.app</code>.</p>
<p>— Method <strong>myapp:link</strong></p>
<p><em>Optional</em>. Called any time the app’s links may have been changed (including on start-up). Guaranteed to be called before <code>pull</code> and <code>push</code> are called with new links.</p>
<p>— Method <strong>myapp:pull</strong></p>
<p><em>Optional</em>. Pull packets into the network.</p>
<p>For example: Pull packets from a network adapter into the app network by transmitting them to output ports.</p>
<p>— Method <strong>myapp:push</strong></p>
<p><em>Optional</em>. Push packets through the system.</p>
<p>For example: Move packets from input ports to output ports or to a network adapter.</p>
<p>— Method <strong>myapp:reconfig</strong> <em>arg</em></p>
<p><em>Optional</em>. Reconfigure the app with a new <em>arg</em>. If this method is not implemented the app instance is discarded and a new instance is created.</p>
<p>— Method <strong>myapp:report</strong></p>
<p><em>Optional</em>. Print a report of the current app status.</p>
<p>— Method <strong>myapp:stop</strong></p>
<p><em>Optional</em>. Stop the app and release associated external resources.</p>
<p>— Field <strong>myapp.zone</strong></p>
<p><em>Optional</em>. Name of the LuaJIT <em>profiling zone</em> used for this app (descriptive string). The default is the module name.</p>
<h2 id="config-core.config">Config (core.config)</h2>
<p>A <em>config</em> is a description of a packet-processing network. The network is a directed graph. Nodes in the graph are <em>apps</em> that each process packets in a specific way. Each app has a set of named input and output <em>ports</em>—often called <em>rx</em> and <em>tx</em>. Edges of the graph are unidirectional <em>links</em> that carry packets from an output port to an input port.</p>
<p>The config is a purely passive data structure. Creating and manipulating a config object does not immediately affect operation. The config has to be activated using <code>engine.configure</code>.</p>
<p>— Function <strong>config.new</strong></p>
<p>Creates and returns a new empty configuration.</p>
<p>— Function <strong>config.app</strong> <em>config</em>, <em>name</em>, <em>class</em>, <em>arg</em></p>
<p>Adds an app of <em>class</em> with <em>arg</em> to the <em>config</em> where it will be assigned to <em>name</em>.</p>
<p>Example:</p>
<pre><code>config.app(c, &quot;nic&quot;, Intel82599, {pciaddr = &quot;0000:00:00.0&quot;})</code></pre>
<p>— Function <strong>config.link</strong> <em>config</em>, <em>linkspec</em></p>
<p>Add a link defined by <em>linkspec</em> to the config <em>config</em>. <em>Linkspec</em> must be a string of the format</p>
<pre><code>app_name1.output_port-&gt;app_name2.input_port</code></pre>
<p>where <code>app_name1</code> and <code>app_name2</code> are names of apps in <em>config</em> and <code>output_port</code> and <code>input_port</code> are valid output and input ports of the referenced apps respectively.</p>
<p>Example:</p>
<pre><code>config.link(c, &quot;nic1.tx-&gt;nic2.rx&quot;)</code></pre>
<h2 id="engine-core.app">Engine (core.app)</h2>
<p>The <em>engine</em> executes a config by initializing apps, creating links, and driving the flow of execution. The engine also performs profiling and reporting functions. It can be reconfigured during runtime. Within Snabb Switch scripts the <code>core.app</code> module is bound to the global <code>engine</code> variable.</p>
<p>— Function <strong>engine.configure</strong> <em>config</em></p>
<p>Configure the engine to use a new config <em>config</em>. You can safely call this method many times to incrementally update the running app network. The engine updates the app network as follows:</p>
<ul>
<li>Apps that did not exist in the old configuration are started.</li>
<li>Apps that do not exist in the new configuration are stopped. (The app <code>stop()</code> method is called if defined.)</li>
<li>Apps with unchanged configurations are preserved.</li>
<li>Apps with changed configurations are updated by calling their <code>reconfig()</code> method. If the <code>reconfig()</code> method is not implemented then the old instance is stopped a new one started.</li>
<li>Links with unchanged endpoints are preserved.</li>
</ul>
<p>— Function <strong>engine.main</strong> <em>options</em></p>
<p>Run the Snabb engine. <em>Options</em> is a table of key/value pairs. The following keys are recognized:</p>
<ul>
<li><code>duration</code> - Duration in seconds to run the engine for (as a floating point number). If this is set you cannot supply <code>done</code>.</li>
<li><code>done</code> - A function to be called repeatedly by <code>engine.main</code> until it returns <code>true</code>. Once it returns <code>true</code> the engine will be stopped and <code>engine.main</code> will return. If this is set you cannot supply <code>duration</code>.</li>
<li><code>report</code> - A table which configures the report printed before <code>engine.main()</code> returns. The keys <code>showlinks</code> and <code>showapps</code> can be set to boolean values to force or suppress link and app reporting individually. By default `engine.main()’ will report on links but not on apps.</li>
<li><code>measure_latency</code> - By default, the <code>breathe()</code> loop is instrumented to record the latency distribution of running the app graph. This information can be processed by the <code>snabb top</code> program. Passing <code>measure_latency=false</code> in the <em>options</em> will disable this instrumentation.</li>
<li><code>no_report</code> - A boolean value. If <code>true</code> no final report will be printed.</li>
</ul>
<p>— Function <strong>engine.now</strong></p>
<p>Returns monotonic time in seconds as a floating point number. Suitable for timers.</p>
<p>— Variable <strong>engine.busywait</strong></p>
<p>If set to true then the engine polls continuously for new packets to process. This consumes 100% CPU and makes processing latency less vulnerable to kernel scheduling behavior which can cause pauses of more than one millisecond.</p>
<p>Default: false</p>
<p>— Variable <strong>engine.Hz</strong></p>
<p>Frequency at which to poll for new input packets. The default value is ‘false’ which means to adjust dynamically up to 100us during low traffic. The value can be overridden with a constant integer saying how many times per second to poll.</p>
<p>This setting is not used when engine.busywait is true.</p>
<h2 id="link-core.link">Link (core.link)</h2>
<p>A <em>link</em> is a <a href="http://en.wikipedia.org/wiki/Circular_buffer">ring buffer</a> used to store packets between apps. Links can be treated either like arrays—accessing their internal structure directly—or as streams of packets by using their API functions.</p>
<p>— Function <strong>link.empty</strong> <em>link</em></p>
<p>Predicate used to test if a link is empty. Returns true if <em>link</em> is empty and false otherwise.</p>
<p>— Function <strong>link.full</strong> <em>link</em></p>
<p>Predicate used to test if a link is full. Returns true if <em>link</em> is full and false otherwise.</p>
<p>— Function <strong>link.nreadable</strong> <em>link</em></p>
<p>Returns the number of packets on <em>link</em>.</p>
<p>— Function <strong>link.nwriteable</strong> <em>link</em></p>
<p>Returns the remaining number of packets that fit onto <em>link</em>.</p>
<p>— Function <strong>link.receive</strong> <em>link</em></p>
<p>Returns the next available packet (and advances the read cursor) on <em>link</em>. If the link is empty an error is signaled.</p>
<p>— Function <strong>link.front</strong> <em>link</em></p>
<p>Return the next available packet without advancing the read cursor on <em>link</em>. If the link is empty, <code>nil</code> is returned.</p>
<p>— Function <strong>link.transmit</strong> <em>link</em>, <em>packet</em></p>
<p>Transmits <em>packet</em> onto <em>link</em>. If the link is full <em>packet</em> is dropped (and the drop counter increased).</p>
<p>— Function <strong>link.stats</strong> <em>link</em></p>
<p>Returns a structure holding ring statistics for the <em>link</em>:</p>
<ul>
<li><code>txbytes</code>, <code>rxbytes</code>: Counts of transferred bytes.</li>
<li><code>txpackets</code>, <code>rxpackets</code>: Counts of transferred packets.</li>
<li><code>txdrop</code>: Count of packets dropped due to ring overflow.</li>
</ul>
<h2 id="packet-core.packet">Packet (core.packet)</h2>
<p>A <em>packet</em> is an FFI object of type <code>struct packet</code> representing a network packet that is currently being processed. The packet is used to explicitly manage the life cycle of the packet. Packets are explicitly allocated and freed by using <code>packet.allocate</code> and <code>packet.free</code>. When a packet is received using <code>link.receive</code> its ownership is acquired by the calling app. The app must then ensure to either transfer the packet ownership to another app by calling <code>link.transmit</code> on the packet or free the packet using <code>packet.free</code>. Apps may only use packets they own, e.g. packets that have not been transmitted or freed. The number of allocatable packets is limited by the size of the underlying “freelist”, e.g. a pool of unused packet objects from and to which packets are allocated and freed.</p>
<p>— Type <strong>struct packet</strong></p>
<pre><code>struct packet {
    uint16_t length;
    uint8_t  data[packet.max_payload];
};</code></pre>
<p>— Constant <strong>packet.max_payload</strong></p>
<p>The maximum payload length of a packet.</p>
<p>— Function <strong>packet.allocate</strong></p>
<p>Returns a new empty packet. An an error is raised if there are no packets left on the freelist. Initially the <code>length</code> of the allocated is 0, and its <code>data</code> is uninitialized garbage.</p>
<p>— Function <strong>packet.free</strong> <em>packet</em></p>
<p>Frees <em>packet</em> and puts in back onto the freelist.</p>
<p>— Function <strong>packet.clone</strong> <em>packet</em></p>
<p>Returns an exact copy of <em>packet</em>.</p>
<p>— Function <strong>packet.resize</strong> <em>packet</em>, <em>length</em></p>
<p>Sets the payload length of <em>packet</em>, truncating or extending its payload. In the latter case the contents of the extended area at the end of the payload are filled with zeros.</p>
<p>— Function <strong>packet.append</strong> <em>packet</em>, <em>pointer</em>, <em>length</em></p>
<p>Appends <em>length</em> bytes starting at <em>pointer</em> to the end of <em>packet</em>. An error is raised if there is not enough space in <em>packet</em> to accomodate <em>length</em> additional bytes.</p>
<p>— Function <strong>packet.prepend</strong> <em>packet</em>, <em>pointer</em>, <em>length</em></p>
<p>Prepends <em>length</em> bytes starting at <em>pointer</em> to the front of <em>packet</em>, taking ownership of the packet and returning a new packet. An error is raised if there is not enough space in <em>packet</em> to accomodate <em>length</em> additional bytes.</p>
<p>— Function <strong>packet.shiftleft</strong> <em>packet</em>, <em>length</em></p>
<p>Take ownership of <em>packet</em>, truncate it by <em>length</em> bytes from the front, and return a new packet. <em>Length</em> must be less than or equal to <code>length</code> of <em>packet</em>.</p>
<p>— Function <strong>packet.shiftright</strong> <em>packet</em>, <em>length</em></p>
<p>Take ownership of <em>packet</em>, moves <em>packet</em> payload to the right by <em>length</em> bytes, growing <em>packet</em> by <em>length</em>. Returns a new packet. The sum of <em>length</em> and <code>length</code> of <em>packet</em> must be less than or equal to <code>packet.max_payload</code>.</p>
<p>— Function <strong>packet.from_pointer</strong> <em>pointer</em>, <em>length</em></p>
<p>Allocate packet and fill it with <em>length</em> bytes from <em>pointer</em>.</p>
<p>— Function <strong>packet.from_string</strong> <em>string</em></p>
<p>Allocate packet and fill it with the contents of <em>string</em>.</p>
<p>— Function **packet.clone_to_memory* <em>pointer</em> <em>packet</em></p>
<p>Creates an exact copy of at memory pointed to by <em>pointer</em>. <em>Pointer</em> must point to a <code>packet.packet_t</code>.</p>
<h2 id="memory-core.memory">Memory (core.memory)</h2>
<p>Snabb allocates special <a href="https://en.wikipedia.org/wiki/Direct_memory_access">DMA</a> memory that can be accessed directly by network cards. The important characteristic of DMA memory is being located in contiguous physical memory at a stable address.</p>
<p>— Function <strong>memory.dma_alloc</strong> <em>bytes</em>, [<em>alignment</em>]</p>
<p>Returns a pointer to <em>bytes</em> of new DMA memory.</p>
<p>Optionally a specific <em>alignment</em> requirement can be provided (in bytes). The default alignment is 128.</p>
<p>— Function <strong>memory.virtual_to_physical</strong> <em>pointer</em></p>
<p>Returns the physical address (<code>uint64_t</code>) the DMA memory at <em>pointer</em>.</p>
<p>— Variable <strong>memory.huge_page_size</strong></p>
<p>Size of a single huge page in bytes. Read-only.</p>
<h2 id="shared-memory-core.shm">Shared Memory (core.shm)</h2>
<p>This module facilitates creation and management of named shared memory objects. Objects can be created using <code>shm.create</code> similar to <code>ffi.new</code>, except that separate calls to <code>shm.open</code> for the same name will each return a new mapping of the same shared memory. Different processes can share memory by mapping an object with the same name (and type). Each process can map any object any number of times.</p>
<p>Mappings are deleted on process termination or with an explicit <code>shm.unmap</code>. Names are unlinked from objects that are no longer needed using <code>shm.unlink</code>. Object memory is freed when the name is unlinked and all mappings have been deleted.</p>
<p>Names can be fully qualified or abbreviated to be within the current process. Here are examples of names and how they are resolved where <code>&lt;pid&gt;</code> is the PID of this process:</p>
<ul>
<li>Local: <code>foo/bar</code> ⇒ <code>/var/run/snabb/&lt;pid&gt;/foo/bar</code></li>
<li>Fully qualified: <code>/1234/foo/bar</code> ⇒ <code>/var/run/snabb/1234/foo/bar</code></li>
</ul>
<p>Behind the scenes the objects are backed by files on ram disk (<code>/var/run/snabb/&lt;pid&gt;</code>) and accessed with the equivalent of POSIX shared memory (<code>shm_overview(7)</code>). The files are automatically removed on shutdown unless the environment <code>SNABB_SHM_KEEP</code> is set. The location <code>/var/run/snabb</code> can be overridden by the environment variable <code>SNABB_SHM_ROOT</code>.</p>
<p>Shared memory objects are created world-readable for convenient access by diagnostic tools. You can lock this down by setting <code>SNABB_SHM_ROOT</code> to a path under a directory with appropriate permissions.</p>
<p>The practical limit on the number of objects that can be mapped will depend on the operating system limit for memory mappings. On Linux the default limit is 65,530 mappings:</p>
<pre><code>$ sysctl vm.max_map_count vm.max_map_count = 65530</code></pre>
<p>— Function <strong>shm.create</strong> <em>name</em>, <em>type</em></p>
<p>Creates and maps a shared object of <em>type</em> into memory via a hierarchical <em>name</em>. Returns a pointer to the mapped object.</p>
<p>— Function <strong>shm.open</strong> <em>name</em>, <em>type</em>, [<em>readonly</em>]</p>
<p>Maps an existing shared object of <em>type</em> into memory via a hierarchical <em>name</em>. If <em>readonly</em> is non-nil the shared object is mapped in read-only mode. <em>Readonly</em> defaults to nil. Fails if the shared object does not already exist. Returns a pointer to the mapped object.</p>
<p>— Function <strong>shm.alias</strong> <em>new-path</em> <em>existing-path</em></p>
<p>Create an alias (symbolic link) for an object.</p>
<p>— Function <strong>shm.exists</strong> <em>name</em></p>
<p>Returns a true value if shared object by <em>name</em> exists.</p>
<p>— Function <strong>shm.unmap</strong> <em>pointer</em></p>
<p>Deletes the memory mapping for <em>pointer</em>.</p>
<p>— Function <strong>shm.unlink</strong> <em>path</em></p>
<p>Unlinks the subtree of objects designated by <em>path</em> from the filesystem.</p>
<p>— Function <strong>shm.children</strong> <em>path</em></p>
<p>Returns an array of objects in the directory designated by <em>path</em>.</p>
<p>— Function <strong>shm.register</strong> <em>type</em>, <em>module</em></p>
<p>Registers an abstract shared memory object <em>type</em> implemented by <em>module</em> in <code>shm.types</code>. <em>Module</em> must provide the following functions:</p>
<ul>
<li><strong>create</strong> <em>name</em>, …</li>
<li><strong>open</strong>, <em>name</em></li>
</ul>
<p>and can optionally provide the function:</p>
<ul>
<li><strong>delete</strong>, <em>name</em></li>
</ul>
<p>The <em>module</em>’s <code>type</code> variable must be bound to <em>type</em>. To register a new type a module might invoke <code>shm.register</code> like so:</p>
<pre><code>type = shm.register('mytype', getfenv())
-- Now the following holds true:
--   shm.types[type] == getfenv()</code></pre>
<p>— Variable <strong>shm.types</strong></p>
<p>A table that maps types to modules. See <code>shm.register</code>.</p>
<p>— Function <strong>shm.create_frame</strong> <em>path</em>, <em>specification</em></p>
<p>Creates and returns a shared memory frame by <em>specification</em> under <em>path</em>. A frame is a table of mapped—possibly abstract‑shared memory objects. <em>Specification</em> must be of the form:</p>
<pre><code>{ &lt;name&gt; = {&lt;module&gt;, ...},
  ... }</code></pre>
<p><em>Module</em> must implement an abstract type registered with <code>shm.register</code>, and is followed by additional initialization arguments to its <code>create</code> function. Example usage:</p>
<pre><code>local counter = require(&quot;core.counter&quot;)
-- Create counters foo/bar/{dtime,rxpackets,txpackets}.counter
local f = shm.create_frame(
   &quot;foo/bar&quot;,
   {dtime     = {counter, C.get_unix_time()},
    rxpackets = {counter},
    txpackets = {counter}})
counter.add(f.rxpackets)
counter.read(f.dtime)</code></pre>
<p>— Function <strong>shm.open_frame</strong> <em>path</em></p>
<p>Opens and returns the shared memory frame under <em>path</em> for reading.</p>
<p>— Function <strong>shm.delete_frame</strong> <em>frame</em></p>
<p>Deletes/unmaps a shared memory <em>frame</em>. The <em>frame</em> directory is unlinked if <em>frame</em> was created by <code>shm.create_frame</code>.</p>
<h3 id="counter-core.counter">Counter (core.counter)</h3>
<p>Double-buffered shared memory counters. Counters are 64-bit unsigned values. Registered with <code>core.shm</code> as type <code>counter</code>.</p>
<p>— Function <strong>counter.create</strong> <em>name</em>, [<em>initval</em>]</p>
<p>Creates and returns a <code>counter</code> by <em>name</em>, initialized to <em>initval</em>. <em>Initval</em> defaults to 0.</p>
<p>— Function <strong>counter.open</strong> <em>name</em></p>
<p>Opens and returns the counter by <em>name</em> for reading.</p>
<p>— Function <strong>counter.delete</strong> <em>name</em></p>
<p>Deletes and unmaps the counter by <em>name</em>.</p>
<p>— Function <strong>counter.commit</strong></p>
<p>Commits buffered counter values to public shared memory.</p>
<p>— Function <strong>counter.set</strong> <em>counter</em>, <em>value</em></p>
<p>Sets <em>counter</em> to <em>value</em>.</p>
<p>— Function <strong>counter.add</strong> <em>counter</em>, [<em>value</em>]</p>
<p>Increments <em>counter</em> by <em>value</em>. <em>Value</em> defaults to 1.</p>
<p>— Function <strong>counter.read</strong> <em>counter</em></p>
<p>Returns the value of <em>counter</em>.</p>
<h3 id="histogram-core.histogram">Histogram (core.histogram)</h3>
<p>Shared memory histogram with logarithmic buckets. Registered with <code>core.shm</code> as type <code>histogram</code>.</p>
<p>— Function <strong>histogram.new</strong> <em>min</em>, <em>max</em></p>
<p>Returns a new <code>histogram</code>, with buckets covering the range from <em>min</em> to <em>max</em>. The range between <em>min</em> and <em>max</em> will be divided logarithmically.</p>
<p>— Function <strong>histogram.create</strong> <em>name</em>, <em>min</em>, <em>max</em></p>
<p>Creates and returns a <code>histogram</code> as in <code>histogram.new</code> by <em>name</em>. If the file exists already, it will be cleared.</p>
<p>— Function <strong>histogram.open</strong> <em>name</em></p>
<p>Opens and returns <code>histogram</code> by <em>name</em> for reading.</p>
<p>— Method <strong>histogram:add</strong> <em>measurement</em></p>
<p>Adds <em>measurement</em> to <em>histogram</em>.</p>
<p>— Method <strong>histogram:iterate</strong> <em>prev</em></p>
<p>When used as <code>for count, lo, hi in histogram:iterate()</code>, visits all buckets in <em>histogram</em> in order from lowest to highest. <em>Count</em> is the number of samples recorded in that bucket, and <em>lo</em> and <em>hi</em> are the lower and upper bounds of the bucket. Note that <em>count</em> is an unsigned 64-bit integer; to get it as a Lua number, use <code>tonumber</code>.</p>
<p>If <em>prev</em> is given, it should be a snapshot of the previous version of the histogram. In that case, the <em>count</em> values will be returned as a difference between their values in <em>histogram</em> and their values in <em>prev</em>.</p>
<p>— Method <strong>histogram:snapshot</strong> [<em>dest</em>]</p>
<p>Copies out the contents of <em>histogram</em> into the <code>histogram</code> <em>dest</em> and returns <em>dest</em>. If <em>dest</em> is not given, the result will be a fresh <code>histogram</code>.</p>
<p>— Method <strong>histogram:clear</strong></p>
<p>Clears the buckets of <em>histogram</em>.</p>
<p>— Method **histogram:wrap_thunk* <em>thunk</em>, <em>now</em></p>
<p>Returns a closure that wraps <em>thunk</em>, measuring and recording the difference between calls to <em>now</em> before and after <em>thunk</em> into <em>histogram</em>.</p>
<h2 id="lib-core.lib">Lib (core.lib)</h2>
<p>The <code>core.lib</code> module contains miscellaneous utilities.</p>
<p>— Function <strong>lib.equal</strong> <em>x</em>, <em>y</em></p>
<p>Predicate to test if <em>x</em> and <em>y</em> are structurally similar (isomorphic).</p>
<p>— Function <strong>lib.can_open</strong> <em>filename</em>, <em>mode</em></p>
<p>Predicate to test if file at <em>filename</em> can be successfully opened with <em>mode</em>.</p>
<p>— Function <strong>lib.can_read</strong> <em>filename</em></p>
<p>Predicate to test if file at <em>filename</em> can be successfully opened for reading.</p>
<p>— Function <strong>lib.can_write</strong> <em>filename</em></p>
<p>Predicate to test if file at <em>filename</em> can be successfully opened for writing.</p>
<p>— Function <strong>lib.readcmd</strong> <em>command</em>, <em>what</em></p>
<p>Runs Unix shell <em>command</em> and returns <em>what</em> of its output. <em>What</em> must be a valid argument to <code>file:read</code>.</p>
<p>— Function <strong>lib.readfile</strong> <em>filename</em>, <em>what</em></p>
<p>Reads and returns <em>what</em> from file at <em>filename</em>. <em>What</em> must be a valid argument to <code>file:read</code>.</p>
<p>— Function <strong>lib.writefile</strong> <em>filename</em>, <em>value</em></p>
<p>Writes <em>value</em> to file at <em>filename</em> using <code>file:write</code>. Returns the value returned by <code>file:write</code>.</p>
<p>— Function <strong>lib.readlink</strong> <em>filename</em></p>
<p>Returns the true name of symbolic link at <em>filename</em>.</p>
<p>— Function <strong>lib.dirname</strong> <em>filename</em></p>
<p>Returns the <code>dirname(3)</code> of <em>filename</em>.</p>
<p>— Function <strong>lib.basename</strong> <em>filename</em></p>
<p>Returns the <code>basename(3)</code> of <em>filename</em>.</p>
<p>— Function <strong>lib.firstfile</strong> <em>directory</em></p>
<p>Returns the filename of the first file in <em>directory</em>.</p>
<p>— Function <strong>lib.firstline</strong> <em>filename</em></p>
<p>Returns the first line of file at <em>filename</em> as a string.</p>
<p>— Function <strong>lib.load_string</strong> <em>string</em></p>
<p>Evaluates and returns the value of the Lua expression in <em>string</em>.</p>
<p>— Function <strong>lib.load_conf</strong> <em>filename</em></p>
<p>Evaluates and returns the value of the Lua expression in file at <em>filename</em>.</p>
<p>— Function <strong>lib.store_conf</strong> <em>filename</em>, <em>value</em></p>
<p>Writes <em>value</em> to file at <em>filename</em> as a Lua expression. Supports tables, strings and everything that can be readably printed using <code>print</code>.</p>
<p>— Function <strong>lib.bits</strong> <em>bitset</em>, <em>basevalue</em></p>
<p>Returns a bitmask using the values of <em>bitset</em> as indexes. The keys of <em>bitset</em> are ignored (and can be used as comments).</p>
<p>Example:</p>
<pre><code>bits({RESET=0,ENABLE=4}, 123) =&gt; 1&lt;&lt;0 | 1&lt;&lt;4 | 123</code></pre>
<p>— Function <strong>lib.bitset</strong> <em>value</em>, <em>n</em></p>
<p>Predicate to test if bit number <em>n</em> of <em>value</em> is set.</p>
<p>— Function <strong>lib.bitfield</strong> <em>size</em>, <em>struct</em>, <em>member</em>, <em>offset</em>, <em>nbits</em>, <em>value</em></p>
<p>Combined accesor and setter function for bit ranges of integers in cdata structs. Sets <em>nbits</em> (number of bits) starting from <em>offset</em> to <em>value</em>. If <em>value</em> is not given the current value is returned.</p>
<p><em>Size</em> may be one of 8, 16 or 32 depending on the bit size of the integer being set or read.</p>
<p><em>Struct</em> must be a pointer to a cdata object and <em>member</em> must be the literal name of a member of <em>struct</em>.</p>
<p>Example:</p>
<pre><code>local struct_t = ffi.typeof[[struct { uint16_t flags; }]]
-- Assuming `s' is an instance of `struct_t', set bits 4-7 to 0xF:
lib.bitfield(16, s, 'flags', 4, 4, 0xf)
-- Get the value:
lib.bitfield(16, s, 'flags', 4, 4) -- =&gt; 0xF</code></pre>
<p>— Function <strong>string:split</strong> <em>pattern</em></p>
<p>Returns an iterator over the string split by <em>pattern</em>. <em>Pattern</em> must be a valid argument to <code>string:gmatch</code>.</p>
<p>Example:</p>
<pre><code>for word, sep in (&quot;foo!bar!baz&quot;):split(&quot;(!)&quot;) do
    print(word, sep)
end

&gt; foo   !
&gt; bar   !
&gt; baz   nil</code></pre>
<p>— Function <strong>lib.hexdump</strong> <em>string</em></p>
<p>Returns hexadecimal string for bytes in <em>string</em>.</p>
<p>— Function <strong>lib.hexundump</strong> <em>hexstring</em></p>
<p>Returns byte string for <em>hexstring</em>.</p>
<p>— Function <strong>lib.comma_value</strong> <em>n</em></p>
<p>Returns a string for decimal number <em>n</em> with magnitudes separated by commas. Example:</p>
<pre><code>comma_value(1000000) =&gt; &quot;1,000,000&quot;</code></pre>
<p>— Function <strong>lib.random_bytes_from_dev_urandom</strong> <em>length</em></p>
<p>Return <em>length</em> bytes of random data, as a byte array, taken from <code>/dev/urandom</code>. Suitable for cryptographic usage.</p>
<p>— Function <strong>lib.random_bytes_from_math_random</strong> <em>length</em></p>
<p>Return <em>length</em> bytes of random data, as a byte array, where each byte was taken from <code>math.random(0, 255)</code>. <em>Not</em> suitable for cryptographic usage.</p>
<p>— Function <strong>lib.random_bytes</strong> <em>length</em> — Function <strong>lib.randomseed</strong> <em>seed</em></p>
<p>Initialize Snabb’s random number generation facility. If <em>seed</em> is nil, then the Lua <code>math.random()</code> function will be seeded from <code>/dev/urandom</code>, and <code>lib.random_bytes</code> will be initialized to <code>lib.random_bytes_from_dev_urandom</code>. This is Snabb’s default mode of operation.</p>
<p>Sometimes it’s useful to make Snabb use deterministic random numbers. In that case, pass a seed to <strong>lib.randomseed</strong>; Snabb will set <code>lib.random_bytes</code> to <code>lib.random_bytes_from_math_random</code>, and also print out a message to stderr indicating that we are using lower-quality deterministic random numbers.</p>
<p>As part of its initialization process, Snabb will call <code>lib.randomseed</code> with the value of the <code>SNABB_RANDOM_SEED</code> environment variable (if any). Set this environment variable to enable deterministic random numbers.</p>
<p>— Function <strong>lib.bounds_checked</strong> <em>type</em>, <em>base</em>, <em>offset</em>, <em>size</em></p>
<p>Returns a table that acts as a bounds checked wrapper around a C array of <em>type</em> and <em>size</em> starting at <em>base</em> plus <em>offset</em>. <em>Type</em> must be a ctype and the caller must ensure that the allocated memory region at <em>base</em>/<em>offset</em> is at least <code>sizeof(type)*size</code> bytes long.</p>
<p>— Function <strong>lib.throttle</strong> <em>seconds</em></p>
<p>Return a closure that returns <code>true</code> at most once during any <em>seconds</em> (a floating point value) time interval, otherwise false.</p>
<p>— Function <strong>lib.timeout</strong> <em>seconds</em></p>
<p>Returns a closure that returns <code>true</code> if <em>seconds</em> (a floating point value) have elapsed since it was created, otherwise false.</p>
<p>— Function <strong>lib.waitfor</strong> <em>condition</em></p>
<p>Blocks until the function <em>condition</em> returns a true value.</p>
<p>— Function <strong>lib.waitfor2</strong> <em>name</em>, <em>condition</em>, <em>attempts</em>, <em>interval</em></p>
<p>Repeatedly calls the function <em>condition</em> in <em>interval</em> (milliseconds). If <em>condition</em> returns a true value <code>waitfor2</code> returns. If <em>condition</em> does not return a true value after <em>attempts</em> <code>waitfor2</code> raises an error identified by <em>name</em>.</p>
<p>— Function <strong>lib.yesno</strong> <em>flag</em></p>
<p>Returns the string <code>&quot;yes&quot;</code> if <em>flag</em> is a true value and <code>&quot;no&quot;</code> otherwise.</p>
<p>— Function <strong>lib.align</strong> <em>value</em>, <em>size</em></p>
<p>Return the next integer that is a multiple of <em>size</em> starting from <em>value</em>.</p>
<p>— Function <strong>lib.csum</strong> <em>pointer</em>, <em>length</em></p>
<p>Computes and returns the “IP checksum” <em>length</em> bytes starting at <em>pointer</em>.</p>
<p>— Function <strong>lib.update_csum</strong> <em>pointer</em>, <em>length</em>, <em>checksum</em></p>
<p>Returns <em>checksum</em> updated by <em>length</em> bytes starting at <em>pointer</em>. The default of <em>checksum</em> is <code>0LL</code>.</p>
<p>— Function <strong>lib.finish_csum</strong> <em>checksum</em></p>
<p>Returns the finalized <em>checksum</em>.</p>
<p>— Function <strong>lib.malloc</strong> <em>etype</em></p>
<p>Returns a pointer to newly allocated DMA memory for <em>etype</em>.</p>
<p>— Function <strong>lib.deepcopy</strong> <em>object</em></p>
<p>Returns a copy of <em>object</em>. Supports tables as well as ctypes.</p>
<p>— Function <strong>lib.array_copy</strong> <em>array</em></p>
<p>Returns a copy of <em>array</em>. <em>Array</em> must not be a “sparse array”.</p>
<p>— Function <strong>lib.htonl</strong> <em>n</em></p>
<p>— Function <strong>lib.htons</strong> <em>n</em></p>
<p>Host to network byte order conversion functions for 32 and 16 bit integers <em>n</em> respectively. Unsigned.</p>
<p>— Function <strong>lib.ntohl</strong> <em>n</em></p>
<p>— Function <strong>lib.ntohs</strong> <em>n</em></p>
<p>Network to host byte order conversion functions for 32 and 16 bit integers <em>n</em> respectively. Unsigned.</p>
<p>— Function <strong>lib.random_bytes</strong> <em>count</em></p>
<p>Return a fresh array of <em>count</em> random bytes. Suitable for cryptographic usage.</p>
<p>— Function <strong>lib.parse</strong> <em>arg</em>, <em>config</em></p>
<p>Validates <em>arg</em> against the specification in <em>config</em>, and returns a fresh table containing the parameters in <em>arg</em> and any omitted optional parameters with their default values. Given <em>arg</em>, a table of parameters or <code>nil</code>, assert that from <em>config</em> all of the required keys are present, fill in any missing values for optional keys, and error if any unknown keys are found. <em>Config</em> has the following format:</p>
<pre><code>config := { key = {[required=boolean], [default=value]}, ... }</code></pre>
<p>Each key is optional unless <code>required</code> is set to a true value, and its default value defaults to <code>nil</code>.</p>
<p>Example:</p>
<pre><code>lib.parse({foo=42, bar=43}, {foo={required=true}, bar={}, baz={default=44}})
  =&gt; {foo=42, bar=43, baz=44}</code></pre>
<ul>
<li>Function <strong>lib.set</strong> <em>vargs</em></li>
</ul>
<p>Reads a variable number of arguments and returns a table representing a set. The returned value can be used to query whether an element belongs or not to the set.</p>
<p>Example:</p>
<pre><code>local t = set('foo', 'bar')
t['foo']  -- yields true.
t['quax'] -- yields false.</code></pre>
<h2 id="multiprocess-operation-core.worker">Multiprocess operation (core.worker)</h2>
<p>Snabb can operate as a <em>group</em> of cooperating processes. The <em>main</em> process is the initial one that you start directly. The optional <em>worker</em> processes are children spawned when the main process calls the <code>core.worker</code> module.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Multiprocessing" />
<p class="caption">Multiprocessing</p>
</div>
<p>Each worker is a complete Snabb process. They can define app networks, run the engine, and do everything else that ordinary Snabb processes do. The exact behavior of each worker is determined by a Lua expression provided upon creation.</p>
<p>Groups of Snabb processes each have the following special properties:</p>
<ul>
<li><strong>Group termination</strong>: Terminating the main process automatically terminates all of the workers. This works for all process termination scenarios including <code>kill -9</code>.</li>
<li><strong>Shared DMA memory</strong>: DMA memory pointers obtained with <code>memory.dma_alloc()</code> are usable by all processes in the group. This means that you can share DMA memory pointers between processes, for example via <code>shm</code> shared memory objects, and reference them from any process. (The memory is automatically mapped at the expected address via a <code>SEGV</code> signal handler.)</li>
<li><strong>PCI device shutdown</strong>: For each PCI device opened by a process within the group, bus mastering (DMA) is disabled upon termination before any DMA memory is returned to the kernel. This prevents “dangling” DMA requests from corrupting memory that has been freed and reused.</li>
</ul>
<p>The <code>core.worker</code> API functions are available in the main process only:</p>
<p>— Function <strong>worker.start</strong> <em>name</em> <em>luacode</em></p>
<p>Start a named worker process. The worker starts with a completely fresh Snabb process image (<code>fork()+execve()</code>) and then executes the string <em>luacode</em> as a Lua source code expression.</p>
<p>Example:</p>
<pre><code>worker.start(&quot;myworker&quot;, [[
   print(&quot;hello world, from a Snabb worker process!&quot;)
   print(&quot;could configure and run the engine now...&quot;)
]])</code></pre>
<p>— Function <strong>worker.stop</strong> <em>name</em></p>
<p>Stop a named worker process. The worker is abruptly killed.</p>
<p>Example:</p>
<pre><code>worker.stop(&quot;myworker&quot;)</code></pre>
<p>— Function <strong>worker.status</strong></p>
<p>Return a table summarizing the status of all workers. The table key is the worker name and the value is a table with <code>pid</code> and <code>alive</code> attributes.</p>
<p>Example:</p>
<pre><code>for w, s in pairs(worker.status()) do
   print((&quot;  worker %s: pid=%s alive=%s&quot;):format(
         w, s.pid, s.alive))
end</code></pre>
<p>Output:</p>
<pre><code>worker w3: pid=21949 alive=true
worker w1: pid=21947 alive=true
worker w2: pid=21948 alive=true</code></pre>
<h2 id="main">Main</h2>
<p>Snabb designs can be run either with:</p>
<pre><code>snabb &lt;snabb-arg&gt;* &lt;design&gt; &lt;design-arg&gt;*</code></pre>
<p>or</p>
<pre><code>#!/usr/bin/env snabb &lt;snabb-arg&gt;*
...</code></pre>
<p>The <em>main</em> module provides an interface for running Snabb scripts. It exposes various operating system functions to scripts.</p>
<p>— Field <strong>main.parameters</strong></p>
<p>A list of command-line arguments to the running script. Read-only.</p>
<p>— Function <strong>main.exit</strong> <em>status</em></p>
<p>Cleanly exits the process with <em>status</em>.</p>
<h1 id="basic-apps-apps.basic.basic_apps">Basic Apps (apps.basic.basic_apps)</h1>
<p>The module <em>apps.basic.basic_apps</em> provides apps with general functionality for use in you app networks.</p>
<h2 id="source">Source</h2>
<p>The <code>Source</code> app is a synthetic packet generator. On each breath it fills each attached output link with new packets. It accepts a number as its configuration argument which is the byte size of the generated packets. By default, each packet is 60 bytes long. The packet data is initialized with zero bytes.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Source" />
<p class="caption">Source</p>
</div>
<h2 id="join">Join</h2>
<p>The <code>Join</code> app joins together packets from N input links onto one output link. On each breath it outputs as many packets as possible from the inputs onto the output.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Join" />
<p class="caption">Join</p>
</div>
<h2 id="split">Split</h2>
<p>The <code>Split</code> app splits packets from multiple inputs across multiple outputs. On each breath it transfers as many packets as possible from the input links to the output links.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Split" />
<p class="caption">Split</p>
</div>
<h2 id="sink">Sink</h2>
<p>The <code>Sink</code> app receives all packets from any number of input links and discards them. This can be handy in combination with a <code>Source</code>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Sink" />
<p class="caption">Sink</p>
</div>
<h2 id="tee">Tee</h2>
<p>The <code>Tee</code> app receives all packets from any number of input links and transfers each received packet to all output links. It can be used to merge and/or duplicate packet streams</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Tee" />
<p class="caption">Tee</p>
</div>
<h2 id="repeater">Repeater</h2>
<p>The <code>Repeater</code> app collects all packets received from the <code>input</code> link and repeatedly transfers the accumulated packets to the <code>output</code> link. The packets are transmitted in the order they were received.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Repeater" />
<p class="caption">Repeater</p>
</div>
<h2 id="truncate">Truncate</h2>
<p>The <code>Truncate</code> app sends all packets received from the <code>input</code> to the <code>output</code> link and truncates or zero pads each packet to a given length. It accepts a number as its configuration argument which is the length of the truncated or padded packets.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Truncate" />
<p class="caption">Truncate</p>
</div>
<h2 id="sample">Sample</h2>
<p>The <code>Sample</code> app forwards packets every <em>n</em>th packet from the <code>input</code> link to the <code>output</code> link, and drops all others packets. It accepts a number as its configuration argument which is <em>n</em>.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAa4AAAB+CAIAAADz3mJWAAAKR0lEQVR42u2deWxN3RqHUWouNZYI0Ui1qFCEiAQhQQw1FJUIoqRRIhXhJqK55kiImEP4x1hFjDWLP1S4VNDSQbWoUmqoDnTQ9rq/fCt2To6Tq9qPr8d+nj+arr1X9zn7Xe/7nHed01LrKwCA7alFCAAAUCEAgIMK/wsAYDNQIQAAKgQAQIUAAKgQAAAVAgCgQgAAVAgAgAoBAFAhAAAqBABAhQAAqBAAABUCAKBCAABUCACACgEAUCEAACoEAECFAACoEAAAFQIAoEIAAFQIAIAKAQBQIQAAKgQAQIUAAKgQAAAVAgCgQgAAVAgAgArBFf7+/rXgG4oGKYEKUaEdUf1/BSv7a9UqKCj49OlTcXFxaWlpeXk5GYIKUSEqtKMKs7KycnJycnNzJUTZkAxBhagQFdpRhUlJSRkZGa9evZINi4qKyBBUiApRoR1VePPmzYSEBNnwzZs3hYWFZAgqRIWo0I4qvHDhgmz46NGjFy9e5OXlkSGoEBWiQjuqMCYm5vLly/Hx8enp6R8+fCBDUCEqRIV2VGF0dPTFixfv3Lnz5MkTVIgKUSEqRIWoEBWiQlSIClEhKkSFqBAVokJUiApRISpEhagQFaJCVIgKUSEqRIWoEBWiQlSIClEhKkSFqBAVokJUiApRISpEhagQFaJCVIgKUSEqRIWoEBWiQlSIClEhKkSFqBAVokJUiApR4Z+lwmHDhimtO3Xq9Nse8dq1a//+i9zcXFSICt2CX5S0bloLqPDvQQtv/te0p0+fosLfQPfu3fXkZ86ciQprWtK6aS38mSq8devWmTNnrl69igp/hQpLS0vXrl0bEBDQqFGjJk2a+Pr6Tpo0KT4+HhWiQlRYo7tCa3jp0qWgoKAGDRr06NFDGf/9fAm0Z8+enp6e/v7+p0+ftiaYwuvVq5cZqlTMYm/dulXDPn36OP2Puppfw0N07NixkSNHNm7cODQ0NCUl5aeUMX/+fHObHh4e9evXN9/v2bPHfVV4/PhxE41BgwbpRtxIhefPnx86dKiXl5cWolu3buvWrfvy5Ut1ktaGtWA7FSpXVLryoFkh5f27d+++n9ChQ4e6detqqK937951XP7evXv/Gcu/YMECvRio/u/fvx8SEuLj4/P69evKi6N169a6x7CwsJKSEg1zcnIOHz6sTtycXblypS7evHlzBVAz1TCmp6ebU127dtUPzpgxIyoqytvbu02bNps2bcrLy5s+fbqWo3Pnzvv373eS3bRp0yIjI1u1aqUOVNb++PGjSxVWVFToUjqoRWzWrNm4ceOSkpIqeTuO0Zg4cWLLli0vXLjgFiqUtWvXru2Ue8HBwdVJWrvVgh1VKFSBpmbMUIXnNGHHjh0aqiRMBqiiHJdfy+xy+d1rU3DgwAG9pBcWFjq6YMWKFZVXYbt27XSno0aNSkhIKC8vdzo7fPhwPz8/nR07dmyLFi00UztotSqWCrWnVngbNmxoIqZepl69eqa71HHLmybmderU0dW0EGZFJkyY4FKFc+fO1VDX0eOaUxJiRkbGD+/l4MGDTtGIiIgIDw+v+SrUc9Y96k61HErI7OzsESNGmJCqVaxy0tqqFmyqQtXJ58+fNUxOTjZLtXbtWscJahjLysrMkSFDhuiIGoQ/b/lV+XFxcY46UEPXt2/fyqtQd201IwqaYrVz506FzpxVr62vb9++lYnUaplpN27csFTYtGnTZ8+eqXSlOQ3VG6onTU1NNTP37t3rKDvVuVZNww0bNpgJaWlpTiqUtszzOXLkiIayc0BAgIbz5s374b24jIaaxJqvwitXrpiALF++3HqL3BxZtGhRNVVok1qwqQrV7ZuhStQsldbMcYKqzrqCto1mTnFx8ffLb+Xc37X8Jtt+G5a2DBKTgvNTb67dvn174cKFgYGBRmdCm1xzavfu3dpxOz3i0aNHLRWqvzAzTc84a9YsM9RrlXl9clShFsIMHzx4YC514sQJJxVqe+7yNgcMGFCZj0q+j4Y2479zObT6VciZ6Oho8+O7du0yR7Kysqy1qHLS/uO1gAp/x8cmZqgVcqlCbQQKCgrMEfOWh/VKGBQU5Piuh5WFbtoVXrx40bH41Yj9VFfoiFonsy/z9PSUUx4+fGgatMmTJ8tQ27ZtM2FRxCwVWrvatm3barh48WIz9PDw0HD16tWOKgwODjZDq/v4XoWHDh0yp7RN/pcDW7ZsqUxX6BSNPXv2aM/u1l1hZGRklZPWVrWACl2rUERERLx8+VJqMEPr/RF9Y6pdLYNSpH///k7Lv3nzZnMkNja2hgfn5MmT6tp0j+YjiJSUFOlg+/btlddfaGjo/v37MzMzKyoq8vPzR40aZba9joWhDkUzY2JiqqlCLy8vcyk1oeZSjx8/dlKhtszm1MaNG60neffuXaedr0tOnTrlGI3k5GR/f/8lS5a413uF8fHx2dnZI0eONHE4d+5clZPWVrWACl2rsOlfWNsWVab1qdm+ffvMQb1a1q9f33rL31r+GzduOG55wsPDa3J8bt68OX78+ObNm+upSgTr16932iT+f4zCTDSsWw4LC9Op1NRUYzS1isuWLVMrUU0VNmnSRNvVjh07muvoabv82GT27NlmwsCBA0ePHu3n56fvN2zYUJnbUTNlRcPb21uX0hG3+AR59+7d32+3x4wZo5eoKiet3WoBFbpQoSaoBvr166cFVmugfsG6YHl5eVRUVPv27Rs3bhwSEqI9mtPyi1WrVnXo0MFsD91l+av2K9by2tSpU7t06aJoqDvQN0uXLi0qKjJnDxw44Ovrq+PadB88eLCaKtRkBVYzJcQpU6bk5ua6VKEWaNOmTYGBgVo72VMPNGfOnMTExD/+V6zPnj07ePBg3bL5BcA1a9aUlpZWJ2ltWwt/pgqrqU77UJP/8O5X/D0Jf21CLaBClh8VokJqARWy/KgQFVILqBDcToX8I12ACgEVokJAhYAKUSGgQkCFqBBQIaBCVAioEFAhKgRUCKgQFQIqBFSICgEVAipEhYAKARWiQkCFgApRIaBCQIWoEFAhoEJUCKgQUCEqBFQIqBAVAioEVIgKARUCKkSFgAoBFaJCQIWAClEhoEJAhagQUCH8c/j4+NSCb3h5eaFCVIgKbUpeXl5mZmZiYmJcXFxsbOwhe6MIKA6KhmKiyJAeqBAV2oWCgoLs7Oy0tLR79+5dv379vL1RBBQHRUMxUWRID1SICu3C58+f379/n5WVpfpPSEj4j71RBBQHRUMxUWRID1SICu1CSUmJ2h9Vvvqg58+fP7Y3ioDioGgoJooM6YEKUaFdKCsrU82rA8rPz8/NzX1nbxQBxUHRUEwUGdIDFaJCe1HxjXJ7Y8WBlECFqBAAUCEqBABUiAoBABWiQgBAhagQAFAhKgQAVIgKAQAVokIAQIWoEABQISoEAFSICgEAFaJCAABUCACACgEAUCEAACoEAECFAACoEAAAFQIAoEIAAFQIAIAKAQBQIQAAKgQAQIUAAD9SIQCAbUGFAACoEADg69f/AWZ2p94jz7ofAAAAAElFTkSuQmCC" alt="Sample" />
<p class="caption">Sample</p>
</div>
<h1 id="intel-82599-ethernet-controller-apps">Intel 82599 Ethernet Controller Apps</h1>
<h2 id="intel82599-apps.intel.intel_app">Intel82599 (apps.intel.intel_app)</h2>
<p>The <code>Intel82599</code> drives one port of an Intel 82599 Ethernet controller. Packets taken from the <code>rx</code> port are transmitted onto the network. Packets received from the network are put on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbgAAAB+CAIAAADZbpP5AAALH0lEQVR42u2deUhV6xqHG20yK4oymiebaTAsS7CJqP7ICKGCIoogqCijgSjqRkE2z2Bgg+CRigQrdscyM8iG25xmk9lg82BmZmll99wf5+MuNku37sque3ee5w/Za31rrb38vu991vvutXRX+QsAAMqkCl0AAIAoAQAqSJT/AQAAJxAlAACiBABAlAAAiBIAAFECACBKAABECQCAKAEAECWiBABAlAAAiBIAAFECACBKAABECQCAKAEAECUAAKIEAABECQCAKAEAECUAAKIEAECUAACIEgAAUQIAIEoAAECUAACIEgAAUQIAIEoAAEQJAIAoAQAQJXgbXbp0qQKVjUaBqYgowXNRlP4FlY1GIT8/v6CgoLCw8PPnz8XFxcxMRAmIEuyifPLkyatXr3Jzc6VLuZKZiSgBUYJdlDdv3rx///6zZ8/kyk+fPjEzESUgSrCL8ty5c2lpaXLly5cvP3z4wMxElIAowS7KxMREuTIjI+Px48d5eXnMTEQJiBLsojxw4EBSUtKlS5eysrLevn3LzESUgCjBLsp9+/YdO3bs4sWL9+7dQ5SIEhAlIEpECYgSECWiBEQJiBJRIkpECYgSECUgSkQJiBIQJaIERAmIElECogREiSgBUQKiBESJKAFRAqJElIAoAVEiSkCUgCgBUSJKRIkoAVH+81iwYIH7/yK7QkQ5ZcoU8yVZly5dcnOXU6dO/etv3r175+Yuw4YN01u0adPGWhMXFzdw4MAmTZrUrVs3ICBg0aJFOTk5pik+Pn7ChAmdOnWqV6+eNggJCUlISLB2jIqKKvkNXzNmzLA2cDgcgwYN0mF9fX2HDBmSmprqfCZlt3qvKDVzvnz58jNHSElJMcOam5uLKMHTk8TevXtfvXrVk0WpWDK7PHz48MdEuW3bNnOEatWqyVnmdd++fb99+6bW/v37l1Thli1b3BFlbGysWePj41OzZk290M/k5GR3Wr1alGbmpKen//ARrGF98OABovxH4L3fW2Jmau3atdevX/8bizIoKMjY6vbt28XFxWFhYeaA169fV2toaGhERMSVK1eePn26atUq09SsWTNnUepQ551QbKtJntVmau3atWteXp6c1a5dOy127ty53NbfQJRm5mzevBlRIspSsIJQqYEuqjVq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" alt="Intel82599" />
<p class="caption">Intel82599</p>
</div>
<p>— Method <strong>Intel82599.dev:get_rxstats</strong></p>
<p>Returns a table with the following keys:</p>
<ul>
<li><code>counter_id</code> - Counter id</li>
<li><code>packets</code> - Number of packets received</li>
<li><code>dropped</code> - Number of packets dropped</li>
<li><code>bytes</code> - Total bytes received</li>
</ul>
<p>— Method <strong>Intel82599.dev:get_txstats</strong></p>
<p>Returns a table with the following keys:</p>
<ul>
<li><code>counter_id</code> - Counter id</li>
<li><code>packets</code> - Number of packets sent</li>
<li><code>bytes</code> - Total bytes sent</li>
</ul>
<h3 id="configuration">Configuration</h3>
<p>The <code>Intel82599</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>pciaddr</strong></p>
<p><em>Required</em>. The PCI address of the NIC as a string.</p>
<p>— Key <strong>macaddr</strong></p>
<p><em>Optional</em>. The MAC address to use as a string. The default is a wild-card (e.g. accept all packets).</p>
<p>— Key <strong>vlan</strong></p>
<p><em>Optional</em>. A twelve bit integer (0-4095). If set, incoming packets from other VLANs are dropped and outgoing packets are tagged with a VLAN header.</p>
<p>— Key <strong>vmdq</strong></p>
<p><em>Optional</em>. Boolean, defaults to false. Enables interface virtualization. Allows to have multiple <code>Intel82599</code> apps per port. If enabled, <em>macaddr</em> must be specified.</p>
<p>— Key <strong>mirror</strong></p>
<p><em>Optional</em>. A table. If set, this app will receive copies of all selected packets on the physical port. The selection is configured by setting keys of the <em>mirror</em> table. Either <em>mirror.pool</em> or <em>mirror.port</em> may be set.</p>
<p>If <em>mirror.pool</em> is <code>true</code> all pools defined on this physical port are mirrored. If <em>mirror.pool</em> is an array of pool numbers then the specified pools are mirrored.</p>
<p>If <em>mirror.port</em> is one of “in”, “out” or “inout” all incoming and/or outgoing packets on the port are mirrored respectively. Note that this does not include internal traffic which does not enter or exit through the physical port.</p>
<p>— Key <strong>rxcounter</strong></p>
<p>— Key <strong>txcounter</strong></p>
<p><em>Optional</em>. Four bit integers (0-15). If set, incoming/outgoing packets will be counted in the selected statistics counter respectively. Multiple apps can share a counter. To retrieve counter statistics use <code>Intel82599.dev:get_rxstats()</code> and <code>Intel82599.dev:get_txstats()</code>.</p>
<p>— Key <strong>rate_limit</strong></p>
<p><em>Optional</em>. Number. Limits the maximum Mbit/s to transmit. Default is 0 which means no limit. Only applies to outgoing traffic.</p>
<p>— Key <strong>priority</strong></p>
<p><em>Optional</em>. Floating point number. Weight for the <em>round-robin</em> algorithm used to arbitrate transmission when <em>rate_limit</em> is not set or adds up to more than the line rate of the physical port. Default is 1.0 (scaled to the geometric middle of the scale which goes from 1/128 to 128). The absolute value is not relevant, instead only the ratio between competing apps controls their respective bandwidths. Only applies to outgoing traffic.</p>
<p>For example, if two apps without <em>rate_limit</em> set have the same <em>priority</em>, both get the same output bandwidth. If the priorities are 3.0/1.0, the output bandwidth is split 75%/25%. Likewise, 1.0/0.333 or 1.5/0.5 yield the same result.</p>
<p>Note that even a low-priority app can use the whole line rate unless other (higher priority) apps are using up the available bandwidth.</p>
<h3 id="performance">Performance</h3>
<p>The <code>Intel82599</code> app can transmit and receive at approximately 10 Mpps per processor core.</p>
<h3 id="hardware-limits">Hardware limits</h3>
<p>Each physical Intel 82599 port supports the use of up to:</p>
<ul>
<li>64 <em>pools</em> (virtualized <code>Intel82599</code> app instances)</li>
<li>127 MAC addresses (see the <code>macaddr</code> configuration option)</li>
<li>64 VLANs (see the <code>vlan</code> configuration option)</li>
<li>4 <em>mirror pools</em> (see the <code>mirror</code> configuration option)</li>
</ul>
<h2 id="loadgen-apps.intel.loadgen">LoadGen (apps.intel.loadgen)</h2>
<p><code>LoadGen</code> is a <em>load generator</em> app based on the Intel 82599 Ethernet controller. It reads up to 32,000 packets from the <code>input</code> port and transmits them repeatedly onto the network. All incoming packets are dropped.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="LoadGen" />
<p class="caption">LoadGen</p>
</div>
<h3 id="configuration-1">Configuration</h3>
<p>The <code>LoadGen</code> app accepts a string as its configuration argument. The given string denotes the PCI address of the NIC to use.</p>
<h3 id="performance-1">Performance</h3>
<p>The <code>LoadGen</code> app can transmit at line-rate (14 Mpps) without significant CPU usage.</p>
<h1 id="intel-i210-i350-82599-ethernet-controller-apps-apps.intel_mp.intel_mp">Intel i210 / i350 / 82599 Ethernet Controller apps (apps.intel_mp.intel_mp)</h1>
<p>The <code>intel_mp.Intel</code> app provides drivers for Intel i210/i250/82599 based network cards. The driver exposes multiple receive and transmit queues that can be attached to separate instances of the app on different processes.</p>
<p>The links are named <code>input</code> and <code>output</code>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Intel" />
<p class="caption">Intel</p>
</div>
<h2 id="caveats">Caveats</h2>
<p>If attaching multiple processes to a single NIC, performance appears better with <code>engine.busywait = false</code>.</p>
<p>The <code>intel_mp.Intel</code> app can drive an Intel 82599 NIC at 14 million pps.</p>
<p>— Method <strong>Intel:get_rxstats</strong></p>
<p>Returns a table with the following keys:</p>
<ul>
<li><code>counter_id</code> - Counter id</li>
<li><code>packets</code> - Number of packets received</li>
<li><code>dropped</code> - Number of packets dropped</li>
<li><code>bytes</code> - Total bytes received</li>
</ul>
<p>— Method <strong>Intel:get_txstats</strong></p>
<p>Returns a table with the following keys:</p>
<ul>
<li><code>counter_id</code> - Counter id</li>
<li><code>packets</code> - Number of packets sent</li>
<li><code>bytes</code> - Total bytes sent</li>
</ul>
<h2 id="configuration-2">Configuration</h2>
<p>— Key <strong>pciaddr</strong></p>
<p><em>Required</em>. The PCI address of the NIC as a string.</p>
<p>— Key <strong>ndesc</strong></p>
<p><em>Optional</em>. Number of DMA descriptors to use i.e. size of the DMA transmit and receive queues. Must be a multiple of 128. Default is not specified but assumed to be broadly applicable.</p>
<p>— Key <strong>rxq</strong></p>
<p><em>Optional</em>. The receive queue to attach to, numbered from 0. The default is 0. When VMDq is enabled, this number is used to index a queue (0 or 1) for the selected pool. Passing <code>false</code> will disable the receive queue.</p>
<p>— Key <strong>txq</strong></p>
<p><em>Optional</em>. The transmit queue to attach to, numbered from 0. The default is 0. Passing <code>false</code> will disable the transmit queue.</p>
<p>— Key <strong>vmdq</strong></p>
<p><em>Optional</em>. A boolean parameter that specifies whether VMDq (Virtual Machine Device Queues) is enabled. When VMDq is enabled, each instance of the driver is associated with a <em>pool</em> that can be assigned a MAC address or VLAN tag. Packets are delivered to pools that match the corresponding MACs or VLAN tags. Each pool may be associated with several receive and transmit queues.</p>
<p>For a given NIC, all driver instances should have this parameter either enabled or disabled uniformly. If this is enabled, <em>macaddr</em> must be specified.</p>
<p>— Key <strong>vmdq_queuing_mode</strong></p>
<p><em>Optional</em>. Sets the queuing mode to use in VMDq mode. Has no effect when VMDq is disabled. The available queuing modes are <code>&quot;rss-64-2&quot;</code> (the default with 64 pools, 2 queues each) and <code>&quot;rss-32-4&quot;</code> (32 pools, 4 queues each).</p>
<p>— Key <strong>poolnum</strong></p>
<p><em>Optional</em>. The VMDq pool to associate with, numbered from 0. The default is to select a pool number automatically. The maximum pool number depends on the queuing mode.</p>
<p>— Key <strong>macaddr</strong></p>
<p><em>Optional</em>. The MAC address to use as a string. The default is a wild-card (i.e., accept all packets).</p>
<p>— Key <strong>vlan</strong> <em>Optional</em>. A twelve-bit integer (0-4095). If set, incoming packets from other VLANs are dropped and outgoing packets are tagged with a VLAN header.</p>
<p>— Key <strong>mirror</strong></p>
<p><em>Optional</em>. A table. If set, this app will receive copies of all selected packets on the physical port. The selection is configured by setting keys of the <em>mirror</em> table. Either <em>mirror.pool</em> or <em>mirror.port</em> may be set.</p>
<p>If <em>mirror.pool</em> is <code>true</code> all pools defined on this physical port are mirrored. If <em>mirror.pool</em> is an array of pool numbers then the specified pools are mirrored.</p>
<p>If <em>mirror.port</em> is one of “in”, “out” or “inout” all incoming and/or outgoing packets on the port are mirrored respectively. Note that this does not include internal traffic which does not enter or exit through the physical port.</p>
<p>— Key <strong>rxcounter</strong></p>
<p>— Key <strong>txcounter</strong></p>
<p><em>Optional</em>. Four bit integers (0-15). If set, incoming/outgoing packets will be counted in the selected statistics counter respectively. Multiple apps can share a counter. To retrieve counter statistics use <code>Intel:get_rxstats()</code> and <code>Intel:get_txstats()</code>.</p>
<p>— Key <strong>rate_limit</strong></p>
<p><em>Optional</em>. Number. Limits the maximum Mbit/s to transmit. Default is 0 which means no limit. Only applies to outgoing traffic.</p>
<p>— Key <strong>priority</strong></p>
<p><em>Optional</em>. Floating point number. Weight for the <em>round-robin</em> algorithm used to arbitrate transmission when <em>rate_limit</em> is not set or adds up to more than the line rate of the physical port. Default is 1.0 (scaled to the geometric middle of the scale which goes from 1/128 to 128). The absolute value is not relevant, instead only the ratio between competing apps controls their respective bandwidths. Only applies to outgoing traffic.</p>
<p>For example, if two apps without <em>rate_limit</em> set have the same <em>priority</em>, both get the same output bandwidth. If the priorities are 3.0/1.0, the output bandwidth is split 75%/25%. Likewise, 1.0/0.333 or 1.5/0.5 yield the same result.</p>
<p>Note that even a low-priority app can use the whole line rate unless other (higher priority) apps are using up the available bandwidth.</p>
<p>— Key <strong>rsskey</strong></p>
<p><em>Optional</em>. The rsskey is a 32 bit integer that seeds the hash used to distribute packets across queues. If there are multiple levels of RSS snabb devices in the packet flow making this unique will help packet distribution.</p>
<p>— Key <strong>wait_for_link</strong></p>
<p><em>Optional</em>. Boolean that indicates if <code>new</code> should block until there is a link light or not. The default is <code>false</code>.</p>
<p>— Key <strong>linkup_wait</strong></p>
<p><em>Optional</em> Number of seconds <code>new</code> waits for the device to come up. The default is 120.</p>
<p>— Key <strong>linkup_wait_recheck</strong></p>
<p><em>Optional</em> If the <code>linkup_wait</code> option is true, the number of seconds to sleep between checking the link state again. The default is 0.1 seconds.</p>
<p>— Key <strong>mtu</strong></p>
<p><em>Optional</em> The maximum packet length sent or received, excluding the trailing 4 byte CRC. The default is 9014.</p>
<p>— Key <strong>master_stats</strong></p>
<p><em>Optional</em> Boolean indicating whether to elect an arbitrary app (the master) to collect device statistics. The default is true.</p>
<p>— Key <strong>run_stats</strong></p>
<p><em>Optional</em> Boolean indicating if this app instance should collect device statistics. One per physical NIC (conflicts with <code>master_stats</code>). There is a small but detectable run time performance hit incurred. The default is false.</p>
<h3 id="rss-hashing-methods">RSS hashing methods</h3>
<p>RSS will distribute packets based on as many of the fields below as are present in the packet:</p>
<ul>
<li>Source / Destination IP address</li>
<li>Source / Destination TCP ports</li>
<li>Source / Destination UDP ports</li>
</ul>
<h3 id="default-rss-queue">Default RSS Queue</h3>
<p>Packets that are not IPv4 or IPv6 will be delivered to receive queue 0.</p>
<h3 id="hardware-limits-1">Hardware limits</h3>
<p>Each chipset supports a differing number of receive / transmit queues:</p>
<ul>
<li>Intel82599 supports 16 receive and 16 transmit queues, 0-15</li>
<li>Intel1g i350 supports 8 receive and 8 transmit queues, 0-7</li>
<li>Intel1g i210 supports 4 receive and 4 transmit queues, 0-3</li>
</ul>
<p>The Intel82599 supports both VMDq and RSS with 32/64 pools and 4/2 RSS queues for each pool. While the i350 supports VMDq, this driver does not currently support it.</p>
<h1 id="solarflare-ethernet-controller-apps">Solarflare Ethernet Controller Apps</h1>
<h2 id="solarflare-apps.solarflare.solarflare">Solarflare (apps.solarflare.solarflare)</h2>
<p>The <code>Solarflare</code> app drives one port of a Solarflare SFN7 Ethernet controller. Multiple instances of the Solarflare app can be instantiated on the same PCI device. Packets received from the network will be dispatched between apps based on destination MAC address and VLAN. Packets taken from the <code>rx</code> port are transmitted onto the network. Packets received from the network are put on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Solarflare" />
<p class="caption">Solarflare</p>
</div>
<p>The <code>Solarflare</code> app requires <a href="http://www.openonload.org/">OpenOnload</a> version <em>201502</em> to be installed and the <code>sfc</code> module to be loaded.</p>
<h3 id="configuration-3">Configuration</h3>
<p>The <code>Solarflare</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>pciaddr</strong></p>
<p><em>Required</em>. The PCI address of the NIC as a string.</p>
<p>— Key <strong>macaddr</strong></p>
<p><em>Optional</em>. The MAC address to use as a string. The default is a wild-card (e.g. accept all packets).</p>
<p>— Key <strong>vlan</strong></p>
<p><em>Optional</em>. A twelve bit integer (0-4095). If set, incoming packets from other VLANs are dropped and outgoing packets are tagged with a VLAN header.</p>
<h1 id="ratelimiter-app-apps.rate_limiter.rate_limiter">RateLimiter App (apps.rate_limiter.rate_limiter)</h1>
<p>The <code>RateLimiter</code> app implements a <a href="http://en.wikipedia.org/wiki/Token_bucket">Token bucket</a> algorithm with a single bucket dropping non-conforming packets. It receives packets on the <code>input</code> port and transmits conforming packets to the <code>output</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="RateLimiter" />
<p class="caption">RateLimiter</p>
</div>
<p>— Method <strong>RateLimiter:snapshot</strong></p>
<p>Returns throughput statistics in form of a table with the following fields:</p>
<ul>
<li><code>rx</code> - Number of packets received</li>
<li><code>tx</code> - Number of packets transmitted</li>
<li><code>time</code> - Current time in nanoseconds</li>
</ul>
<h2 id="configuration-4">Configuration</h2>
<p>The <code>RateLimiter</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>rate</strong></p>
<p><em>Required</em>. Rate in bytes per second to which throughput should be limited.</p>
<p>— Key <strong>bucket_capacity</strong></p>
<p><em>Required</em>. Bucket capacity in bytes. Should be equal or greater than <em>rate</em>. Otherwise the effective rate may be limted.</p>
<p>— Key <strong>initial_capacity</strong></p>
<p><em>Optional</em>. Initial bucket capacity in bytes. Defaults to <em>bucket_capacity</em>.</p>
<h2 id="performance-2">Performance</h2>
<p>The <code>RateLimiter</code> app is able to process more than 20 Mpps per CPU core. Refer to its selftest for details.</p>
<h1 id="pcapfilter-app-apps.packet_filter.pcap_filter">PcapFilter App (apps.packet_filter.pcap_filter)</h1>
<p>The <code>PcapFilter</code> app receives packets on the <code>input</code> port and transmits conforming packets to the <code>output</code> port. In order to conform, a packet must match the <em><a href="http://www.tcpdump.org/manpages/pcap-filter.7.html">pcap-filter</a> expression</em> of the <code>PcapFilter</code> instance and/or belong to a <em>sanctioned connection</em>. For a connection to be sanctioned it must be tracked in a <em>state table</em> by a <code>PcapFilter</code> app using the same state table. All <code>PcapFilter</code> apps share a global namespace of <em>state table identifiers</em>. Multiple <code>PcapFilter</code> apps—e.g. for inbound and outbound traffic—can refer to the same connection by sharing a state table identifer.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="PcapFilter" />
<p class="caption">PcapFilter</p>
</div>
<h2 id="configuration-5">Configuration</h2>
<p>The <code>PcapFilter</code> app accepts a table as its configuration argument. The following keys are available:</p>
<p>— Key <strong>filter</strong></p>
<p><em>Required</em>. A string containing a <a href="http://www.tcpdump.org/manpages/pcap-filter.7.html">pcap-filter</a> expression.</p>
<p>— Key <strong>state_table</strong></p>
<p><em>Optional</em>. A string naming a state table. If set, packets passing any <em>rule</em> will be tracked in the specified state table and any packet that belongs to a tracked connection in the specified state table will be let pass.</p>
<h2 id="special-counters">Special Counters</h2>
<p>— Key <strong>sessions_established</strong></p>
<p>Total number of sessions established.</p>
<h1 id="ipv4-apps">IPv4 Apps</h1>
<h2 id="arp-apps.ipv4.arp">ARP (apps.ipv4.arp)</h2>
<p>The <code>ARP</code> app implements the Address Resolution Protocol, allowing a Snabb network function to automatically learn the next-hop MAC address for outgoing IPv4 traffic. The <code>ARP</code> app will also respond to incoming address resolution requests from other hosts on the same network. The next-hop MAC address may also be statically configured. Finally, the Ethernet source address for all outgoing traffic will be set to the <code>self_mac</code> address configured on the <code>ARP</code> app.</p>
<p>All of this together means that using the <code>ARP</code> app in your network function allows you to forget about link-layer concerns, for IPv4 traffic anyway.</p>
<p>Topologically, the <code>ARP</code> app sits between your network function and the Ethernet interface. Its <code>north</code> link relays traffic to and from the network function; the <code>south</code> link talks instead to the Ethernet interface.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="ARP" />
<p class="caption">ARP</p>
</div>
<h3 id="configuration-6">Configuration</h3>
<p>The <code>ARP</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>self_mac</strong></p>
<p><em>Optional</em>. The MAC address of this network function. If not provided, a random MAC address will be generated. Two random MAC addresses have a one-in-nine-million chance of colliding. The ARP app will ensure that all outgoing southbound traffic will originate from this MAC address.</p>
<p>— Key <strong>self_ip</strong></p>
<p><em>Required</em>. The IPv4 address of this host; used to respond to requests and when making ARP requests.</p>
<p>— Key <strong>next_mac</strong></p>
<p><em>Optional</em>. The MAC address to which to send all network traffic. This ARP app currently hsa the limitation that it assumes that all traffic will go to a single MAC address. If this address is provided as part of the configuration, no ARP request will be made; otherwise it will be determined from the <em>next_ip</em> via ARP.</p>
<p>— Key <strong>next_ip</strong></p>
<p><em>Optional</em>. The IPv4 address of the next-hop host. Required only if <em>next_mac</em> is not specified as part of the configuration.</p>
<p>— Key <strong>shared_next_mac_key</strong></p>
<p><em>Optional</em>. Path to a shared memory location (i.e. <em>/var/run/snabb/PID/PATH</em>) in which to store the resolved next_mac. This ARP resolver might be part of a set of peer processes sharing work via RSS. In that case, an ARP response will probably arrive only to one of the RSS processes, not to all of them. If you are using ARP behind RSS, set <em>shared_next_mac_key</em> to, for example, <code>group/arp-next-mac</code>, to enable the different workers to communicate the next-hop MAC address.</p>
<h2 id="reassembler-apps.ipv4.reassemble">Reassembler (apps.ipv4.reassemble)</h2>
<p>The <code>Reassembler</code> app is a filter on incoming IPv4 packets that reassembles fragments. Note that Snabb’s internal MTU is 10240 bytes; attempts to reassemble larger packets will fail.</p>
<div class="figure">
<img src="data:image/png;base64,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iYmJzCqVCVEhKsGlC7HSf+yAqIRVVDQ2njx5wqxCVDj8COKlKzM+v/qeWYWoAESFqABEBUSFqBAVEBUQFRAVEBWAqBAVEBWAqBAVgKiAqICogKiAqICogKgARIWogKgQFRAVosLYA1EBUQFRAVEBiApRAVEBiApRAYgKiAqICogKiAqICogKQFSICogKUQFRISoAUQFRAVEBUQGIClEBUQGIClEBiAqICogKiArCTVRUVBUEX2RkJFEBUUFYyMrKunfv3uXLl0+cOHHgwIGtCA7tW+1h7Wftbe1zBh6ICiqn7Ozs9PT0mzdvXrx48fjx44cQHNq32sPaz9rb2ucMPBAVVE4vX778/fff09LSNN+lpqamIDi0b7WHtZ+1t7XPGXggKqic8vLydOGsmU5X0Hfv3v03gkP7VntY+1l7W/ucgQeigsrp1atXmuN07fzs2bPMzMwMBIf2rfaw9rP2tvY5Aw9EBZVZ4f8UIDjcHmawgagAAIgKAICoAABAVAAARAUAQFQAACAqAACiAgAgKgAAogIAAFEBABAVAABRAQAQFaICACAqAACiAgAgKgAAEBUAAFEBABAVAABRISoAAKICACAqAACiAgAAUQEA/BNRAQCgjIgKAICoAABCz38B0mDMb0fNVJcAAAAASUVORK5CYII=" alt="IPv4Reassembler" />
<p class="caption">IPv4Reassembler</p>
</div>
<p>The reassembler has a configurable limit for the reassembly buffer size. If the buffer is full and a new reassembly comes in on the input, the reassembler app will randomly evict a pending reassembly from its buffer before starting the new reassembly.</p>
<p>The reassembler app currently does not time out reassemblies that have been around for too long. It could be a good idea to implement timeouts and then be able to issue “timeout exceeded” ICMP errors if needed.</p>
<p>Finally, note that the reassembler app will pass through any incoming packet that is not IPv4.</p>
<h3 id="configuration-7">Configuration</h3>
<p>The <code>Reassembler</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>max_concurrent_reassemblies</strong></p>
<p><em>Optional</em>. The maximum number of concurrent reassemblies. Note that each reassembly uses about 11kB of memory. The default is 20000.</p>
<p>— Key <strong>max_fragments_per_reassembly</strong></p>
<p><em>Optional</em>. The maximum number of fragments per reassembly. The default is 40.</p>
<h2 id="fragmenter-apps.ipv4.fragment">Fragmenter (apps.ipv4.fragment)</h2>
<p>The <code>Fragmenter</code> app that will fragment any IPv4 packets larger than a configured maximum transmission unit (MTU).</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhwAAAB+CAIAAADgP19TAAAMGklEQVR42u3deWxMawPHcdSuagtqC/4rat/+ULHGvkWbkJBIJEiQIEhEyCv2hNhijX0n9qVqayVKK0optbx2qrVXFa3Svvf95T73npzMdJlOTbWd7+ePm3vGudPpc57zfM+Z0d5SfwEA8JuUYggAAEQFAFCEo/I/AADcQlQAAEQFAEBUAABEBQAAogIAICoAAKICACAqRAUAQFQAAEQFAEBUAAAgKgAAogIAICoAAKJCVAAARAUAQFQAAEQFAACiAgAgKgAAogIAICpEBQBAVAAARAUAQFQAACAqAACiAgAgKgAAogIAAFEBABAVAABRAX63gICAUvA8jTOTDUQFJZ/Wu7/geRrn1NTUb9++paenZ2RkZGZmMvdAVEBU4H5UEhIS3r17l5ycrLSoK8w9EBUQFbgflXv37j19+jQxMVFdSUtLY+6BqICowP2oREVFxcXFqStv3779+vUrcw9EBUQF7kclLCxMXYmPj3/16lVKSgpzD0QFRAXuR+XgwYPnz5+PiYl58uTJp0+fmHsgKiAqcD8q+/fvP3v27PXr1x8/fkxUQFRAVEBUQFQAokJUQFQAokJUAKICogKiAqICogKiAqICEBWiAqJCVEBUiApAVEBUQFRAVACiQlRAVACiQlQAogKiAqICogKiAqICogIQFaIColJSotKrVy+dMI0bNy60rxgREfGfvyUnJzOfnM2YMcP1/7FgTlEZM2ZMKSc+Pj4lZpW/dOmSmUWfP3/2nqhobvz8+bNYT28Pnf7FelUhKgWlA2/WuGfPnpGQbDvRpk2b2NhYopILaxY9f/7ce6Ji5sadO3eK7/T20OlfrFeVkhaV6OjokydPXrx4kagUnahIxYoVly1bVvCorFmzJuxf586dy2nRTE9P98KouP5dF52omLmxcuVKokJUisedirWpBahdu3aavoGBgTqXnPdXilq1alW+fPmAgIATJ05YO7Ro0cJcT5lNnYTW6qbN9u3bO1w+a39C4rxwGN27d3/16lW2ux06dKhfv35VqlQZOXLkgwcPcopKTEyM8xJpHcTw8HAdqbJly2rF3LJlS5cuXerWratj6uvr27lz5127dtkn+YIFC/z9/fUVR4wYcfnyZfP8etDs0K1bN/Oc+qPWrVtXqlSpb9++iYmJ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" alt="IPv4Fragmenter" />
<p class="caption">IPv4Fragmenter</p>
</div>
<h3 id="configuration-8">Configuration</h3>
<p>The <code>Fragmenter</code> app accepts a table as its configuration argument. The following key is defined:</p>
<p>— Key <strong>mtu</strong></p>
<p><em>Required</em>. The maximum transmission unit, in bytes, not including the Ethernet header.</p>
<h2 id="icmp-echo-responder-apps.ipv4.echo">ICMP Echo responder (apps.ipv4.echo)</h2>
<p>The <code>ICMPEcho</code> app responds to ICMP echo requests (“pings”) to a given set of IPv4 addresses.</p>
<p>Like the <code>ARP</code> app, <code>ICMPEcho</code> sits between your network function and outside traffic. Its <code>north</code> link relays traffic to and from the network function; the <code>south</code> link talks to the world.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="IPv4ICMPEcho" />
<p class="caption">IPv4ICMPEcho</p>
</div>
<h3 id="configuration-9">Configuration</h3>
<p>The <code>ICMPEcho</code> app accepts a table as its configuration argument. The following keys is defined:</p>
<p>— Key <strong>address</strong></p>
<p><em>Optional</em>. An IPv4 address for which to respond to pings, as a <code>uint8_t[4]</code>.</p>
<p>— Key <strong>addresses</strong></p>
<p><em>Optional</em>. An array of IPv4 addresses for which to respond to pings, as a Lua array of <code>uint8_t[4]</code> values.</p>
<h1 id="ipv6-apps">IPv6 Apps</h1>
<h2 id="nd_light-apps.ipv6.nd_light">Nd_light (apps.ipv6.nd_light)</h2>
<p>The <code>nd_light</code> app implements a small subset of IPv6 neighbor discovery (RFC4861). It has two duplex ports, <code>north</code> and <code>south</code>. The <code>south</code> port attaches to a network on which neighbor discovery (ND) must be performed. The <code>north</code> port attaches to an app that processes IPv6 packets (including full ethernet frames). Packets transmitted to the <code>north</code> port must be wrapped in full Ethernet frames (which may be empty).</p>
<p>The <code>nd_light</code> app replies to neighbor solicitations for which it is configured as a target and performs rudimentary address resolution for its configured <em>next-hop</em> address. If address resolution succeeds, the Ethernet headers of packets from the <code>north</code> port will be overwritten with headers containing the discovered destination address and the configured source address before they are transmitted over the <code>south</code> port. All packets from the <code>north</code> port are discarded as long as ND has not yet succeeded. Packets received from the <code>south</code> port are transmitted to the <code>north</code> port unaltered.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="nd_light" />
<p class="caption">nd_light</p>
</div>
<h3 id="configuration-10">Configuration</h3>
<p>The <code>nd_light</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>local_mac</strong></p>
<p><em>Required</em>. Local MAC address as a string or in binary representation.</p>
<p>— Key <strong>remote_mac</strong></p>
<p><em>Optional</em>. MAC address of <strong>next_hop</strong> address as a string or in binary representation. If this option is present, the <code>nd_light</code> app does not perform neighbor solicitation for the <strong>next_hop</strong> address and uses <strong>remote_mac</strong> as the MAC address associated with <strong>next_hop</strong>.</p>
<p>— Key <strong>local_ip</strong></p>
<p><em>Required</em>. Local IPv6 address as a string or in binary representation.</p>
<p>— Key <strong>next_hop</strong></p>
<p><em>Required</em>. IPv6 address of <em>next hop</em> as a string or in binary representation.</p>
<p>— Key <strong>delay</strong></p>
<p><em>Optional</em>. Neighbor solicitation retransmission delay in milliseconds. Default is 1,000ms.</p>
<p>— Key <strong>retrans</strong></p>
<p><em>Optional</em>. Number of neighbor solicitation retransmissions. Default is unlimited retransmissions.</p>
<p>— Key <strong>quiet</strong></p>
<p><em>Optional</em>. If set to <strong>true</strong>, suppress log messages about ND activity. Default is <strong>false</strong>.</p>
<h3 id="special-counters-1">Special Counters</h3>
<p>— Key <strong>ns_checksum_errors</strong></p>
<p>Neighbor solicitation requests dropped due to invalid ICMP checksum.</p>
<p>— Key <strong>ns_target_address_errors</strong></p>
<p>Neighbor solicitation requests dropped due to invalid target address.</p>
<p>— Key <strong>na_duplicate_errors</strong></p>
<p>Neighbor advertisement requests dropped because next-hop is already resolved.</p>
<p>— Key <strong>na_target_address_errors</strong></p>
<p>Neighbor advertisement requests dropped due to invalid target address.</p>
<p>— Key <strong>nd_protocol_errors</strong></p>
<p>Neighbor discovery requests dropped due to protocol errors (invalid IPv6 hop-limit or invalid neighbor solicitation request options).</p>
<h2 id="simplekeyedtunnel-apps.keyed_ipv6_tunnel.tunnel">SimpleKeyedTunnel (apps.keyed_ipv6_tunnel.tunnel)</h2>
<p>The <code>SimpleKeyedTunnel</code> app implements “a simple L2 Ethernet over IPv6 tunnel encapsulation” as described in <a href="http://tools.ietf.org/html/draft-mkonstan-keyed-ipv6-tunnel-01">Keyed IPv6 Tunnel</a>. It has two duplex ports, <code>encapsulated</code> and <code>decapsulated</code>. Packets transmitted on the <code>decapsulated</code> input port will be encapsulated and put on the <code>encapsulated</code> output port. Packets transmitted on the <code>encapsulated</code> input port will be decapsulated and put on the <code>decapsulated</code> output port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="SimpleKeyedTunnel" />
<p class="caption">SimpleKeyedTunnel</p>
</div>
<h3 id="configuration-11">Configuration</h3>
<p>The <code>SimpleKeyedTunnel</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>local_address</strong></p>
<p><em>Required</em>. Local IPv6 address as a string.</p>
<p>— Key <strong>remote_address</strong></p>
<p><em>Required</em>. Remote IPv6 address as a string.</p>
<p>— Key <strong>local_cookie</strong></p>
<p><em>Required</em>. Local cookie, 8 bytes encoded in a hexadecimal string.</p>
<p>— Key <strong>remote_cookie</strong></p>
<p><em>Required</em>. Remote cookie, 8 bytes encoded in a hexadecimal string.</p>
<p>— Key <strong>local_session</strong></p>
<p><em>Optional</em>. Unsigned integer, 32 bit. If set, the <code>session_id</code> field of the L2TPv3 header will be overwritten with this value.</p>
<p>— Key <strong>hop_limit</strong></p>
<p><em>Optional</em>. Unsigned integer. Sets the <em>hop limit</em>. Default is 64.</p>
<p>— Key <strong>default_gateway_MAC</strong></p>
<p><em>Optional</em>. Destination MAC as a string. Not required if overwritten by an app such as <code>nd_light</code>.</p>
<h3 id="special-counters-2">Special Counters</h3>
<p>— Key <strong>length_errors</strong></p>
<p>Ingress packets dropped due to invalid length (packet too short).</p>
<p>— Key <strong>protocol_errors</strong></p>
<p>Ingress packets dropped due to unrecognized IPv6 protocol ID.</p>
<p>— Key <strong>cookie_errors</strong></p>
<p>Ingress packets dropped due to wrong cookie value.</p>
<p>— Key <strong>remote_address_errors</strong></p>
<p>Ingress packets dropped due to wrong remote IPv6 endpoint address.</p>
<p>— Key <strong>local_address_errors</strong></p>
<p>Ingress packets dropped due to wrong local IPv6 endpoint address.</p>
<h2 id="fragmenter-apps.ipv6.fragment">Fragmenter (apps.ipv6.fragment)</h2>
<p>The <code>Fragmenter</code> app that will fragment any IPv6 packets larger than a configured maximum transmission unit (MTU).</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhwAAAB+CAIAAADgP19TAAAMGklEQVR42u3deWxMawPHcdSuagtqC/4rat/+ULHGvkWbkJBIJEiQIEhEyCv2hNhijX0n9qVqayVKK0optbx2qrVXFa3Svvf95T73npzMdJlOTbWd7+ePm3vGudPpc57zfM+Z0d5SfwEA8JuUYggAAEQFAFCEo/I/AADcQlQAAEQFAEBUAABEBQAAogIAICoAAKICACAqRAUAQFQAAEQFAEBUAAAgKgAAogIAICoAAKJCVAAARAUAQFQAAEQFAACiAgAgKgAAogIAICpEBQBAVAAARAUAQFQAACAqAACiAgAgKgAAogIAAFEBABAVAABRAX63gICAUvA8jTOTDUQFJZ/Wu7/geRrn1NTUb9++paenZ2RkZGZmMvdAVEBU4H5UEhIS3r17l5ycrLSoK8w9EBUQFbgflXv37j19+jQxMVFdSUtLY+6BqICowP2oREVFxcXFqStv3779+vUrcw9EBUQF7kclLCxMXYmPj3/16lVKSgpzD0QFRAXuR+XgwYPnz5+PiYl58uTJp0+fmHsgKiAqcD8q+/fvP3v27PXr1x8/fkxUQFRAVEBUQFQAokJUQFQAokJUAKICogKiAqICogKiAqICEBWiAqJCVEBUiApAVEBUQFRAVACiQlRAVACiQlQAogKiAqICogKiAqICogIQFaIColJSotKrVy+dMI0bNy60rxgREfGfvyUnJzOfnM2YMcP1/7FgTlEZM2ZMKSc+Pj4lZpW/dOmSmUWfP3/2nqhobvz8+bNYT28Pnf7FelUhKgWlA2/WuGfPnpGQbDvRpk2b2NhYopILaxY9f/7ce6Ji5sadO3eK7/T20OlfrFeVkhaV6OjokydPXrx4kagUnahIxYoVly1bVvCorFmzJuxf586dy2nRTE9P98KouP5dF52omLmxcuVKokJUisedirWpBahdu3aavoGBgTqXnPdXilq1alW+fPmAgIATJ05YO7Ro0cJcT5lNnYTW6qbN9u3bO1w+a39C4rxwGN27d3/16lW2ux06dKhfv35VqlQZOXLkgwcPcopKTEyM8xJpHcTw8HAdqbJly2rF3LJlS5cuXerWratj6uvr27lz5127dtkn+YIFC/z9/fUVR4wYcfnyZfP8etDs0K1bN/Oc+qPWrVtXqlSpb9++iYmJ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" alt="IPv6Fragmenter" />
<p class="caption">IPv6Fragmenter</p>
</div>
<h3 id="configuration-12">Configuration</h3>
<p>The <code>Fragmenter</code> app accepts a table as its configuration argument. The following key is defined:</p>
<p>— Key <strong>mtu</strong></p>
<p><em>Required</em>. The maximum transmission unit, in bytes, not including the Ethernet header.</p>
<h2 id="icmp-echo-responder-apps.ipv6.echo">ICMP Echo responder (apps.ipv6.echo)</h2>
<p>The <code>ICMPEcho</code> app responds to ICMP echo requests (“pings”) to a given set of IPv6 addresses.</p>
<p>Like the <code>ARP</code> app, <code>ICMPEcho</code> sits between your network function and outside traffic. Its <code>north</code> link relays traffic to and from the network function; the <code>south</code> link talks to the world.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="IPv6ICMPEcho" />
<p class="caption">IPv6ICMPEcho</p>
</div>
<h3 id="configuration-13">Configuration</h3>
<p>The <code>ICMPEcho</code> app accepts a table as its configuration argument. The following keys is defined:</p>
<p>— Key <strong>address</strong></p>
<p><em>Optional</em>. An IPv6 address for which to respond to pings, as a <code>uint8_t[16]</code>.</p>
<p>— Key <strong>addresses</strong></p>
<p><em>Optional</em>. An array of IPv6 addresses for which to respond to pings, as a Lua array of <code>uint8_t[16]</code> values.</p>
<h1 id="vhostuser-app-apps.vhost.vhost_user">VhostUser App (apps.vhost.vhost_user)</h1>
<p>The <code>VhostUser</code> app implements portions of the <a href="http://ozlabs.org/~rusty/virtio-spec/virtio-paper.pdf">Virtio</a> protocol for virtual ethernet I/O interfaces. In particular, <code>VhostUser</code> supports the virtio <em>vring</em> data structure for packet I/O in shared memory (DMA) and the Linux <em>vhost</em> API for creating vrings attached to <a href="https://www.kernel.org/doc/Documentation/networking/tuntap.txt">tuntap</a> devices.</p>
<p>With <code>VhostUser</code> SnabbSwitch can be used as a virtual ethernet interface by <em>QEMU virtual machines</em>. When connected via a UNIX socket, packets can be sent to the virtual machine by transmitting them on the <code>rx</code> port and packets sent by the virtual machine will arrive on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAB+CAIAAACF5NDdAAAKpElEQVR42u2deUgV7R7HK8sWy5KghXZeAttoh6hop0yKpKQFiiiiIoL2gghuFGX7DpW2QLZJQUWW7YGVrRjaYpktVtqiaVpZlt33fnkf7rxzj0vHo4c7vX4+f4jznJnnzPnN8/vM75kZPZX+BAD4TahECAAAYQEAeE1Y/wYAcCQICwAQFgAAwgIAhIWwAABhAQAgLABAWAgLABAWAADCAgCEBQCAsAAAEBYAICwAAIQFAICwAABhAQAgLAAAhAUACAsAAGEBACAsAEBYAAAICwAAYQEAwgIAQFgAAAgLABAWAADCAgCEhbAAAGEBACCsikRgYGAl8D6KM4MNYUFZUS79Cd5Hcc7Nzf38+fPXr1/z8/MLCgoYewgLEJZzhfXq1at3795lZWVJW3IWYw9hAcJyrrAePHjw9OnTtLQ0OSsvL4+xh7AAYTlXWHFxcQkJCXLW27dvP336xNhDWICwnCusmJgYOev+/fsvX778+PEjYw9hAcJyrrCioqLOnTt3+/btlJSUDx8+MPYQFiAs5wrr0KFDZ86cuXXr1pMnTxAWwgKEhbAAYSEsQFgICxAWwgKEBQgLYQHCQliAsBAWICyEBQgLEBbCAoSFsABhISxAWAgLEBYgLIQFCAthAcJCWICwEBYgLEBYCAsQlpOYP3+++//Q0gNh9enTR1v5+PhkZGTY21evXm2+cCEyMlKLAwcO1O8tWrQo9+S/fPnyv/4iOzvbapw4caJ599u3b5uWHz9+mJauXbsiLGtsfP/+vSw9XLp0yQQ/KysLYUH5FE2dOnWKj4/3krC2bdtmRBAeHm5v7969uxqrV6+ek5PjVWEpW8wOPH/+HGF5MDYSExM97sEK/rNnzxDWb4OT/ye3GU81atRYu3atN4T19u3bKlWqaMPBgwdbjS9fvjTvGxISYlr+2cL6+vXrbyosMzY2btyIsP6xwrJy78KFCzpBVa1adeHCheawhYWFaYWCgoIePXposUmTJv/3Utn+dXj9+vWTSopc7ciRI0FBQX5+fmPHjk1KSipV+vXv31+dKw5KPNOyYcMG844HDx50Edbdu3d79+5ds2bN9u3bnz171t5PTEyMuvL391dd1rZtWwVTljEvJSQkDB8+vGHDhr6+vvqpeWhERITaZR+Xr/xr166dm8Iqrk9rZwYMGGB2pkOHDjt27LBesj7LxYsXzQCQfdyM1dGjR02cFQS9nROEZRg0aFBxY6M4igx+dHS0Y3OhQgtLY05ZZ47N/v37J02apF/U8vTp082bN5v2U6dOOaTCsqhXr56yy2WdmTNnSh/KJdkkNDS0UaNGb968cV9Y27dvN53v2bPHtPTq1ctE49OnT/Ykr1OnTt26da2dUQwzMzPNCrt27apcubLL3o4YMUIv5efna5eMExs3bqyf+n3UqFFlEVYJfYrdu3ebndFHCAgIMBvOmzfP/lnsA+DAgQPuBMoe55EjR9avX19adIiwzNjQeauMwlK7Y3OhQgtL6FT5+PFjHZXU1NTs7OxmzZqpUbmqtNQvU6ZMcc6U0AWVUdbpLjIyUmWCZRaTV0uXLnVfWO/fv/fx8VG3wcHBWkxPTzeTRCv/rSQ3jUrXqVOn2i/Jf/782YhM7pBipMshQ4aYFZTS9+/ft9tHJ+2bN28q7csyJSyhT+2MUtdMcr98+aIQzZo1S4v6UDrW9s+iAZCcnKzZkGqTX0ZJZzWXOM+YMWPatGnOEZZh/Pjx7pdCRU4JHZsLFVpYOgO/fv3a3n7mzBnrqDdv3twhX4VS3LelN23a9NKlS1pBWXTlyhV7al2/fr1bt26lmhVqQqE+NbfSp7Yuw0dFRbkISzlvSqp79+6ZdVauXKlFTa7N4pIlS8z6N27cMC1z5szJyMgwBuzSpcvcuXNV/ijJy3gNq4Q+NdEza7Zp02bgX3Tu3NleQloDIC0tzf0QFRlnFVxOE5Zo2bKlGRseX8NyZi5UaGE1aNDApf3nz5+BgYHmIC1evLgsb9GvX79KXkZFxN69e82otS4VGZT50lmphBUeHm663bdvn9n5WrVqqTxxEZYKKLOo8W3W14jX4uHDh83izp07zQo6GVgnfC2uWbNGNrTvvyxTgrCsCi42Nta05OTkmBad9k1LcX1aO1OYdevWWZ9FA6C0F9oLx1lRquQ8ateubcaGx8Iqx1xAWOV20d2lfevWrdYh10DUmdOxFZacYo0wnfl1PrQn0q5du0pbYaluMpeBevbsaaaHo0ePtq/gcpdQuWoXVgkV1uzZs02LypCTJ0/KMto385K50KbZa2FhLVu2zMWAKmdMy5gxY6zViuzT2pktW7YU+WE9u+NZOM4RERFt27Z1WoXVu3dv92/5FScsZ+YCwvqblJQUPz8/tY8bN65JkybmwBcUFDhNWNLK2rVr7Y8LHjt2rFGjRpKUefAyKSlJqaVpXWlv7VtXnQzWNSZ3hGW/hnXnzh1ZIygoyKxw+vRpTSg2bdpk3QewrvGbu5n2y7rW21m+a9asmSqm6Oho6wqxmdaV0Kd1DatVq1bmopUqI80Tg4ODtZXHwjp+/Lg9zg8fPlQNsmDBAucIS2MjLCysVI+SKoZmW0XY+bmAsP4ugPv27WvyLSsr68SJE+Yorl+/3lHCat++fZFPkMbFxYWEhJgsVVKtWrXKZfLiDrt377bPKfLy8twXln1SaWfYsGHaPWnF6tbc2hN//PGHwq4Nr127Zt9k2rRppkOVeIU7VCWVn5+vV0vuUxMic5dQP/WqdTfQuMbjZ8pU5VlxDggImDx5slocIizZ082ni+1cvXrVJfhOzgWE5XqeUVlhWsaOHWvu7D569MghwtLc6pcPuJblbwk1OqtVq2bdhSx5GlVYWEJnaY11GcTX11f5s2LFCp3tTf01ffr0jh07Ksn1UtOmTSdMmKA5iLXh8uXL1WgUYwlLzlUtqa10FLRV69atFy1alJuba179ZZ/nz58fPHiw5KJXVaYNHTpUVZjKhHJ5CNZRD46KmTNnevzws2bf9uA7ORcqqLB+L8wNQaWfmyvzl8kV6k9zNDZiYmJIE4TlFEJDQ91/rAZhVShhaWy8f/+eHEFYv3E5hk349zKAsBAWICyEBQgLYQHCQliAsABhISxAWAgLEBbCAoSFsABhISyEhbAQFsJCWICwEBYgLIQFCAthISyEhbAQFsIChIWwAGEhLEBYCAsQFsIChAUIC2EBwkJYgLAQFiAshAUICxAWwgKEhbAAYSEsQFgICxAWICyEBQjrd8f6SlHwKv7+/ggLYUE58PHjx9TU1MTExCtXrkRHRx8A76DYKsKKs6KtmDPwEBZ4Qm5ubnp6enJycnx8fGxs7GnwDoqtIqw4K9qKOQMPYYEnfPnyJTMz89WrV8qlhISEG+AdFFtFWHFWtBVzBh7CAk/49u2bTvjKIp35X7x48Ri8g2KrCCvOirZizsBDWOAJP378UP7onJ+Tk5OVlZUB3kGxVYQVZ0VbMWfgISzwnJ//pQC8gxVhBhvCAgBAWACAsAAAEBYAAMICAIQFAICwAAAQFgAgLAAAhAUAgLAAAGEBACAsAACEBQAICwAAYQEAICwAQFgAAAgLAABhAQDCAgBAWAAACAsAEBYAAMICAIT1v8ICAHA4CAsAEBYAQHnzH4qJhkTMvIE3AAAAAElFTkSuQmCC" alt="VhostUser" />
<p class="caption">VhostUser</p>
</div>
<h2 id="configuration-14">Configuration</h2>
<p>The <code>VhostUser</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>socket_path</strong></p>
<p><em>Optional</em>. A string denoting the path to the UNIX socket to connect on. Unless given all incoming packets will be dropped.</p>
<p>— Key <strong>is_server</strong></p>
<p><em>Optional</em>. Listen and accept an incoming connection on <em>socket_path</em> instead of connecting to it.</p>
<h1 id="virtionet-app-apps.virtio_net.virtio_net">VirtioNet App (apps.virtio_net.virtio_net)</h1>
<p>The <code>VirtioNet</code> app implements a subset of the driver part of the <a href="http://docs.oasis-open.org/virtio/virtio/v1.0/csprd04/virtio-v1.0-csprd04.html">virtio-net</a> specification. It can connect to a virtio-net device from within a QEMU virtual machine. Packets can be sent out of the virtual machine by transmitting them on the <code>rx</code> port, and packets sent to the virtual machine will arrive on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="VirtioNet" />
<p class="caption">VirtioNet</p>
</div>
<h2 id="configuration-15">Configuration</h2>
<p>The <code>VirtioNet</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>pciaddr</strong></p>
<p><em>Required</em>. The PCI address of the virtio-net device.</p>
<p>— Key <strong>use_checksum</strong></p>
<p><em>Optional</em>. Boolean value to enable the checksum offloading pre-calculations applied on IPv4/IPv6 TCP and UDP packets.</p>
<h1 id="pcap-savefile-apps">Pcap Savefile Apps</h1>
<h2 id="pcapreader-and-pcapwriter-apps-apps.pcap.pcap">PcapReader and PcapWriter Apps (apps.pcap.pcap)</h2>
<p>The <code>PcapReader</code> and <code>PcapWriter</code> apps can be used to inject and log raw packet data into and out of the app network using the <a href="http://wiki.wireshark.org/Development/LibpcapFileFormat/">Libpcap File Format</a>. <code>PcapReader</code>reads raw packets from a PCAP file and transmits them on its <code>output</code> port while <code>PcapWriter</code> writes packets received on its <code>input</code> port to a PCAP file.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="PcapReader" />
<p class="caption">PcapReader</p>
</div>
<h3 id="configuration-16">Configuration</h3>
<p>Both <code>PcapReader</code> and <code>PcapWriter</code> expect a filename string as their configuration arguments to read from and write to respectively. <code>PcapWriter</code> will alternatively accept an array as its configuration argument, with the first element being the filename and the second element being a <em>mode</em> argument to <code>io.open</code>.</p>
<h2 id="tap-apps.pcap.tap">Tap (apps.pcap.tap)</h2>
<p>The <code>Tap</code> app is a simple in-band packet tap that writes packets that it sees to a pcap savefile. It can optionally only write packets that pass a pcap filter, and optionally subsample so it can write only every /n/th packet.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="pcaptap" />
<p class="caption">pcaptap</p>
</div>
<h3 id="configuration-17">Configuration</h3>
<p>The <code>Tap</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>filename</strong></p>
<p><em>Required</em>. The name of the file to which to write the packets.</p>
<p>— Key <strong>mode</strong></p>
<p><em>Optional</em>. Either <code>&quot;truncate&quot;</code> or <code>&quot;append&quot;</code>, indicating whether the savefile will be truncated (the default) or appended to.</p>
<p>— Key <strong>filter</strong></p>
<p><em>Optional</em>. A pflang filter expression to select packets for tapping. Only packets that pass this filter will be sampled for the packet tap.</p>
<p>— Key <strong>sample</strong></p>
<p><em>Optional</em>. A sampling period. Defaults to 1, indicating that every packet seen by the tap and passing the optional filter string will be written. Setting this value to 2 will capture every second packet, and so on.</p>
<h1 id="rawsocket-app-apps.socket.raw">RawSocket App (apps.socket.raw)</h1>
<p>The <code>RawSocket</code> app is a bridge between Linux network interfaces (<code>eth0</code>, <code>lo</code>, etc.) and a Snabb app network. Packets taken from the <code>rx</code> port are transmitted over the selected interface. Packets received on the interface are put on the <code>tx</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="RawSocket" />
<p class="caption">RawSocket</p>
</div>
<h2 id="configuration-18">Configuration</h2>
<p>The <code>RawSocket</code> app accepts a string as its configuration argument. The string denotes the interface to bridge to.</p>
<h1 id="unixsocket-app-apps.socket.unix">UnixSocket App (apps.socket.unix)</h1>
<p>The <code>UnixSocket</code> app provides I/O for a named Unix socket.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="UnixSocket" />
<p class="caption">UnixSocket</p>
</div>
<h2 id="configuration-19">Configuration</h2>
<p>The <code>UnixSocket</code> app takes a string argument which denotes the Unix socket file name to open, or a table with the fields:</p>
<ul>
<li><code>filename</code> - the Unix socket file name to open.</li>
<li><code>listen</code> - if <code>true</code>, listen for incoming connections on the socket rather than connecting to the socket in client mode.</li>
<li><code>mode</code> - can be “stream” or “packet” (the default is “stream”): the difference is that in packet mode, the packets are not split or merged (in both modes packets arrive in order).</li>
</ul>
<p><strong>NOTE</strong>: The socket is not opened until the first call to push() or pull(). If connection is lost, the socket will be re-opened on the next call to push() or pull().</p>
<h1 id="tap-app-apps.tap.tap">Tap app (apps.tap.tap)</h1>
<p>The <code>Tap</code> app is used to interact with a Linux <a href="https://www.kernel.org/doc/Documentation/networking/tuntap.txt">tap</a> device. Packets transmitted on the <code>input</code> port will be sent over the tap device, and packets that arrive on the tap device can be received on the <code>output</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAa4AAAB+CAIAAADz3mJWAAAJN0lEQVR42u3db0zNfQPHcRYVdYeZibXhWUszhfVA5u+mjWE0bDzyQFt6wMY80W7Mv60NM4zFzJ9bM4ZSisgmKxNRo1wIlUJIf1Wqy/3hu+t3n51zrutOp6PjnPfrgTnn+lXn2/f7e5/vr3NyDfgGAD5vAN8CACCFAGCTwj8BwMeQQgAghQBACgGAFAIAKQQAUggApBAASCEAkEIAIIUAQAoBgBQCACkEAFIIAKQQAEghAJBCACCFAEAKAYAUAgApBABSCACkEABIIQCQQgAghQBACgGAFAIAKQQAUggApBAASCGcCQ8PH+BLNF4mHaQQ9lSHb75E421qamppaWlra+vo6Ojq6mINgBTCF1NYXV39/v37+vp6BVE1ZA2AFMIXU/jkyZOKioqamhrV8MuXL6wBkEL4YgoLCgpKSkpUw3fv3jU3N7MGQArhiynMzs5WDR8/flxVVdXQ0MAaACmEL6bw3Llz169fLyoqevHixadPn1gDIIXwxRSmpaXl5OTcu3fv+fPnpBCkEKSQFIIUghSSQpBCkEJSCFIIUkgKQQpBCkkhSCFIISkEKQQpJIUghSCFpBCkEKSQFIIUghSSQpBCkEJSCFIIUkgKQQpBCkkhfCmFc+fO1aIfN27cL/uKeXl5//6hvr6+f8e+cePGnv/jzH2YwpEjR/7D/1+pvLycFNrO0devX/v9NHHTovWcc4EU9kMKNfHmnH/58mW/b/QmT55cXFxMCj02hWaOSktL+3epuGnRes65QAr/LCwszMjIuHHjhm+mUAIDA1NSUn5lCm/evJn9w7Zt28xjWL58efZfWlpaSKHjHO3bt48UksJftyu0bl67di06OlpLMDIyUueD4/EK6KRJk/z9/cPDw9PT060DJk6caJ7JzU2dSGayDxw4oJtTpkyx2wTp+P5NoTFr1qyqqiqnh50/fz4uLi4oKGjlypV9u2W7cuWK+eqbN2+2vf/YsWPTp08fPXq0vr3BwcExMTGnTp2y/qs1Bfpwawo0HX31qC5cuGDGGxsbm5qa6gkpNObNm/d3c9QTV69enT17dkhISEBAQERExK5du6xL794tWm86F0ih8xRqrfj5+amDZoZ0Vnz48MHxgLCwsEGDBumm/rx//77t9EdFRf1eKZThw4drH2R3TFJSkp4MVIeHDx/Gx8eHhoa+ffvW3SlctWqV2Qrpy+n7bI45e/asbQodp+DBgweuPyTb8S5dulTX8tqoekgKzRzpmakXn0dNHzhwoN1nW7x4sSuL1pvOBVLoPIWSnJzc3d29d+9ec1O7ErsDDh06pJs6YcwKWLRoke30a5qdTr8HXiDb0dbP+hn26dOn9ZTe3NxsW4qtW7e6O4VZWVlPnz41f1d5dZrpmBkzZtimUA4fPqybjx49sqbAxcdz5swZu/EmJiYmJCR4TgqN1atX/9TrDBrRsGHD9IFjxozRgqytrZ0/f775VNoq9nrRetO5QAqdp3Dw4MGtra26WVZWZqZq586dtgdow9LZ2Wnu0aWl7tH2wTtSKEpPXl6eDlAX8vPzbWNRWFg4depUd6ewo6NDzz3r1q1bsWLFsmXLtDfUMbpetk2hpqCrq8vcY02Bi4/H6Xi1SfS0FMr48ePNHPVEbm6u+agtW7ZYPyI392zYsMHFFHrHuUAKnadQLTA3KyoqzFRpzmwP0LOr9Rl02WiOaWtrc5x+a8311fSb1eZWugo7ceKEOQ+1ym3T8OrVK31z3JpCfcU5c+Y4Pirta2xTqCmwPsSagvb2dhdfKnEc79ChQwd4nuDgYDNHPZGWlmY+6siRI+ae6upqa4PZ60Xb7+cCKfwVL5uYm5ohpynUhUBTU5O5x/zIw3omjI6Otv2ph7UKf5ddoVJrPTDtknJycuxe0HD3rrCgoMDcuXbt2sbGRt1jymiXQk2BdSVrTYHru0K78aampkZERHjarjA2NvanFs8/7ArXr1/f60XrTecCKexlCiUxMfHNmzdKg7lp/XxEf9FNf39/bSi0RGJiYuymf//+/eaezMxMj0qh1nRKSortG3ovXbqki1ON8fPnz5ro8vJyxeLgwYNuTWFGRob181ndrKysDAoKckyhmYKamprjx49bU+Di47l8+bLteMvKysLDwzdt2uQ5KdQc7d69+2ffdG37s8KioqLa2tq4uDjzCbOysnq9aL3pXCCFvUzhv36wFqifn5/1qtnJkyetVRsQEDBkyBC76b9z547t4k5ISPCEFEZGRjp9r7X2aEuWLNEls45RJvbs2WN3CdnnKayrqwsJCTHX6frSo0aNMpeodil0nII+eQVZ2yVrvCNGjFizZo3u8ZAUqss9fD+8o6NHjzruLhcuXNjd3d3rRetN5wIp7GUKdYDOkGnTpmmCtUC1m7A+YVdXV3Jy8tixY7WXiY+Pv3jxot30y/bt28PCwsybGzwhhbpK+r+/geeO30H+u5dNbt26FRUVFRgYOGHCBG1CFyxY4JhCTcHdu3etKUhPT/fit1hLUlJSz39L0il9t2fOnBkcHGzeALhjx46Ojg5XFq03nQuk0NV0/tbMC0S5ubk9PNhD/qEEawp85LdNNEfZ2dmcC6SQ6XcXPVH3/O1ppLC/5qiuro5zgRQy/R60hSSF4Fwghb6Of6+QNQBSCFJICkEKQQpJIUghSCEpBCkEKSSFIIUghaQQpBCkkBSCFIIUkkKQQpBCUghSCFJICkEKQQpJIUghSCEpBCkEKSSFIIUghaQQpBCkkBSCFIIUkkKQQpBCUghSCFJICkEKQQpJIUghSCEpBCmEM6GhoQN8SUhICCkEKYQTDQ0NlZWVpaWl+fn5mZmZ//F2GqNGqvFq1Bo7CwCkEN81NTXV1tY+e/asuLj49u3bV72dxqiRarwatcbOAgApxHetra0fP36srq5WHUpKSu56O41RI9V4NWqNnQUAUojv2tvbtTlSF7RLev369R/eTmPUSDVejVpjZwGAFOK7zs5OFUH7o8bGxvr6+g/eTmPUSDVejVpjZwGAFOJ/uv/S5e2skTLpIIUAQAoBgBQCACkEAFIIAKQQAEghAJBCACCFAEAKAYAUAgApBABSCACkEABIIQCQQgAghQBACgGAFAIAKQQAUggApBAASCEAkEIAIIUA4FoKAcBnkUIAIIUA8O3bfwG+e8vkd3z8eAAAAABJRU5ErkJggg==" alt="Tap" />
<p class="caption">Tap</p>
</div>
<h2 id="configuration-20">Configuration</h2>
<p>This app accepts either a single string or a table as its configuration argument. A single string is equivalent to the default configuration with the <code>name</code> attribute set to the string.</p>
<p>— Key <strong>name</strong></p>
<p><em>Required</em>. The name of the tap device.</p>
<p>If the device does not exist yet, which is inferred from the absence of the directory <code>/sys/class/net/</code><strong>name</strong>, it will be created by the app and removed when the process terminates. Such a device is called <em>ephemeral</em> and its operational state is set to <em>up</em> after creation.</p>
<p>If the device already exists, it is called <em>persistent</em>. The app can attach to a persistent tap device and detaches from it when it terminates. The operational state is not changed. By default, the MTU is also not changed by the app, see the <strong>mtu_set</strong> option below.</p>
<p>One manner in which a persistent tap device can be created is by using the <code>ip</code> tool</p>
<pre><code>ip tuntap add Tap345 mode tap
ip link set up dev Tap345
ip link set address 02:01:02:03:04:08 dev Tap0</code></pre>
<p>— Key <strong>mtu</strong></p>
<p><em>Optional</em>. The L2 MTU of the device. The default is 1514.</p>
<p>By definition, the L2 MTU includes the size of the L2 header, e.g. 14 bytes in case of Ethernet without VLANs. However, the Linux <code>ioctl</code> methods only expose the L3 (IP) MTU, which does not include the L2 header. The following configuration options are used to correct this discrepancy.</p>
<p>— Key <strong>mtu_fixup</strong></p>
<p><em>Optional</em>. A boolean that indicates whether the <strong>mtu</strong> option should be corrected for the difference between the L2 and L3 MTU. The default is <em>true</em>.</p>
<p>— Key <strong>mtu_offset</strong></p>
<p><em>Optional</em>. The value by which the <strong>mtu</strong> is reduced when <strong>mtu_fixup</strong> is set to <em>true</em>. The default is 14.</p>
<p>The resulting MTU is called the <em>effective</em> MTU.</p>
<p>— Key <strong>mtu_set</strong></p>
<p><em>Optional</em>. Either <em>nil</em> or a boolean that indicates whether the MTU of the tap device should be set or checked. If <strong>mtu_set</strong> is <em>true</em>, the MTU of the tap device is set to the effective MTU. If <strong>mtu_set</strong> is false, the effective MTU is compared with the current value of the MTU of the tap device and an error is raised in case of a mismatch.</p>
<p>If <strong>mtu_set</strong> is <em>nil</em>, the MTU is set or checked if the tap device is ephemeral or persistent, respectively. The rationale is that if the device is persistent, the entity that created the device is responsible for the configuration and might not expect or react well to a change of the MTU.</p>
<h1 id="vlan-apps">VLAN Apps</h1>
<p>There are three VLAN related apps, <code>Tagger</code>, <code>Untagger</code> and <code>VlanMux</code>. The <code>Tagger</code> and <code>Untagger</code> apps add or remove a VLAN tag whereas the <code>VlanMux</code> app can multiplex and demultiplex packets to different output ports based on tag.</p>
<h2 id="tagger-apps.vlan.vlan">Tagger (apps.vlan.vlan)</h2>
<p>The <code>Tagger</code> app adds a VLAN tag, with the configured value and encapsulation, to packets received on its <code>input</code> port and transmits them on its <code>output</code> port.</p>
<h3 id="configuration-21">Configuration</h3>
<p>— Key <strong>encapsulation</strong></p>
<p><em>Optional</em>. The Ethertype to use as encapsulation for the VLAN. Permitted values are the strings <em>“dot1q”</em> and <em>“dot1ad”</em> or a number to select an arbitrary Ethertype. <em>“dot1q”</em> and <em>“dot1ad”</em> correspond to the Ethertypes 0x8100 and 0x88a8, respectively, according to the IEEE standards 802.1Q and 802.1ad.</p>
<p>If a number is given, it is truncated to 16 bits. This feature is intended to allow interoperation with vendors that do not use one of the standard encapsulations (a prominent example being the value 0x9100, which can still be found in practice for double-tagging instead of 0x88a8).</p>
<p>The default is <em>“dot1q”</em>.</p>
<p>— Key <strong>tag</strong></p>
<p><em>Required</em>. VLAN tag to add or remove from the packet. The value must be a number in the range 1-4094 (inclusive).</p>
<h2 id="untagger-apps.vlan.vlan">Untagger (apps.vlan.vlan)</h2>
<p>The <code>Untagger</code> app checks packets received on its <code>input</code> port for a VLAN tag, removes it if it matches with the configured VLAN tag and transmits them on its <code>output</code> port. Packets with other VLAN tags than the configured tag are dropped.</p>
<h3 id="configuration-22">Configuration</h3>
<p>— Key <strong>encapsulation</strong></p>
<p><em>Optional</em>. See above.</p>
<p>— Key <strong>tag</strong></p>
<p><em>Required</em>. VLAN tag to add or remove from the packet. The value must be a number in the range 1-4094 (inclusive).</p>
<h2 id="vlanmux-apps.vlan.vlan">VlanMux (apps.vlan.vlan)</h2>
<p>Despite the name, the <code>VlanMux</code> app can act both as a multiplexer, i.e. receive packets from multiple different input ports, add a VLAN tag and transmit them out onto one, as well as receiving packets from its <code>trunk</code> port and demultiplex it over many output ports based on the VLAN tag of the received packet. It supports the notion of a “native VLAN” by mapping untagged frames on the trunk port to a dedicated output port.</p>
<p>A packet received on its <code>trunk</code> input port must either be untagged or tagged with the encapsulation as specified with the <strong>encapsulation</strong> configuration option. Otherwise, the packet is dropped.</p>
<p>If the Ethernet frame is tagged, the VLAN ID is extracted and the packet is transmitted on the port named <code>vlan&lt;vid&gt;</code>, where <code>&lt;vid&gt;</code> is the decimal representation of the VLAN ID. If no such port exists, the packet is dropped.</p>
<p>If the Ethernet frame is untagged, it is transmitted on the port named <code>native</code> or dropped if no such port exists.</p>
<p>A packet received on a port named <code>vlan&lt;vid&gt;</code> is tagged with the VLAN ID <code>&lt;vid&gt;</code> according to the configured encapsulation and transmitted on the trunk port.</p>
<p>A packet received on the port named <code>native</code> is transmitted as is on the trunk port.</p>
<h3 id="configuration-23">Configuration</h3>
<p>— Key <strong>encapsulation</strong></p>
<p><em>Optional</em>. See above.</p>
<h1 id="bridge-apps">Bridge Apps</h1>
<p>A <code>bridge</code> app implements a basic Ethernet bridge with split-horizon semantics. It has an arbitrary number of ports. For each input port there must exist an output port with the same name. Each port name is a member of at most one <em>split-horizon group</em>. If it is not a member of a split-horizon group, the port is also called a <em>free port</em>. Packets arriving on a free input port may be forwarded to all other output ports. Packets arriving on an input port that belongs to a split-horizon group are never forwarded to any output port belonging to the same split-horizon group. There are two <code>bridge</code> implementations available: <code>apps.bridge.flooding</code> and apps.bridge.learning`.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="bridge" />
<p class="caption">bridge</p>
</div>
<h2 id="configuration-24">Configuration</h2>
<p>A <code>bridge</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>ports</strong></p>
<p><em>Optional</em>. An array of free port names. The default is no free ports.</p>
<p>— Key <strong>split_horizon_groups</strong></p>
<p><em>Optional</em>. A table mapping split-horizon groups to arrays of port names. The default is no split-horizon groups.</p>
<p>— Key <strong>config</strong></p>
<p><em>Optional</em>. The configuration of the actual bridge implementation.</p>
<h2 id="flooding-bridge-apps.bridge.flooding">Flooding bridge (apps.bridge.flooding)</h2>
<p>The flooding <code>bridge</code> app implements the simplest possible bridge, which floods a packet arriving on an input port to all output ports within its scope according to the split-horizon topology.</p>
<h3 id="configuration-25">Configuration</h3>
<p>The flooding <code>bridge</code> app ignores the <em>config</em> key of its configuration.</p>
<h2 id="learning-bridge-apps.bridge.learning">Learning bridge (apps.bridge.learning)</h2>
<p>The learning <code>bridge</code> app implements a <em>learning bridge</em> using a custom hash table to store the set of MAC source addresses of packets arriving on each input port. When a packet is received it is forwarded to all output ports whose corresponding input ports match the packet’s destination MAC address. When no input port matches, the packet is flooded to all output ports. Multicast MAC addresses are always flooded to all output ports associated with the input port. The scoping rules according to the split-horizon topology apply unchanged.</p>
<h3 id="configuration-26">Configuration</h3>
<p>The learning <code>bridge</code> app accepts a table as the value of the <em>config</em> key of its configuration. The following keys are defined:</p>
<p>— Key <strong>mac_table</strong></p>
<p><em>Optional</em>. This is a table that defines the characteristics of the MAC table. The following keys are defined</p>
<p>— Key <strong>size</strong></p>
<p><em>Optional</em>. The number of MAC addresses to be stored in the table. Default is 256. The size of the table is increased automatically if this limit is reached or if an overflow in one of the hash buckets occurs. This value is capped by <strong>resize_max</strong>.</p>
<p>— Key <strong>timeout</strong></p>
<p><em>Optional</em>. Timeout for learned MAC addresses in seconds. Default is 60.</p>
<p>— Key <strong>verbose</strong></p>
<p><em>Optional</em>. A boolean value. If true, statistics about table usage is logged during each timeout interval. Default is <code>false</code>.</p>
<p>— Key <strong>copy_on_resize</strong></p>
<p><em>Optional</em>. A boolean value. If true, the contents of the table is copied to the newly allocated table after a resize operation. Default is <code>true</code>.</p>
<p>— Key <strong>resize_max</strong></p>
<p><em>Optional</em>. An upper bound for the size of the table. Default is 65536.</p>
<h1 id="ipfix-and-netflow-apps">IPFIX and NetFlow apps</h1>
<h2 id="ipfix-apps.ipfix.ipfix">IPFIX (apps.ipfix.ipfix)</h2>
<p>The <code>IPFIX</code> app implements an RFC 7011 IPFIX “meter” and “exporter” that records the flows present in incoming traffic and sends exported UDP packets describing those flows to an external collector (not included). The exporter can produce output in either the standard RFC 7011 IPFIX format, or the older NetFlow v9 format from RFC 3954.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="IPFIX" />
<p class="caption">IPFIX</p>
</div>
<p>See the <code>snabb ipfix probe</code> command-line interface for a program built using this app.</p>
<h3 id="configuration-27">Configuration</h3>
<p>The <code>IPFIX</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>idle_timeout</strong></p>
<p><em>Optional</em>. Number of seconds after which a flow should be considered idle and available for expiry. The default is 300 seconds.</p>
<p>— Key <strong>active_timeout</strong></p>
<p><em>Optional</em>. Period at which an active, non-idle flow should produce export records. The default is 120 seconds.</p>
<p>— Key <strong>cache_size</strong></p>
<p><em>Optional</em>. Initial size of flow tables, in terms of number of flows. The default is 20000.</p>
<p>— Key <strong>template_refresh_interval</strong></p>
<p><em>Optional</em>. Period at which to send template records over UDP. The default is 600 seconds.</p>
<p>— Key <strong>ipfix_version</strong></p>
<p><em>Optional</em>. Version of IPFIX to export. 9 indicates legacy NetFlow v9; 10 indicates RFC 7011 IPFIX. The default is 10.</p>
<p>— Key <strong>mtu</strong></p>
<p><em>Optional</em>. MTU for exported UDP packets. The default is 512.</p>
<p>— Key <strong>observation_domain</strong></p>
<p><em>Optional</em>. Observation domain tag to attach to all exported packets. The default is 256.</p>
<p>— Key <strong>exporter_ip</strong></p>
<p><em>Required</em>, sadly. The IPv4 address from which to send exported UDP packets.</p>
<p>— Key <strong>collector_ip</strong></p>
<p><em>Required</em>. The IPv4 address to which to send exported UDP packets.</p>
<p>— Key <strong>collector_port</strong></p>
<p><em>Required</em>. The port on which the collector is listening for UDP packets.</p>
<p>— Key <strong>templates</strong></p>
<p><em>Optional</em>. The templates for flows being collected. See the source code for more information.</p>
<h3 id="to-do-list">To-do list</h3>
<p>Some ideas for things to hack on are below.</p>
<h4 id="limit-the-number-of-flows">Limit the number of flows</h4>
<p>As it is, if an attacker can create millions of flows, then our flow set will expand to match (and never shrink). Perhaps we should cap the total size of the flow table.</p>
<h4 id="look-up-multiple-keys-in-parallel">Look up multiple keys in parallel</h4>
<p>For large ctables, we can only do 7 or 8 million lookups per second if we look up one key after another. However if we do lookups in parallel, then we can get 15 million or so, which would allow us to reach 10Gbps line rate on 64-byte packets.</p>
<h4 id="yang-schema-to-define-ipfix-app-configuration">YANG schema to define IPFIX app configuration</h4>
<p>We should try to model the configuration of the IPFIX app with a YANG schema. See RFC 6728 for some inspiration.</p>
<h4 id="use-special-purpose-internal-links">Use special-purpose internal links</h4>
<p>The links that we use as internal buffers between parts of the IPFIX app have some overhead as they have to update counters. Perhaps we should use a special-purpose data structure.</p>
<h4 id="use-a-monotonic-timer">Use a monotonic timer</h4>
<p>Currently internal flow start and end times use UNIX time. This isn’t great for timers, but it does match what’s specified in RFC 7011. Could we switch to monotonic time?</p>
<h4 id="allow-export-to-ipv6-collectors">Allow export to IPv6 collectors</h4>
<p>We can collect IPv6 flows of course, but we only export to collectors over IPv4 for the moment.</p>
<h4 id="allow-packets-to-count-towards-multiple-templates">Allow packets to count towards multiple templates</h4>
<p>Right now, routing a packet towards a flow set means no other flow set can measure that packet. Perhaps this should change.</p>
<h1 id="ipsec-apps">IPsec Apps</h1>
<h2 id="aes128gcm-apps.ipsec.esp">AES128gcm (apps.ipsec.esp)</h2>
<p>The <code>AES128gcm</code> implements ESP in transport mode using the AES-GCM-128 cipher. It encrypts packets received on its <code>decapsulated</code> port and transmits them on its <code>encapsulated</code> port, and vice-versa. Packets arriving on the <code>decapsulated</code> port must have an IPv6 header, and packets arriving on the <code>encapsulated</code> port must have an IPv6 header followed by an ESP header, otherwise they will be discarded.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="AES128gcm" />
<p class="caption">AES128gcm</p>
</div>
<p>References:</p>
<ul>
<li><code>lib.ipsec.esp</code></li>
</ul>
<h3 id="configuration-28">Configuration</h3>
<p>The <code>AES128gcm</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>spi</strong></p>
<p><em>Required</em>. A 32 bit integer denoting the “Security Parameters Index” as specified in RFC 4303.</p>
<p>— Key <strong>transmit_key</strong></p>
<p><em>Required</em>. Hexadecimal string of 32 digits (two digits for each byte) that denotes a 128-bit AES key as specified in RFC 4106 used for the encryption of outgoing packets.</p>
<p>— Key <strong>transmit_salt</strong></p>
<p><em>Required</em>. Hexadecimal string of eight digits (two digits for each byte) that denotes four bytes of salt as specified in RFC 4106 used for the encryption of outgoing packets.</p>
<p>— Key <strong>receive_key</strong></p>
<p><em>Required</em>. Hexadecimal string of 32 digits (two digits for each byte) that denotes a 128-bit AES key as specified in RFC 4106 used for the decryption of incoming packets.</p>
<p>— Key <strong>receive_salt</strong></p>
<p><em>Required</em>. Hexadecimal string of eight digits (two digits for each byte) that denotes four bytes of salt as specified in RFC 4106 used for the decryption of incoming packets.</p>
<p>— Key <strong>receive_window</strong></p>
<p><em>Optional</em>. Minimum width of the window in which out of order packets are accepted as specified in RFC 4303. The default is 128.</p>
<p>— Key <strong>resync_threshold</strong></p>
<p><em>Optional</em>. Number of consecutive packets allowed to fail decapsulation before attempting “Re-synchronization” as specified in RFC 4303. The default is 1024.</p>
<p>— Key <strong>resync_attempts</strong></p>
<p><em>Optional</em>. Number of attempts to re-synchronize a packet that triggered “Re-synchronization” as specified in RFC 4303. The default is 8.</p>
<p>— Key <strong>auditing</strong></p>
<p><em>Optional.</em> A boolean value indicating whether to enable or disable “Auditing” as specified in RFC 4303. The default is <code>nil</code> (no auditing).</p>
<h1 id="test-apps">Test Apps</h1>
<h2 id="match-apps.test.match">Match (apps.test.match)</h2>
<p>The <code>Match</code> app compares packets received on its input port <code>rx</code> with those received on the reference input port <code>comparator</code>, and reports mismatches as well as packets from <code>comparator</code> that were not matched.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Match" />
<p class="caption">Match</p>
</div>
<p>— Method <strong>Match:errors</strong></p>
<p>Returns the recorded errors as an array of strings.</p>
<h3 id="configuration-29">Configuration</h3>
<p>The <code>Match</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>fuzzy</strong></p>
<p><em>Optional.</em> If this key is <code>true</code> packets from <code>rx</code> that do not match the next packet from <code>comparator</code> are ignored. The default is <code>false</code>.</p>
<p>— Key <strong>modest</strong></p>
<p><em>Optional.</em> If this key is <code>true</code> unmatched packets from <code>comparator</code> are ignored if at least one packet from ´rx´ was successfully matched. The default is <code>false</code>.</p>
<h2 id="synth-apps.test.synth">Synth (apps.test.synth)</h2>
<p>The <code>Synth</code> app generates synthetic packets with Ethernet headers and alternating payload sizes. On each breath it fills each attached output link with new packets.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Synth" />
<p class="caption">Synth</p>
</div>
<h3 id="configuration-30">Configuration</h3>
<p>The <code>Synth</code> app accepts a table as its configuration argument. The following keys are defined:</p>
<p>— Key <strong>src</strong></p>
<p>— Key <strong>dst</strong></p>
<p>Source and destination MAC addresses in human readable from. The default is <code>&quot;00:00:00:00:00:00&quot;</code>.</p>
<p>— Key <strong>sizes</strong></p>
<p>An array of numbers designating the packet payload sizes. The default is <code>{64}</code>.</p>
<h1 id="snabbwall-apps">SnabbWall Apps</h1>
<h2 id="l7spy-apps.wall.l7spy">L7Spy (apps.wall.l7spy)</h2>
<div class="figure">
<img src="data:image/png;base64,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" alt="L7Spy" />
<p class="caption">L7Spy</p>
</div>
<p>The <code>L7Spy</code> app is a Snabb app that scans packets passing through it using an instance of the <code>Scanner</code> class. The scanner instance may be shared among several <code>L7Spy</code> instances or with a <code>L7Fw</code> app for filtering.</p>
<p>— Method <strong>L7Spy:new</strong> <em>config</em></p>
<p>Construct a new <code>L7Spy</code> app instance based on a given configuration table. The table may contain the following key:</p>
<ul>
<li><code>scanner</code> (optional): Either a string identifying the kind of scanner to construct (currently only <code>&quot;ndpi&quot;</code> is accepted) or an existing scanner instance.</li>
</ul>
<h2 id="filter-apps.wall.filter">Filter (apps.wall.filter)</h2>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAACMCAIAAADKnPgGAAAL+ElEQVR42u2dW0hUXRuAO3iopt8OVlhOWReFlpWd8CbIMtQkKmougrqIvBA60Bm6KL6IjggdJDtphh2sKDqaVooXGc1PRaGUYmUny+w0mWaWOt/3v7j4NsNk5p/OzJ7t81xIa83aM/mudz2uvffaazr9AwBgCDoRAgBAZwAAutTZ3wAAXgg6AwB0BgCAzgAA0BkAADoDAHQGAIDOAADQGQAAOgMAdIbOAACdAQCgMwAAdAYAgM4AAJ0BAKAzAAB0BgCAzgAAnQEAoDMAAHQGAIDOAACdoTMAQGcAAOgMAACdAQCgMwBAZwAA6AwAAJ0BAKAzAEBn4P2EhoZ2AtcjcSbZ0Bm4Fhlp/4DrkThXV1d//fq1rq7ux48fjY2N5B46A3TmrTorLy9/9+6dzWYTqYnRyD10BujMW3X26NGjsrKyN2/eiNG+fftG7qEzQGfeqrPbt28XFhaK0SorK2tqasg9dAbozFt1lpOTI0Z7+PDhq1evqqqqyD10BujMW3V25syZGzdu3L179+nTp58+fSL30JnniY6OltQMCQlx2yfm5+f/1YTNZkNn3quzU6dOXbt27c6dO0+ePHGbzlyUPC7NSXRmZJ1J0qi1S8+ePUNn6EwPyePSnERn7sNqtV6+fDkvLw+dATpDZ4aanWnF69evjx8/vlu3buHh4ZK1P7cXCY4ZM8bPzy80NPTSpUtag1GjRkmDiIgIVZR0V4mSnJwsxQkTJjitL5f26KxD6Sw7O3vq1KkBAQH+/v4jR47ctm1bfX19W5JH5zmJzjysM8mzrl27istU75pMpg8fPvzcwGw2+/j4SFF+3rt3zzF1xo0bh87Q2c+kpqZ27tzZKQdmz57dluTReU6iMw/rTNi4caPdbt+1a5cqHjt2zKlBSkqKFB88eKCyZ9asWY6pIynSbOpwstmRdVZTU9OrVy85duDAgXJgRUVFbGysSgaZsv1x8ug8J9GZh3Xm6+tbW1srxeLiYtXNW7dudWwgE7eGhgZVExUVJTWBgYHoDJ21TG5urur6DRs2aJduVc2qVavaqDPd5iQ687DOZMauimVlZaqbpb8dG8hfV+0dLBaLalNXV/dz6mj5is7QmRyiuv7gwYOqpry8XNUsXLjwj5NH5zmJzjx/K0AVpXeb1ZlM5qurq1WNuvSg/SUcP36849UHLYPRGTprYXa2cuXKP04eneckOtO7zoQlS5a8fv06LS1NFbXrFPIPKfr5+T1//lzSKzIy0il19uzZo2qysrLQWYe9dnb37t2Kioq4uDiVDFevXv3j5NF5TqIzvevsP01od4K6du2q3UXKyMhQlfLX0t/fv3v37k6pc+vWLce7SImJieis49zZPHTo0M+bQc6cOdNut/9x8ug8J9GZ3nUmDeQ0YdKkSZIcoaGhFy9e1N6wsbFx48aNgwYNMplMFovl/PnzTqkjbN682Ww2qxv26KyjrTu7cuXKlClTevbsqRaIbdmyRdsu7c+SR+c5ic68Rn96A50Z+6kAb8xJdIbO0Bk6Q2fozHCps3bt2tZvdorODKYz6X3tESh0hs68HvW03f3799FZB9SZ6v2ioiIGAjoziM7Umu+kpCS96Wzs2LHyiQsWLHCsfP78ebNf5tbQ0KAd4khkZCQ6+23v7969m7GAzgyiM0VUVNSrV6+abXb27Nm4uDiTyTR//vySkhIP6qyysjLWgUGDBkkb+akyTx3Sr1+/yH9JSEjwIpGdO3dOxXny5Mmpqanu0Zli+vTpv+p9dIbOvE9nQu/evWVe4NRm2bJl4eHhMtIePHhgsViCgoLevn3rKZ05UldXJ/8ZabNr166WD0lJSZH6SZMmyb9tNlvnJt6/fy9FtewzOTnZ4y5zjPPcuXMDAwNzcnLcpjPV+/J3i0GBzgyiM4VMwbR9kI8fPx4REVFTU+M46jZt2qQHne3bt0/NxWprax0PcZydKU89fvxYLf6srq6+cOGC+jVl6MrvpfaHcNuU81ecOHHCKc5LlixJTEx0p860Bzy9cRdsdAbNJ7R6Tj4/P18ayBgrKChwHHhWq3XixIke11l9ff2QIUPUfiROhziyZs0a9VJISIj6hqQVK1b0799flLd06dJr165JZXBwsMenZs3GWSZr7teZMHToUNX7gM7aAbUHiweR846jR4+qjFdX2R0vxovsPK6z9PR0ebVXr15VVVWtOSQhIUFeWr9+vbSZN2+enM2NHDlSilK5aNEiPVz+/znOPXr08Ejv9+zZU/U+oDOvn52JTLXND2TWIFMYx2GWlpbm8dmZ3W4fMWKE2j2ilYeonR7CwsK6dOmS3IQU1ZvIiZ4eZmdOcU5NTRXhun92NnnyZG/c+gKdgXNC+/j4JCUlOS6tvHDhQlBQkCjs8+fP0pUlJSUy8Pbt2+c2nTleCIuNjVUvnT59WtuXvJU6k5baxtOFhYVFRUXab11ZWelxnV28eNExzsXFxaGhoevWrXOnzqT3t2/f/tuFtegMvEBn4eHhza6nvX379pw5c+T0U9rIkNuxY4fTaZFLdeZIYGCgSqcxY8ZIcfXq1f/X+em4cePk1b59+6rfq3///lIcPXq0TlZpWK1WLc59+vRZvHix1LhNZ2LPVq6mRmegd52tXLnyt0878VSAIZfRCsuWLWv9s27oDPSrM7PZnJub28rGuMZgOpPez8nJYSCgMyNgsVhav8gInRlMZ9L779+/ZxSgsw46lcM1RtJZa3bUQGfoDJ2Bd5xssqMGOkNnYJxbAeyogc7QGbQ/7KiBzgCdGQF21EBngM6MADtqoDNAZwaBHTXQGaAz41z+Z0cNdAbozCCzM3bUQGeAzowAO2qgM0BnxoEdNdAZoDOW0bZVZ+yogc7QGXi9zthRA52hMzCCzthRA52hMzCIzpyIjo6Wjw4JCWnj++Tn5//VhAGW46IzdAYdWmciMnVJzgALPtAZOgM96uy3F/utVuvly5fz8vLQGTpDZ6AjnWlTLdFTRESEj49PZmam1GdnZ0+bNi0gIMDf33/06NEHDhxoYXbWQmN1UhkfH9+3b18/Pz85avny5VI5YcIEp+Vso0aNQmeAztBZW3VmMpm6d++utHLixIm0tDT17XxS2adPH+2L4pvVWcuNMzIytC/6UwQHB6MzQGfgKp0JcXFxpaWlZWVlJSUlao1uTEzM169f7Xb7ihUrpNilS5enT5866aympqaFxlKjBCemO3nypM1mKy4u3r59OyebgM7AVTqTCdTr169VjZx1KsuEhYVFN6G+eFQ4cuSIk85abqy9Ko7j2hmgM3CHzgYMGKDVyHv+aguNpKQkJ5213Fh7NSUlBZ0BOgM33QrQanJzc5Vl9u7d+9tDWm7M7AzQGXhSZ9rlsGHDhqmLZfX19SKm+Pj4z58//+raWbONHa+dZWZmSk1paenOnTvVB+3Zs0fpLCsrC50BOkNn7a8zIT09Xd2OlJ9BQUHaTU+1fN/pkJYb/+rOpnDr1i3H+sTERHQG6AydtbPOhBs3bsTExMjMy8/Pb/DgwTNmzNi/f39DQ4O8FBUVJYcMHz68NY3/blp3JjUyTfP19dXWnSk2b95sNpuV79AZoDN05taHnOrq6mR6JR8tHiTV0Rk6A2/VWXJysrZQ9vDhw6Q6OkNn4K06U/ci5XRS/qGdSwI6Q2fglSebgM7QGaAzdAboDNAZOgN0hs4AnQE6Q2eAzgCdoTN0hs4MQ1BQUCdwPQEBAegMnYHLqaqqevnyZVFRUUFBQVZW1klwDRJbibDEWaItMSfx0Bm0P9XV1RUVFY8fP75///7NmzezwTVIbCXCEmeJtsScxENn0P7U1tZ+/PixvLxcRlphYeF/wTVIbCXCEmeJtsScxENn0P58//5dJgsyxmTW8OLFi1JwDRJbibDEWaItMSfx0Bm0Pw0NDTK6ZL7w5csXm832AVyDxFYiLHGWaPMQJToDF2L/l0ZwDVqESTZ0BgCAzgAA0BkAoDMAAHQGAIDOAADQGQCgMwAAdAYAgM4AANAZAKAzdAYA6AwAAJ0BAKAzAAB0BgDoDAAAnQEAoDMAAHQGAOgMAACdAQCgMwAAdAYAgM4AwLg6AwDwatAZAKAzAAA98T8Dr5AM8Il40QAAAABJRU5ErkJggg==" alt="L7Fw" />
<p class="caption">L7Fw</p>
</div>
<p>The <code>L7Fw</code> app implements a stateful firewall by querying the scanner state collected by a <code>L7Spy</code> app. It then filters packets based on a given set of rules.</p>
<p>— Method <strong>L7Fw:new</strong> <em>config</em></p>
<p>Construct a new <code>L7Fw</code> app instance based on a given configuration table. The table may contain the following keys:</p>
<ul>
<li><code>scanner</code>: A <code>Scanner</code> instance shared with an <code>L7Spy</code> instance. The metadata in this scanner is used for packet filtering.</li>
<li><code>rules</code>: A table mapping protocol names (as strings) to firewall actions. The accepted actions are <code>&quot;accept&quot;</code>, <code>&quot;reject&quot;</code>, <code>&quot;drop&quot;</code>, or a pfmatch expression. The pfmatch expression may use the variable <code>flow_count</code> (as an arithmetic expression) to refer to the number of packets in a given protocol flow, and may call the <code>accept</code>, <code>reject</code>, or <code>drop</code> methods.</li>
<li><code>local_ipv4</code> (optional): An IPv4 address that identifies the host running the firewall. This is used as the source address in ICMPv4 or TCP reject responses.</li>
<li><code>local_ipv6</code> (optional): An IPv6 address that identifies the host running the firewall. This is used as the source address in ICMPv6 or TCP reject responses.</li>
<li><code>local_macaddr</code> (optional): A MAC address that identifies the host running the firewall. This is used for the source address in ethernet frames for reject responses.</li>
<li><code>logging</code> (optional): A log level parameter that can be set to “on” or “off”. When set to “on”, it will report dropped/rejected packets to the system log.</li>
</ul>
<h2 id="scanner-apps.wall.scanner">Scanner (apps.wall.scanner)</h2>
<p><code>Scanner</code> objects are responsible for:</p>
<ul>
<li>Identifying traffic flows.</li>
<li>Analyzing the contents of packet to determine which application they belong to.</li>
<li>Keeping enough state to be able to enumerate the identified traffic flows, and identify the application they belong to.</li>
</ul>
<p>The class is not meant to be instantiated directly, but to be used as the basis for concrete implementations (e.g. <code>NdpiScanner</code>). It provides one function that subclasses can use:</p>
<ul>
<li>Method <strong>Scanner:extract_packet_info</strong> <em>packet</em></li>
</ul>
<p>Extracts fields from the headers of an IPv4 or IPv6 <em>packet</em>. The returned values are:</p>
<ol style="list-style-type: decimal">
<li>A <em>key</em> object (more on this below) which uniquely identifies a traffic flow.</li>
<li>The <em>offset</em> to the packet payload content.</li>
<li>The <em>source_address</em> of the packet, as an array of bytes.</li>
<li>The <em>source_port</em>, for UDP and TCP packets.</li>
<li>The <em>destination_address</em> of the packet, as an array of bytes.</li>
<li>The <em>destination_port</em>, for UDP and TCP packets.</li>
</ol>
<p>Key objects contain some of the returned information in a compact FFI representation, and can be used as an aid to uniquely identify a flow of packets. The provide the following attributes:</p>
<ul>
<li><code>:eth_type()</code>: Method which returns the type of the Ethernet frame payload, either <code>ETH_TYPE_IPv4</code> or <code>ETH_TYPE_IPv6</code>.</li>
<li><code>:hash()</code>: Method which returns an integer calculated by hashing all the other values in the key object.</li>
<li><code>.vlan_id</code>: VLAN identifier. Zero for no VLAN tags.</li>
<li><code>.ip_proto</code>: The IP protocol.</li>
<li><code>.lo_addr</code> and <code>.hi_addr</code>: IP addresses (either v4 or v6).</li>
<li><code>.lo_port</code> and <code>.hi_port</code>: For TCP and UDP, the ports as big-endian (network) integers.</li>
</ul>
<p>This method can be very useful to implement scanners using backends which do not implement their own flow classification.</p>
<h3 id="subclassing">Subclassing</h3>
<p>All the <code>Scanner</code> implementations conform to the <code>Scanner</code> base API.</p>
<p>— Method <strong>Scanner:scan_packet</strong> <em>packet</em>, <em>time</em></p>
<p>Scans a <em>packet</em>.</p>
<p>The <em>time</em> parameter is used to know at which time (in seconds from the Epoch) <em>packet</em> has been received for processing. A suitable value can be obtained using <code>engine.now()</code>.</p>
<p>— Method <strong>Scanner:get_flow</strong> <em>packet</em></p>
<p>Obtains the traffic flow for a given <em>packet</em>. If the packet is determined to not match any of the detected flows, <code>nil</code> is returned. The returned flow object has at least the following fields:</p>
<ul>
<li><code>protocol</code>: The L7 protocol for the flow. A user-visible string can be obtained by passing this value to <code>Scanner:protocol_name()</code>.</li>
<li><code>packets</code>: Number of packets scanned which belong to the traffic flow.</li>
<li><code>last_seen</code>: Last time (in seconds from the Epoch) at which a packet belonging to the flow has been scanned.</li>
</ul>
<p>— Method <strong>Scanner:flows</strong></p>
<p>Returns an iterator over all the traffic flows detected by the scanner. The returned value is suitable to be used in a <code>for</code>-loop:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">for</span> flow <span class="kw">in</span> my_scanner:flows<span class="ot">()</span> <span class="kw">do</span>
   <span class="co">-- Do something with &quot;flow&quot;.</span>
<span class="kw">end</span></code></pre></div>
<p>— Method <strong>Scanner:protocol_name</strong> <em>protocol</em></p>
<p>Given a <em>protocol</em> identifier, returns a user-friendly name as a string. Typically the <em>protocol</em> is obtained flow objects returned by <code>Scanner:get_flow()</code>.</p>
<h3 id="ndpiscanner-apps.wall.scanner.ndpi">NdpiScanner (apps.wall.scanner.ndpi)</h3>
<p><code>NdpiScanner</code> uses the <a href="http://www.ntop.org/products/deep-packet-inspection/ndpi/">nDPI</a> library (via the <a href="https://github.com/aperezdc/ljndpi">ljndpi</a> FFI binding) to scan packets and determine L7 traffic flows. The nDPI library (<code>libndpi.so</code>) must be available in the host system. Versions 1.7 and 1.8 are supported.</p>
<p>— Method <strong>NdpiScanner:new</strong> <em>ticks_per_second</em></p>
<p>Creates a new scanner, with a <em>ticks_per_second</em> resolution.</p>
<h2 id="utilities">Utilities</h2>
<p>The <code>apps.wall.util</code> module contains miscellaneous utilities.</p>
<p>— Function <strong>util.ipv4_addr_cmp</strong> <em>a</em>, <em>b</em></p>
<p>Compares two IPv4 addresses <em>a</em> and <em>b</em>. The returned value follows the same convention as for <code>C.memcmp()</code>: zero if both addresses are equal, or an integer value with the same sign as the sign of the difference between the first pair of bytes that differ in <em>a</em> and <em>b</em>.</p>
<p>— Function <strong>util.ipv6_addr_cmp</strong> <em>a</em>, <em>b</em></p>
<p>Compares two IPv6 addresses <em>a</em> and <em>b</em>. The returned value follows the same convention as for <code>C.memcmp()</code>: zero if both addresses are equal, or an integer value with the same sign as the sign of the difference between the first pair of bytes that differ in <em>a</em> and <em>b</em>.</p>
<h3 id="southandnorth-apps.wall.util">SouthAndNorth (apps.wall.util)</h3>
<p>The <code>SouthAndNorth</code> application is not to mean to be used directly, but rather as a building block for more complex applications which need two duplex ports (<code>south</code> and <code>north</code>) which forward packets between them, optionally doing some intermediate processing.</p>
<p>Packets arriving to the <code>north</code> port are passed to the <code>:on_southbound_packet()</code> method —which can be overriden in a subclass—, and forwarded to the <code>south</code> port. Conversely, packets arriving to the <code>south</code> port are passed to <code>:on_northbound_packet()</code> method, and finally forwarded to the <code>north</code> port.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAACMCAIAAABgXz66AAAPzklEQVR42u2dfUxV5R/ADXkReSl6ISRatloRukJwsxpT0DZZE2xKr9PVWpPW/AMarrZkGQnm2MKyTMRWob/K2copgopSQxKLIrkWTQpUUDQkVBB8Qfr9vvPZ79nZuZd7L3CFc2+fzx+M55znnnvPeZ7nc7/nPOd877j/AgDACBjHIQAAQKMAABbQ6D8AAOA2aBQAAI0CAKBRAAA0CgCARtEoAAAaBQBAowAAaBQAAI0CAAAaBQBAowAAaBQAAI0CAAAaBQBAowAAaBQAAI0CAAAaBQBAowAAaBQAAI0CAKBRNAoAgEYBANAoAAAaBQBAowAAgEYBANAoAAAaBQBAowAAgEYBANAoDIXY2Nhx4LtI+9LJ0ShcX2Sk/Rd8F2nf7u7uCxcuXLx48fLly1evXqXPo1FAozA0jba1tf31119dXV0iUzEpfR6NAhqFoWn0t99+a25uPnnypJi0r6+PPo9GAY3C0DR64MCBhoYGMenp06d7enro82gU0CgMTaMVFRVi0l9//bW1tfXcuXP0eTQKaBSGptEtW7bs2bOnrq7uzz///Pvvv+nzaNTXqKqqevMaXV1deuGcOXOk9991111oFEau0S+++GLXrl0//vjjH3/8gUbRqA8iAlX397W0tKBRQKNoFIZGX18fGgU0ikb/RWi77d69OyEhYcKECVOnTpUOaqxTXl6ekpISHh4eFBQUFxdXUFBw5coV08v37t0bHx/v7+9/9913m545mTJlirFmfX19UlJScHCw/RuhUUCjaNRbNSp+HD9+vDhUiS8kJOTMmTOqQklJyQ033GAy4/z5840vl/qiRbXKuUbDwsJuvPFGvcr4RmgU0Cga9WKNCrm5uQMDA++++64qlpaWytqenh5lvUmTJkmXbW9vnzt3rqogIarx5ampqUeOHGlubj5+/LiTk3ph4cKFEpAuWbLE+EZoFNAoGvVujQYEBPT29kqxsbFR2S0/P1+KlZWVqrh8+XJVv7a2Vi3Jzs7WL5dw9cSJE+5MMfn5+anw02azGd8IjQIaRaPerdGYmBhVlHBS2U1UKEXprKq4fv16VaGtrU0tWbRokX55ZGSkcZtONCpRrcM3QqOARtGo108xqaKIz2g3J9FoVlbWP4PMv7szU296IzQKaBSN+qZGjddG6+rq2tvbU1NTVYWdO3cOptE1a9aoOmVlZWgU0Cga/VdrVCguLrbPmztv3ryBgYHBNFpTU2OsnJmZiUYBjaLRf69GhR07dsyaNSs0NDQwMDA2NnblypU6w+NgN9Xn5eXFxMSoO6XQKKBRNApeBhpFo4BGAY0CGkWj4FFycnLcT3I+Eo3u3bt39uzZkZGREyZMuPPOO+fMmfPGG294avx/++23KvfV2bNn9UJ9ucP5a7u6ugICAtSVkGeffXaEn+T3339Xm3r77bfVkueff14tefTRR3U1fdPF4cOHx2Svx1aj0uv0c8+ARn0hwIyPj6+vr7+uGt26dav9fNr48eM9pVFtpaNHjw5VKB9//LH+SKGhofKlcp00Koj4PKjRkez12GpU9TqbzcYARKM+olFBIsTCwsLrp9GHH35YXhsREbF58+aDBw9u27YtNzf3vvvus4JG9WO4iq+++ur6aVQ+kqc0evHiRa/WqOp1RUVFjEE06iMaVSQnJ7e2tjqsJuFkampqSEjIM888I6YY6viMjo5Wt3M5qVNRUWHMd7Vq1ar+/n61asqUKSp+UcW6ujr1gdeuXSvFxMRE+6QtRqH88ssvOvfV7t27jW/a2dnp7+8v1TIyMlQGmaeeespYQW9kz549OlOXcSNycN56662oqCg5OE8//XR1dfVgGpXoW/7Kt8hgGnVyBPTH2Ldvn5OMX27utT3y5aHaV15SUlIyOhpVPPbYY4P1OjSKRr1Po8JNN90k8YipztKlS2UoykiTkSm6EWWcOnVqSBp95JFHlEcWL168adMmGaKmChs3bnSY78qo0WnTpg1Do/a5r0Sd+n03bNigg9DHH39c/pk4cWJvb69Jo/aZuvRGVq9ebXzrO+64YzCNPvfcc/I3LS3NoUadHwE3M365udcmjO27YMGCW265RYQ+ahpVvU6+pxmMaNRHNKqQkFP/TolYT8Kfnp4e46hbsWLFkDT6zTff+Pn5Gd/i/vvv37Jli1p74cIF4zNd4mh9oi3jWWtUdOlQo85P6lXuKxGEzn0le6TrSCikLCk7+NFHH6kK+oMZN5KbmytHQ05CjRsR4d58881SvO2222pqakQ906dPH0yjNptNRb6HDh0yadTlETBm/GpqamppaZEIbth7bWTz5s2m9n3llVcyMzNHU6M6m4Tx13HQKBr1bo2qpCpVVVVSQcbY/v37jQOvtrZWZDHU83o5201PT9cBneK7775Tk/g6w4CqLGe+Ot/VCDUq+laBmAhL1SkoKFAVOjo61Im2uEmKJ06c0AIybSQgIEBNPelLn2ojP//8syouW7ZMf2EMplFRlQTj6rqBSaMuj4DO+HXy5El3rgg72WsTDttXgtPR16gwefJk1esAjXqA5OTkcWOKnGd98sknqsfrK3QKGbQi2WFPjMg4ycjI0M+zysIvv/xSFYuLi1U1bTSJUOw1qhXjjkYlvlNF4/NdaokOP1977bXD17j33nulKCfOOjrTmbocbqSsrEwVP/zwQ1VBIk0nGhUL+11D4n2jRl0eAZ3xy82JNSd7bT+tZN++EydOHJNeFxoaqnodoFGvj0ZF4jqJlEQru3btMl3HHGo0Klsz3appjPucxGJZWVlSTEhI0Nf+jNLRGl2xYoXLOWtZZRJKSkrKYOP5888/d2cjOhrNy8tTFfbt2+dEo1J88skn9XSTO9GoOgIO59+Ht9f20aipfUtKSuLi4kY/Gk1KSjKmLkOjaNRbNerv719YWGi8NVrOUqOiokSd6h5viadk4H3wwQdD0qicJM6ePXvdunU113jppZd0GGi6MvjTTz+dOnVK57sqLy+XCunp6fJ/YGDgsWPHREYzZswwafS9997T+bHcFMrp06dNl2uNPPHEE+5sRM701bXRBx54oLu7Ww6XnLA716iEq8apJPtrow6PgEONDmOv7dm2bZuxfRsbG2NjY5ctWzaaGpVet2rVKm7IR6O+oFGRncP78A8cOCBakdN8qSND7p133jGdBrpEnZWbCAsLa25uNs2Ym/Jdqf5UWlqqx1tQUJCerdYa/f777025r1wKRb4JVFFkZPyoDz74oJp0On/+vDtW0jP14kGRoP5sg2lUSEtLM2nU5RFwqNFh7LVDamtrdftGRES8+OKLsmTUNCrWdvPpDzQKVteonDy6fCp02LffSwSanZ2dmJgYGRkpKpS/CxYsaGhoMNYpKysz5rvKz8+X8EStGhgYyM3NjY6ODgkJycjI0NM4WqOCaMuY+8qlUGbOnKlOriUsNX4MCYuMU9surSSHRU6uZY9EoBJCbt++3aVGf/jhB3uNOj8Cg91UP9S9ttTt98LSpUvdfxYZjYJ1NSrjsLKy0s3K5O8gNYmnel1FRQUDEI36AhLcuX+zHhpFo57qdR0dHYw+NDpKiONeeOEF64SuuAaNdnd3W6dPolFwQVVV1eTJk6Vzo1GwiEarq6st1SfRKAzKlStXcnJy1LODaBSsoFHpk6+//rrV+iQaBcfYbLb4+HjjTSFj/pFGmOEJLI7LDE+NjY1W65NoFAalqKjI9OD5mHfZkWd4AivjMsPT2rVrrdYn0Sg4prW1VSUcsmcMP5VHMjyBZXGe4Un6pH6eCo2iUasjZ83qMRKrdVlPZXgCa+Ikw9Onn3566623WrBPolFwTGFhof15k0XwYIYnsOC0kn37RkVFiUbz8vL0hNJ1JTk5GQOgUc9QX19vuopvkWh05BmewMrRqJMMT9InJTIlGkWj3kRfX19OTo6luqxHMjyBZXGZ4Un6ZFZWFhpFo15GVVWVnDVbp8uOPMMTWBl3MjxVVlZaqk+iUXBNV1eXTpDO7fcwatdJndx+L31S/2wBGkWjXoP0aRUjoFEYc40qNm3aZKk+iUbBNa2trdaZx0SjaFRoaWlhbh2NAhqF4WvUOlMIb17DmOlRZ61Go4BGAY26QP8wqvGH8NAooFFAo2gUjaJRQKMGDh06lJaWdvvttwcGBsrfmTNnbtiwQa8tLy9PSUkJDw8PCgqKi4srKCjQvw+qfgYxPj5eFeUjKWm+//77UkxMTDTdxyr1jRqtr69PSkoKDg6eOnWq7BEaBTQKXqnRS5cuRUVFqZ90nTRpknq0dOHChWptSUmJ8bemFfPnzzdqdNq0acPQaFhYmPrBakVISMiZM2fQKKBR8D6NHj58WIlMNijF/v7+gwcPbt26Vf7v6elRphO9ytr29va5c+eqyhKiao2KLh1q1PlJvZK1BKRLlixRxdLSUjQKaBS8T6MdHR1+fn6y2YSEhFdffXXjxo1NTU1qVWVlpRLc8uXL1ZLa2lq1JDs7e4QalTdV4afNZlN18vPz0SigUfDKa6OrV68ODAw0nn2LT/+59miJKq5fv17VbGtrU0sWLVpkr1EtWXc0KhGuKjY3N6s6UhmNAhoFb52p7+zs3L59u/h0+vTpSmpyCu8kGs3KypKiBLD6iqdRu+5oVM/Uyyo0CmgUvFijZ8+eLSoqEmmq4rp165TUGhsbjddG6+rqpI5Os79z506pnJ6eLv9LJHv06NHu7u4ZM2aYNLpmzRq1pKysDI0CGgXf1KjIUVksNDRUTdkL99xzz9WrV2VtcXGxff69efPmDQwMyNrPPvtMLfH39w8KCgoODjZptKamxvjCzMxMNApoFHxNoxJyvvzyyw899FBERITElTExMYsXL25ubtYVduzYMWvWLJGsrI2NjV25cuXly5fVKlFtbm5udHR0SEhIRkbG119/bdKokJeXJ9tUd02hUUCj4LPXRgGNAhpFo4BGAY0CGkWjgEYBjaJRQKOARgGNolFAo4BGAY0CGkWjgEYBjaJRQKOARgGN/tvQz/OBTxIeHo5G0Shcd86dO3f8+HGbzbZ///6ysrL/gG8hbSotK+0rrSxtTYdHo+B5uru729vbm5qa6uvrq6ury8G3kDaVlpX2lVaWtqbDo1HwPL29vZ2dnW1tbTLSGhoaDoJvIW0qLSvtK60sbU2HR6PgeS5duiRBiowxiVaOHTt2BHwLaVNpWWlfaWVpazo8GgXP09/fL6NL4pTz5893dXWdAd9C2lRaVtpXWlnamg6PRuF6MfB/roJvoVuWTo5GAQDQKAAAGkWjAABoFAAAjQIAoFEAADQKAABoFAAAjQIAoFEAADQKAABoFAAAjQIAoFEAADQKAABoFAAAjQIAoFEAADQKAIBG0SgAABoFAECjAABoFAAAjXJQAADQKADA2GkUAACGARoFAECjAABjx/8AMMDXhuj6VvoAAAAASUVORK5CYII=" alt="SouthAndNorth" />
<p class="caption">SouthAndNorth</p>
</div>
<p>The value returnbyed <code>:on_southbound_packet()</code> and <code>:on_northbound_packet()</code> determines what will be done to the packet being processed:</p>
<ul>
<li>Returning <code>false</code> discards the packet: the packet will <em>not</em> be forwarded, and <code>packet.free()</code> will be called on it.</li>
<li>Returning a different packet replaces the packet: the packet originally being processed is discarded, <code>packet.free()</code> called on it, and the returned packet is forwarded.</li>
<li>Returning the same packet being handled will forward it. Retuning <code>nil</code> achieves the same effect.</li>
</ul>
<h4 id="example">Example</h4>
<p>The following snippet defines an application derived from <code>SouthAndNorth</code> which silently discards packets bigger than a certain size, and keeps a count of how many packets have been discarded and forwarded:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua">
<span class="co">-- Setting SouthAndNorth as metatable &quot;inherits&quot; from it.</span>
DiscardBigPackets <span class="ot">=</span> <span class="fu">setmetatable</span><span class="ot">({},</span>
   <span class="fu">require</span><span class="ot">(</span><span class="st">&quot;apps.wall.util&quot;</span><span class="ot">).</span>SouthAndNorth<span class="ot">)</span>

<span class="kw">function</span> DiscardBigPackets:new <span class="ot">(</span>max_length<span class="ot">)</span>
   <span class="kw">return</span> <span class="fu">setmetatable</span><span class="ot">({</span>
      max_packet_length <span class="ot">=</span> max_length<span class="ot">,</span>
      discarded_packets <span class="ot">=</span> <span class="dv">0</span><span class="ot">,</span>
      forwarded_packets <span class="ot">=</span> <span class="dv">0</span><span class="ot">,</span>
   <span class="ot">},</span> self<span class="ot">)</span>
<span class="kw">end</span>

<span class="kw">function</span> DiscardBigPackets:on_northbound_packet <span class="ot">(</span>pkt<span class="ot">)</span>
   <span class="kw">if</span> pkt<span class="ot">.</span>length <span class="ot">&gt;</span> self<span class="ot">.</span>max_packet_length <span class="kw">then</span>
      self<span class="ot">.</span>discarded_packets <span class="ot">=</span> self<span class="ot">.</span>discarded_packets <span class="ot">+</span> <span class="dv">1</span>
      <span class="kw">return</span> <span class="kw">false</span>
   <span class="kw">end</span>
   self<span class="ot">.</span>forwarded_packets <span class="ot">=</span> self<span class="ot">.</span>forwarded_packets <span class="ot">+</span> <span class="dv">1</span>
<span class="kw">end</span>

<span class="co">-- Apply the same logic for packets in the other direction.</span>
DiscardBigPackets<span class="ot">.</span>on_southbound_packet <span class="ot">=</span>
   DiscardBigPackets<span class="ot">.</span>on_northbound_packet</code></pre></div>
<h1 id="rss-app-apps.rss.rss">RSS app (apps.rss.rss)</h1>
<p>The <code>rss</code> app implements the basic functionality needed to provide generic <em>receive side scaling</em> to other apps. In essence, the <code>rss</code> app takes packets from an arbitrary number <code>n</code> of input links and distributes them to an arbitrary number <code>m</code> of output links</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="rss" />
<p class="caption">rss</p>
</div>
<p>The distribution algorithm has the property that all packets belonging to the same <em>flow</em> are guaranteed to be mapped to the same output link, where a flow is identified by the value of certain fields of the packet header, depending on the type of packet.</p>
<p>For IPv4 and IPv6, the basic classifier is given by the 3-tuple (<code>source address</code>, <code>destination address</code>, <code>protocol</code>), where <code>protocol</code> is the value of the protocol field of the IPv4 header or the value of the next-header field that identifies the “upper-layer protocol” of the IPv6 header (which may be preceeded by any number of extension headers).</p>
<p>If the protocol is either TCP (protocol #6), UDP (protocol #17) or SCTP (protocol #132), the list of header fields is augmented by the port numbers to yield the 5-tuple (<code>source address</code>, <code>destination address</code>, <code>protocol</code>, <code>source port</code>, <code>destination port</code>).</p>
<p>The output link is determined by applying a hash function to the set of header fields</p>
<pre><code>out_link = ( hash(flow_fields) % m ) + 1</code></pre>
<p>All other packets are not classified into flows and are always mapped to the first output link.</p>
<p>The actual scaling property is achieved by running the receivers in separate processes and use specialized inter-process links to connect them to the <code>rss</code> app.</p>
<p>In addition to this basic functionality, the <code>rss</code> app also implements the following set of extensions.</p>
<h2 id="flow-director">Flow-director</h2>
<p>The output links can be grouped into equivalence classes with respect to matching conditions in terms of arbitrary pflang expressions as provided by the <code>pf</code> module. Matching packets are only distributed to the output links that belong to the equivalence class. By default, a single equivalence class exists which matches all packets. It is special in the sense that the matching condition cannot be expressed in pflang. This default class is the only one that can receive non-IP packets.</p>
<p>Classes are specified in an explicit order when an instance of the <code>rss</code> app is created. The default class is created implicitly as the last element in the list. Each packet is matched against the filter expressions, starting with the first one. If a match is found, the packet is assigned to the corresponding equivalence class and processing of the list stops.</p>
<p>The default class can be disabled by configuration. In that case, packets not assigned to any class are dropped.</p>
<h2 id="packet-replication">Packet replication</h2>
<p>The standard flow-director assigns a packet to at most one class. Any class can also be marked with the attribute <code>continue</code> to allow matches to multiple classes. When a packet is matched to such a class, it is distributed to the set of ouput links associated with that class but processing of the remaining filter expressions continues. If the packet matches a subsequent class, a copy is created and distributed to the corresponding set of output links. Processing stops when the packet matches a class that does not have the <code>continue</code> attribute.</p>
<h2 id="weighted-links">Weighted links</h2>
<p>By default, all output links in a class are treated the same. In other words, if the input consists of a sufficiently large sample of random flows, all links will receive about the same share of them. It is possible to introduce a bias for certain links by assigning a <em>weight</em> to them, given by a positive integer <code>w</code>. If the number of links is <code>m</code> and the weight of link <code>i</code> (<code>1 &lt;= i &lt;= m</code>) is <code>w_i</code>, the share of traffic received by it is given by</p>
<pre><code>share_i = w_i/(w_1 + w_2 + ... + w_m)</code></pre>
<p>For example, if <code>m = 2</code> and <code>w_1 = 1, w_2 = 2</code>, link #1 will get 1/3 and link #2 will get 2/3 of the traffic.</p>
<h2 id="packet-meta-data">Packet meta-data</h2>
<p>In order to compute the hash over the header fields, the <code>rss</code> app must parse the packets to a certain extent. Internally, the result of this analysis is appended as a block of data to the end of the actual packet data. Because this data can be useful to other apps downstream of the <code>rss</code> app, it is exposed as part of the API.</p>
<p>The meta-data is structured as follows</p>
<pre><code>   struct {
      uint16_t magic;
      uint16_t ethertype;
      uint16_t vlan;
      uint16_t total_length;
      uint8_t *filter_start;
      uint16_t filter_length;
      uint8_t *l3;
      uint8_t *l4;
      uint16_t filter_offset;
      uint16_t l3_offset;
      uint16_t l4_offset;
      uint8_t  proto;
      uint8_t  frag_offset;
      int16_t  length_delta;
   }</code></pre>
<ul>
<li><code>magic</code></li>
</ul>
<p>This field contains the constant <code>0x5abb</code> to mark the start of a valid meta-data block. The <strong>get</strong> API function asserts that this value is correct.</p>
<ul>
<li><code>ethertype</code></li>
</ul>
<p>This is the Ethertype contained in the Ethernet header of the packet. If the frame is of type 802.1q, i.e. the Ethertype is <code>0x8100</code>, the <code>ethertype</code> field is set to the effective Ethertype following the 802.1q header. Only one level of tagging is recognised, i.e. for double-tagged frames, <code>ethertype</code> will contain the value <code>0x8100</code>.</p>
<ul>
<li><code>vlan</code></li>
</ul>
<p>If the frame contains a 802.1q tag, <code>vlan</code> is set to the value of the <code>VID</code> field of the 802.1q header. Otherwise it is set to 0.</p>
<ul>
<li><code>total_length</code></li>
</ul>
<p>If <code>ethertype</code> identifies the frame as either a IPv4 or IPv6 packet (i.e. the values <code>0x0800</code> and <code>0x86dd</code>, respectively), <code>total_length</code> is the size of the L3 payload of the Ethernet frame according to the L3 header, including the L3 header itself. For IPv4, this is the value of the header’s <em>Total Length</em> field. For IPv6, it is the sum of the header’s <em>Payload Length</em> field and the size of the basic header (40 bytes).</p>
<p>For all other values of <code>ethertype</code>, <code>total_length</code> is set to the effective size of the packet (according to the <code>length</code> field of the <code>packet</code> data structure) minus the the size of the Ethernet header (14 bytes for untagged frames and 18 bytes for 802.1q tagged frames).</p>
<ul>
<li><code>filter_start</code></li>
</ul>
<p>This is a pointer into the packet that can be passed as first argument to a BPF matching function generated by <strong>pf.compile_filter</strong>.</p>
<p>For untagged frames, this is a pointer to the proper Ethernet header.</p>
<p>For 802.1q tagged frames, an offset of 4 bytes is added to skip the 802.1q header. The reason for this is that the <code>pf</code> module does not implement the <code>vlan</code> primitive of the standard BPF syntax. The additional 4-byte offset places the effective Ethertype (i.e. the same value as in the <code>ethertype</code> meta-data field) at the position of an untagged Ethernet frame. Note that this makes the original MAC addresses unavailable to the filter.</p>
<ul>
<li><code>filter_length</code></li>
</ul>
<p>This value is the size of the chunk of data pointed to by <code>filter_start</code> and can be passed as second argument to a BPF matching function generated by <strong>pf.compile_filter</strong>. It is equal to the size of the packet if the frame is untagged or 4 bytes less than that if the frame is 802.1q tagged.</p>
<ul>
<li><code>l3</code></li>
</ul>
<p>This is a pointer to the start of the L3 header in the packet.</p>
<ul>
<li><code>l4</code></li>
</ul>
<p>This is a pointer to the start of the L4 header in the packet. For IPv4 and IPv6, it points to the first byte following the L3 header. For all other packets, it is equal to <code>l3</code>.</p>
<ul>
<li><code>filter_offset</code>, <code>l3_offset</code>, <code>l4_offset</code></li>
</ul>
<p>These values are the offsets of <code>filter_start</code>, <code>l3</code>, and <code>l4</code> relative to the start of the packet. They are used by the <strong>copy</strong> API call to re-calculate the pointers after the meta-data block has been relocated.</p>
<ul>
<li><code>proto</code></li>
</ul>
<p>For IPv4 and IPv6, the <code>proto</code> field contains the identifier of the <em>upper layer protocol</em> carried in the payload of the packet. For all other packets, its value is undefined.</p>
<p>For IPv4, the upper layer protocol is given by the value of the <em>Protocol</em> field of the header. For IPv6, it is the value of the <em>Next Header</em> field of the last extension header in the packet’s header chain. The <code>rss</code> app recognizes the following protocol identifiers as extension headers according to the <a href="http://www.iana.org/assignments/ipv6-parameters">IANA ipv6-parameters registry</a></p>
<ul>
<li>0 IPv6 Hop-by-Hop Option</li>
<li>43 Routing Header for IPv6</li>
<li>44 Fragment Header for IPv6</li>
<li>51 Authentication Header</li>
<li>60 Destination Options for IPv6</li>
<li>135 Mobility Header</li>
<li>139 Host Identity Protocol</li>
<li>140 Shim6 Protocol</li>
</ul>
<p>Note that the protocols 50 (Encapsulating Security Payload, ESP), 253 and 254 (reserved for experimentation and testing) are treated as upper layer protocols, even though, technically, they are classified as extension headers.</p>
<ul>
<li><code>frag_offset</code></li>
</ul>
<p>For fragmented IPv4 and IPv6 packets, the <code>frag_offset</code> field contains the offset of the fragment in the original packet’s payload in 8-byte units. A value of zero indicates that the packet is either not fragmented at all or is the initial fragment.</p>
<p>For non-IP packets, the value is undefined.</p>
<ul>
<li><code>length_delta</code></li>
</ul>
<p>This field contains the difference of the packet’s effective length (as given by the <code>length</code> field of the packet data structure) and the size of the packet calculated from the IP header, i.e. the sum of <code>l3_offset</code> and <code>total_length</code>. For a regular packet, this difference is zero.</p>
<p>A negative value indicates that the packet has been truncated. A typical scenario where this is expected to occur is a setup involving a port-mirror that truncates packets either due to explicit configuration or due to a hardware limitation. The <code>length_delta</code> field can be used by a downstream app to determine whether it has received a complete packet.</p>
<p>A positive value indicates that the packet contains additional data which is not part of the protocol data unit. This is not expected to occur under normal circumstances. However, it has been observed that some devices perform this kind of padding when port-mirroring is configured with packet truncation and the mirrored packet is smaller than the truncation limit.</p>
<p>For non-IP packets, <code>length_delta</code> is always zero.</p>
<h2 id="ipv6-extension-header-elimination">IPv6 extension header elimination</h2>
<p>The <code>pf</code> module does not implement the <code>protochain</code> primitive for IPv6. The only extension header it can deal with is the fragmentation header (protocol 44). As a consequence, packets containing arbitrary extension headers can not be matched against filter expressions.</p>
<p>To overcome this limitation, the meta-data generator of the <code>rss</code> app removes all extension headers from a packet by default, leaving only the basic IPv6 header followed immediately by the upper layer protocol. The values of the <em>Payload Length</em> and <em>Next Header</em> fields of the basic IPv6 header as well as the packet length are adjusted accordingly.</p>
<h2 id="vlan-pseudo-tagging">VLAN pseudo-tagging</h2>
<p>Since the <code>rss</code> app can accept packets from multiple sources, the information on which link the packet was received is not trivially available to receiving apps unless the packets contain a unique identifier of some sort, e.g. a particular VLAN tag. If such an identifier is not available, the <code>rss</code> app can be configured to attach a pseudo VLAN tag to packets arriving on a particular input link. It is called “pseudo tagging” because the VLAN is only added to the packet’s meta-data, not the packet itself. As a consequence, a receiving app only sees this kind of tag when it examines the meta-data provided by the <code>rss</code> app. Such a pseudo-tag also overrides any native VLAN tag that a packet might have.</p>
<p>The pseudo-tagging is enabled by following a convention for the naming of input links as described below.</p>
<p>If proper VLAN tagging is required, the <code>vlan.vlan.Tagger</code> app can be pushed between the packet source and the input link.</p>
<h2 id="configuration-31">Configuration</h2>
<p>The <code>rss</code> app accepts the following arguments.</p>
<p>— Key <strong>default_class</strong></p>
<p><em>Optional</em>. A boolean that specifies whether the default filter class should be enabled. The default is <code>true</code>. The name of the default class is <em>default</em>.</p>
<p>— Key <strong>classes</strong></p>
<p><em>Optional</em>. An ordered list of class specifications. Each specification must be a table with the following keys.</p>
<ul>
<li><p>Key <strong>name</strong></p>
<p><em>Required</em>. The name of the class. It must be unique among all classes and it must match the Lua regular expression <code>%w+</code>.</p></li>
<li><p>Key <strong>filter</strong></p>
<p><em>Required</em>. A string containing a pflang filter expression.</p></li>
<li><p>Key <strong>continue</strong></p>
<p><em>Optional</em>. A boolean that specifies whether processing of classes should continue if a packet has matched the filter of this class. The default is <code>false</code>.</p></li>
</ul>
<p>— Key <strong>remove_extension_headers</strong></p>
<p><em>Optional</em>. A boolean that specifies whether IPv6 extension headers shoud be removed from packets. The default is <code>true</code>.</p>
<p>The <strong>classes</strong> configuration option specifies the set of classes known to an instance of the <code>rss</code> app. The assignment of links to classes is done implicitly by connecting other apps using the convention <code>&lt;class&gt;_&lt;instance&gt;</code> for the name of the links, where <code>&lt;class&gt;</code> is the name of the class to which the links should be assigned exactly as specified by the <strong>name</strong> parameter of the class definition. The <code>&lt;instance&gt;</code> specifier can be any string (adhering to the naming convention for links) that distinguishes the links within a class.</p>
<p>If the instance specifier is formatted as <code>&lt;instance&gt;_&lt;weight&gt;</code>, where <code>&lt;instance&gt;</code> is restricted to the pattern <code>%w+</code> and <code>&lt;weight&gt;</code> must be a number, the link’s weight is set to the value <code>&lt;weight&gt;</code>. The default weight for a links is 1.</p>
<p>If the <code>rss</code> app detects an output link whose name does not match any of the configured classes, it issues a warning message and ignores the link. Classes to which no output links are assigned are ignored.</p>
<p>The names of the input links are arbitrary unless the VLAN pseudo-tagging feature should be used. In that case, the link must be named <code>vlan&lt;vlan-id&gt;</code>, where <code>&lt;vlan-id&gt;</code> must be a number between 1 and 4094 and will be placed in the <code>&lt;vlan&gt;</code> meta-data field of every packet received on the link (irrespective of whether the packet has a real VLAN ID or not).</p>
<h2 id="meta-data-api">Meta-data API</h2>
<p>The meta-data functionality is provided by the module <code>apps.rss.metadata</code> and provides the following API.</p>
<p>— Function <strong>add</strong> <em>packet</em>, <em>remove_extension_headers</em>, <em>vlan</em></p>
<p>Analyzes <em>packet</em> and adds a meta-data block starting immediately after the packet data. If the boolean <em>remove_extension_headers</em> is <code>true</code>, IPv6 extension headers are removed from the packet. The optional <em>vlan</em> overrides the value of the <code>vlan</code> meta-data field extracted from the packet, irrespective of whether the packet actually has a tag or not.</p>
<p>An error is raised if there is not enough room for the mata-data block in the packet.</p>
<p>— Function <strong>get</strong> <em>packet</em></p>
<p>Returns a pointer to the meta-data in <em>packet</em>. An error is raised if the meta-data block does not start with the magic number (<code>0x5abb</code>).</p>
<p>— Function <strong>copy</strong> <em>packet</em></p>
<p>Creates a copy of <em>packet</em> including the meta-data block. Returns a pointer to the new packet.</p>
<h1 id="inter-process-links-apps.interlink.">Inter-process links (apps.interlink.*)</h1>
<p>The “interlink” transmitter and receiver apps allow for efficient exchange of packets between Snabb processes within the same process group (see <a href="#multiprocess-operation-core.worker">Multiprocess operation (core.worker)</a>).</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Transmitter" />
<p class="caption">Transmitter</p>
</div>
<p>To make packets from an output port available to other processes, configure a transmitter app, and link the appropriate output port to its <code>input</code> port.</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> Transmitter <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">&quot;apps.interlink.transmitter&quot;</span><span class="ot">)</span>

config<span class="ot">.</span>app<span class="ot">(</span>c<span class="ot">,</span> <span class="st">&quot;interlink&quot;</span><span class="ot">,</span> Transmitter<span class="ot">)</span>
config<span class="ot">.</span>link<span class="ot">(</span>c<span class="ot">,</span> <span class="st">&quot;myapp.output -&gt; interlink.input&quot;</span><span class="ot">)</span></code></pre></div>
<p>Then, in the process that should receive the packets, configure a receiver app with the same name, and link its <code>output</code> port as suitable.</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> Receiver <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">&quot;apps.interlink.receiver&quot;</span><span class="ot">)</span>

config<span class="ot">.</span>app<span class="ot">(</span>c<span class="ot">,</span> <span class="st">&quot;interlink&quot;</span><span class="ot">,</span> Receiver<span class="ot">)</span>
config<span class="ot">.</span>link<span class="ot">(</span>c<span class="ot">,</span> <span class="st">&quot;interlink.output -&gt; otherapp.input&quot;</span><span class="ot">)</span></code></pre></div>
<p>Subsequently, packets transmitted to the transmitter’s <code>input</code> port will appear on the receiver’s <code>output</code> port.</p>
<p>Alternatively, a name can be supplied as a configuration argument to be used instead of the app’s name:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua">config<span class="ot">.</span>app<span class="ot">(</span>c<span class="ot">,</span> <span class="st">&quot;mylink&quot;</span><span class="ot">,</span> Receiver<span class="ot">,</span> <span class="st">&quot;interlink&quot;</span><span class="ot">)</span>
config<span class="ot">.</span>link<span class="ot">(</span>c<span class="ot">,</span> <span class="st">&quot;mylink.output -&gt; otherapp.input&quot;</span><span class="ot">)</span></code></pre></div>
<h2 id="configuration-32">Configuration</h2>
<p>The configured app names denote globally unique queues within the process group. Alternativelyy, the receiver and transmitter apps can instead be passed a string that names the shared queue to which to attach to.</p>
<p>Starting either the transmitter or receiver app attaches them to a shared packet queue visible to the process group under the name that was given to the app. When the queue identified by the name is unavailable, because it is already in use by a pair of processes within the group, configuration of the app network will block until the queue becomes available. Once the transmitter or receiver apps are stopped they detach from the queue.</p>
<p>Only two processes (one receiver and one transmitter) can be attached to an interlink queue at the same time, but during the lifetime of the queue (e.g., from when the first process attached to when the last process detaches) it can be shared by any number of receivers and transmitters. Meaning, either process attached to the queue can be restarted or replaced by another process without packet loss.</p>
<h1 id="libraries">Libraries</h1>
<h3 id="ip-checksum-lib.checksum">IP checksum (lib.checksum)</h3>
<p>The checksum module provides an optimized ones-complement checksum routine.</p>
<p>— Function <strong>ipsum</strong> <em>pointer</em> <em>length</em> <em>initial</em></p>
<p>Return the ones-complement checksum for the given region of memory.</p>
<p><em>pointer</em> is a pointer to an array of data to be checksummed. <em>initial</em> is an unsigned 16-bit number in host byte order which is used as the starting value of the accumulator. The result is the IP checksum over the data in host byte order.</p>
<p>The <em>initial</em> argument can be used to verify a checksum or to calculate the checksum in an incremental manner over chunks of memory. The synopsis to check whether the checksum over a block of data is equal to a given value is the following</p>
<pre><code>if ipsum(pointer, length, value) == 0 then
  -- checksum correct
else
  -- checksum incorrect
end</code></pre>
<p>To chain the calculation of checksums over multiple blocks of data together to obtain the overall checksum, one needs to pass the one’s complement of the checksum of one block as initial value to the call of ipsum() for the following block, e.g.</p>
<pre><code>local sum1 = ipsum(data1, length1, 0)
local total_sum = ipsum(data2, length2, bit.bnot(sum1))</code></pre>
<p>This function takes advantage of SIMD hardware when available.</p>
<h3 id="ctable-lib.ctable">Ctable (lib.ctable)</h3>
<p>A <em>ctable</em> is a hash table whose keys and values are instances of FFI data types. In Lua parlance, an FFI value is a “cdata” value, hence the name “ctable”.</p>
<p>A ctable is parameterized for the specific types for its keys and values. This allows for the table to be stored in an efficient manner. Adding an entry to a ctable will copy the value into the table. Logically, the table “owns” the value. Lookup can either return a pointer to the value in the table, or copy the value into a user-supplied buffer, depending on what is most convenient for the user.</p>
<p>To create a ctable, first create a parameters table specifying the key and value types, along with any other options. Then call <code>ctable.new</code> on those parameters. For example:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> ctable <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'lib.ctable'</span><span class="ot">)</span>
<span class="kw">local</span> ffi <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'ffi'</span><span class="ot">)</span>
<span class="kw">local</span> params <span class="ot">=</span> <span class="ot">{</span>
   key_type <span class="ot">=</span> ffi<span class="ot">.</span>typeof<span class="ot">(</span><span class="st">'uint32_t'</span><span class="ot">),</span>
   value_type <span class="ot">=</span> ffi<span class="ot">.</span>typeof<span class="ot">(</span><span class="st">'int32_t[6]'</span><span class="ot">),</span>
   max_occupancy_rate <span class="ot">=</span> <span class="dv">0.4</span><span class="ot">,</span>
   initial_size <span class="ot">=</span> <span class="fu">math.ceil</span><span class="ot">(</span>occupancy <span class="ot">/</span> <span class="dv">0.4</span><span class="ot">)</span>
<span class="ot">}</span>
<span class="kw">local</span> ctab <span class="ot">=</span> ctable<span class="ot">.</span>new<span class="ot">(</span>params<span class="ot">)</span></code></pre></div>
<p>— Function <strong>ctable.new</strong> <em>parameters</em></p>
<p>Create a new ctable. <em>parameters</em> is a table of key/value pairs. The following keys are required:</p>
<ul>
<li><code>key_type</code>: An FFI type (LuaJIT “ctype”) for keys in this table.</li>
<li><code>value_type</code>: An FFI type (LuaJT “ctype”) for values in this table.</li>
</ul>
<p>Optional entries that may be present in the <em>parameters</em> table include:</p>
<ul>
<li><code>hash_seed</code>: A hash seed, as a 16-byte array. The hash value of a key is a function of the key and also of the hash seed. Using a hash function with a seed prevents some kinds of denial-of-service attacks against network functions that use ctables. The seed defaults to a fresh random byte string. The seed also changes whenever a table is resized.</li>
<li><code>initial_size</code>: The initial size of the hash table, including free space. Defaults to 8 slots.</li>
<li><code>max_occupancy_rate</code>: The maximum ratio of <code>occupancy/size</code>, where <code>occupancy</code> denotes the number of entries in the table, and <code>size</code> is the total table size including free entries. Trying to add an entry to a “full” table will cause the table to grow in size by a factor of</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Defaults to 0.9, for a 90% maximum occupancy ratio.</li>
</ol>
<ul>
<li><code>min_occupancy_rate</code>: Minimum ratio of <code>occupancy/size</code>. Removing an entry from an “empty” table will shrink the table.</li>
</ul>
<p>— Function <strong>ctable.load</strong> <em>stream</em> <em>parameters</em></p>
<p>Load a ctable that was previously saved out to a binary format. <em>parameters</em> are as for <code>ctable.new</code>. <em>stream</em> should be an object that has a <strong>:read_ptr</strong>(<em>ctype</em>) method, which returns a pointer to an embedded instances of <em>ctype</em> in the stream, advancing the stream over the object; and <strong>:read_array</strong>(<em>ctype</em>, <em>count</em>) which is the same but reading <em>count</em> instances of <em>ctype</em> instead of just one.</p>
<h4 id="methods">Methods</h4>
<p>Users interact with a ctable through methods. In these method descriptions, the object on the left-hand-side of the method invocation should be a ctable.</p>
<p>— Method <strong>:resize</strong> <em>size</em></p>
<p>Resize the ctable to have <em>size</em> total entries, including empty space.</p>
<p>— Method <strong>:add</strong> <em>key</em>, <em>value</em>, <em>updates_allowed</em></p>
<p>Add an entry to the ctable, returning the index of the added entry. <em>key</em> and <em>value</em> are FFI values for the key and the value, of course.</p>
<p><em>updates_allowed</em> is an optional parameter. If not present or false, then the <code>:insert</code> method will raise an error if the <em>key</em> is already present in the table. If <em>updates_allowed</em> is the string <code>&quot;required&quot;</code>, then an error will be raised if <em>key</em> is <em>not</em> already in the table. Any other true value allows updates but does not require them. An update will replace the existing entry in the table.</p>
<p>Returns a pointer to the inserted entry. Any subsequent modification to the table may invalidate this pointer.</p>
<p>— Method <strong>:update</strong> <em>key</em>, <em>value</em></p>
<p>Update the entry in a ctable with the key <em>key</em> to have the new value <em>value</em>. Throw an error if <em>key</em> is not present in the table.</p>
<p>— Method <strong>:lookup_ptr</strong> <em>key</em></p>
<p>Look up <em>key</em> in the table, and if found return a pointer to the entry. Return nil if the value is not found.</p>
<p>An entry pointer has three fields: the <code>hash</code> value, which must not be modified; the <code>key</code> itself; and the <code>value</code>. Access them as usual in Lua:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> ptr <span class="ot">=</span> ctab:lookup<span class="ot">(</span>key<span class="ot">)</span>
<span class="kw">if</span> ptr <span class="kw">then</span> <span class="fu">print</span><span class="ot">(</span>ptr<span class="ot">.</span>value<span class="ot">)</span> <span class="kw">end</span></code></pre></div>
<p>Note that pointers are only valid until the next modification of a table.</p>
<p>— Method <strong>:lookup_and_copy</strong> <em>key</em>, <em>entry</em></p>
<p>Look up <em>key</em> in the table, and if found, copy that entry into <em>entry</em> and return true. Otherwise return false.</p>
<p>— Method <strong>:remove_ptr</strong> <em>entry</em></p>
<p>Remove an entry from a ctable. <em>entry</em> should be a pointer that points into the table. Note that pointers are only valid until the next modification of a table.</p>
<p>— Method <strong>:remove</strong> <em>key</em>, <em>missing_allowed</em></p>
<p>Remove an entry from a ctable, keyed by <em>key</em>.</p>
<p>Return true if we actually do find a value and remove it. Otherwise if no entry is found in the table and <em>missing_allowed</em> is true, then return false. Otherwise raise an error.</p>
<p>— Method <strong>:save</strong> <em>stream</em></p>
<p>Save a ctable to a byte sink. <em>stream</em> should be an object that has a <strong>:write_ptr</strong>(<em>ctype</em>) method, which writes an instance of a struct type out to a stream, and <strong>:write_array</strong>(<em>ctype</em>, <em>count</em>) which is the same but writing <em>count</em> instances of <em>ctype</em> instead of just one.</p>
<p>— Method <strong>:selfcheck</strong></p>
<p>Run an expensive internal diagnostic to verify that the table’s internal invariants are fulfilled.</p>
<p>— Method <strong>:dump</strong></p>
<p>Print out the entries in a table. Can be expensive if the table is large.</p>
<p>— Method <strong>:iterate</strong></p>
<p>Return an iterator for use by <code>for in</code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">for</span> entry <span class="kw">in</span> ctab:iterate<span class="ot">()</span> <span class="kw">do</span>
   <span class="fu">print</span><span class="ot">(</span>entry<span class="ot">.</span>key<span class="ot">,</span> entry<span class="ot">.</span>value<span class="ot">)</span>
<span class="kw">end</span></code></pre></div>
<h4 id="streaming-interface">Streaming interface</h4>
<p>As an implementation detail, the table is stored as an open-addressed robin-hood hash table with linear probing. Ctables use the high-quality SipHash hash function to allow for good distribution of hash values. To find a value associated with a key, a ctable will first hash the key, map that hash value to an index into the table by scaling the hash to the table size, and then scan forward in the table until we find an entry whose hash value is greater than or equal to the hash in question. Each entry stores its hash value, and empty entries have a hash of <code>0xFFFFFFFF</code>. If the entry’s hash matches and the entry’s key is equal to the one we are looking for, then we have our match. If the entry’s hash is greater than our hash, then we have a failure. Hash collisions are possible as well of course; in that case we continue scanning forward.</p>
<p>The distance travelled while scanning for the matching hash is known as the <em>displacement</em>. The table measures its maximum displacement, for a number of purposes, but you might be interested to know that a maximum displacement for a table with 2 million entries and a 40% load factor is around 8 or 9. Smaller tables will have smaller maximum displacements.</p>
<p>The ctable has two lookup interfaces. The first one is the <code>lookup</code> methods described above. The other interface will fetch all entries within the maximum displacement into a buffer, then do a branchless binary search over that buffer. This second streaming lookup can also fetch entries for multiple keys in one go. This can amortize the cost of a round-trip to RAM, in the case where you expect to miss cache for every lookup.</p>
<p>To perform a streaming lookup, first prepare a <code>LookupStreamer</code> for the batch size that you need. You will have to experiment to find the batch size that works best for your table’s entry sizes; for reference, for 32-byte entries a 32-wide lookup seems to be optimum.</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="co">-- Stream in 32 lookups at once.</span>
<span class="kw">local</span> stride <span class="ot">=</span> <span class="dv">32</span>
<span class="kw">local</span> streamer <span class="ot">=</span> ctab:make_lookup_streamer<span class="ot">(</span>stride<span class="ot">)</span></code></pre></div>
<p>Wiring up streaming lookup in a packet-processing network is a bit of a chore currently, as you have to maintain separate queues of lookup keys and packets, assuming that each lookup maps to a packet. Let’s make a little helper:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> lookups <span class="ot">=</span> <span class="ot">{</span>
   queue <span class="ot">=</span> ffi<span class="ot">.</span>new<span class="ot">(</span><span class="st">&quot;struct packet * [?]&quot;</span><span class="ot">,</span> stride<span class="ot">),</span>
   queue_len <span class="ot">=</span> <span class="dv">0</span><span class="ot">,</span>
   streamer <span class="ot">=</span> streamer
<span class="ot">}</span>

<span class="kw">local</span> <span class="kw">function</span> <span class="fu">flush</span><span class="ot">(</span>lookups<span class="ot">)</span>
   <span class="kw">if</span> lookups<span class="ot">.</span>queue_len <span class="ot">&gt;</span> <span class="dv">0</span> <span class="kw">then</span>
      <span class="co">-- Here is the magic!</span>
      lookups<span class="ot">.</span>streamer:stream<span class="ot">()</span>
      <span class="kw">for</span> i <span class="ot">=</span> <span class="dv">0</span><span class="ot">,</span> lookups<span class="ot">.</span>queue_len <span class="ot">-</span> <span class="dv">1</span> <span class="kw">do</span>
         <span class="kw">local</span> pkt <span class="ot">=</span> lookups<span class="ot">.</span>queue<span class="ot">[</span>i<span class="ot">]</span>
         <span class="kw">if</span> lookups<span class="ot">.</span>streamer:is_found<span class="ot">(</span>i<span class="ot">)</span>
            <span class="kw">local</span> val <span class="ot">=</span> lookups<span class="ot">.</span>streamer<span class="ot">.</span>entries<span class="ot">[</span>i<span class="ot">].</span>value
            <span class="co">--- Do something cool here!</span>
         <span class="kw">end</span>
      <span class="kw">end</span>
      lookups<span class="ot">.</span>queue_len <span class="ot">=</span> <span class="dv">0</span>
   <span class="kw">end</span>
<span class="kw">end</span>

<span class="kw">local</span> <span class="kw">function</span> enqueue<span class="ot">(</span>lookups<span class="ot">,</span> pkt<span class="ot">,</span> key<span class="ot">)</span>
   <span class="kw">local</span> n <span class="ot">=</span> lookups<span class="ot">.</span>queue_len
   lookups<span class="ot">.</span>streamer<span class="ot">.</span>entries<span class="ot">[</span>n<span class="ot">].</span>key <span class="ot">=</span> key
   lookups<span class="ot">.</span>queue<span class="ot">[</span>n<span class="ot">]</span> <span class="ot">=</span> pkt
   n <span class="ot">=</span> n <span class="ot">+</span> <span class="dv">1</span>
   <span class="kw">if</span> n <span class="ot">==</span> stride <span class="kw">then</span>
      <span class="fu">flush</span><span class="ot">(</span>lookups<span class="ot">)</span>
   <span class="kw">else</span>
      lookups<span class="ot">.</span>queue_len <span class="ot">=</span> n
   <span class="kw">end</span>
<span class="kw">end</span></code></pre></div>
<p>Then as you see packets, you enqueue them via <code>enqueue</code>, extracting out the key from the packet in some way and passing that value as the argument. When <code>enqueue</code> detects that the queue is full, it will flush it, performing the lookups in parallel and processing the results.</p>
<h3 id="pmu-lib.pmu">PMU (lib.pmu)</h3>
<p>The CPU’s PMU (Performance Monitoring Unit) collects information about specific <em>performance events</em> such as cache misses, branch mispredictions, and utilization of internal CPU resources like execution units. This module provides an API for counting events with the PMU.</p>
<p>Hundreds of low-level counters are available. The exact list depends on CPU model. See pmu_cpu.lua for our definitions.</p>
<h4 id="high-level-interface">High-level interface</h4>
<p>— Function <strong>is_available</strong></p>
<p>If the PMU hardware is available then return true. Otherwise return two values: false and a string briefly explaining why. (Cooperation from the Linux kernel is required to acess the PMU.)</p>
<p>— Function <strong>profile</strong> <em>function</em> <em>[event_list]</em> <em>[aux]</em></p>
<p>Call <em>function</em>, return the result, and print a human-readable report of the performance events that were counted during execution.</p>
<p>— Function <strong>measure</strong> <em>function</em> <em>[event_list]</em></p>
<p>Call <em>function</em> and return two values: the result and a table of performance event counter tallies.</p>
<h4 id="low-level-interface">Low-level interface</h4>
<p>— Function <strong>setup</strong> <em>event_list</em></p>
<p>Setup the hardware performance counters to track a given list of events (in addition to the built-in fixed-function counters).</p>
<p>Each event is a Lua string pattern. This could be a full event name:</p>
<pre><code>mem_load_uops_retired.l1_hit</code></pre>
<p>or a more general pattern that matches several counters:</p>
<pre><code>mem_load.*l._hit</code></pre>
<p>Return the number of overflowed counters that could not be tracked due to hardware constraints. These will be the last counters in the list.</p>
<p>Example:</p>
<pre><code>setup({&quot;uops_issued.any&quot;,
       &quot;uops_retired.all&quot;,
       &quot;br_inst_retired.conditional&quot;,
       &quot;br_misp_retired.all_branches&quot;}) =&gt; 0</code></pre>
<p>— Function <strong>new_counter_set</strong></p>
<p>Return a <code>counter_set</code> object that can be used for accumulating events. The counter_set will be valid only until the next call to setup().</p>
<p>— Function <strong>switch_to</strong> <em>counter_set</em></p>
<p>Switch to a new set of counters to accumulate events in. Has the side-effect of committing the current accumulators to the previous record.</p>
<p>If <em>counter_set</em> is nil then do not accumulate events.</p>
<p>— Function <strong>to_table</strong> <em>counter_set</em></p>
<p>Return a table containing the values accumulated in <em>counter_set</em>.</p>
<p>Example:</p>
<pre><code>to_table(cs) =&gt;
  {
   -- Fixed-function counters
   instructions                 = 133973703,
   cycles                       = 663011188,
   ref-cycles                   = 664029720,
   -- General purpose counters selected with setup()
   uops_issued.any              = 106860997,
   uops_retired.all             = 106844204,
   br_inst_retired.conditional  =  26702830,
   br_misp_retired.all_branches =       419
  }</code></pre>
<p>— Function <strong>report</strong> <em>counter_set</em> <em>[aux]</em></p>
<p>Print a textual report on the values accumulated in a counter set. Optionally include auxiliary application-level counters. The ratio of each event to each auxiliary counter is also reported.</p>
<p>Example:</p>
<pre><code>report(my_counter_set, {packet = 26700000, breath = 208593})</code></pre>
<p>prints output approximately like:</p>
<pre><code>EVENT                                   TOTAL     /packet     /breath
instructions                      133,973,703       5.000     642.000
cycles                            663,011,188      24.000    3178.000
ref-cycles                        664,029,720      24.000    3183.000
uops_issued.any                   106,860,997       4.000     512.000
uops_retired.all                  106,844,204       4.000     512.000
br_inst_retired.conditional        26,702,830       1.000     128.000
br_misp_retired.all_branches              419       0.000       0.000
packet                             26,700,000       1.000     128.000
breath                                208,593       0.008       1.000</code></pre>
<h3 id="snabb-program-configuration-with-yang-lib.yang">Snabb program configuration with YANG (<code>lib.yang</code>)</h3>
<p>YANG is a data modelling language designed for use in networking equipment, standardized as <a href="https://tools.ietf.org/html/rfc6020">RFC 6020</a>. The <code>lib.yang</code> modules provide YANG facilities to Snabb applications, allowing operators to understand how to work with a Snabb data plane and also providing convenient configuration facilities for data-plane authors.</p>
<h4 id="overview">Overview</h4>
<p>Everything in YANG starts with a <em>schema</em>: a specification of the data model of a device. For example, consider a simple Snabb router that receives IPv4 traffic and sends it out one of 12 ports. We might model it like this:</p>
<pre class="yang"><code>module snabb-simple-router {
  namespace snabb:simple-router;
  prefix simple-router;

  import ietf-inet-types {prefix inet;}

  leaf active { type boolean; default true; }

  container routes {
    list route {
      key addr;
      leaf addr { type inet:ipv4-address; mandatory true; }
      leaf port { type uint8 { range 0..11; } mandatory true; }
    }
  }
}</code></pre>
<p>Given this schema, <code>lib.yang</code> can automatically derive a configuration file format for this Snabb program and create a parser that applies the validation constraints from the schema. The result is a simple plain-old-data Lua object that the data-plane can use directly.</p>
<p>Additionally there is support for efficient binary compilation of configurations. The problem is that even in this simple router, the routing table can grow quite large. While particular applications can sometimes incrementally update their configurations without completely reloading the configuration from the start, in general reloading is almost always a possibility, and you want to avoid packet loss during the time that the millions of routing table entries are loaded and validated.</p>
<p>For that reason the <code>lib.yang</code> code also defines a mapping that, given a YANG schema, can compile any configuration for that schema into a pre-validated binary file that the data-plane can just load up directly. Additionally for <code>list</code> nodes that map between keys and values, the <code>lib.yang</code> facilities can compile that map into an efficient <a href="../README.ctable.md"><code>ctable</code></a>, letting the data-plane use the configuration as-is.</p>
<p>The schema given above can be loaded from a string using <code>load_schema</code> from the <code>lib.yang.schema</code> module, from a file via <code>load_schema_file</code>, or by name using <code>load_schema_by_name</code>. This last interface allows one to compile a YANG schema into the Snabb binary directly; if we name the above file <code>snabb-simple-router.yang</code> and place it in the <code>src/lib/yang</code> directory, then <code>load_schema_by_name('snabb-simple-router')</code> will find it appropriately. Indeed, this is how the <code>ietf-inet-types</code> import in the above example was resolved.</p>
<h4 id="configuration-syntax">Configuration syntax</h4>
<p>Consider again the example <code>snabb-simple-router</code> schema. To configure a router, we need to provide a configuration in a way that the application can understand. In Snabb, we derive this configuration syntax from the schema, in the following way:</p>
<ul>
<li><p>A <code>module</code>’s configuration is composed of the configurations of all data nodes (<code>container</code>, <code>leaf-list</code>, <code>list</code>, and <code>leaf</code>) nodes inside it.</p></li>
<li><p>A <code>leaf</code>’s configuration is like <code>keyword value;</code>, where the keyword is the name of the leaf, and the value is in the right syntax for the leaf’s type. (More on value types below.)</p></li>
<li><p>A <code>container</code>’s configuration is the container’s keyword followed by the configuration of its data node children, like <code>keyword {   configuration... }</code>.</p></li>
<li><p>A <code>leaf-list</code>’s configuration is a sequence of 0 or more instances of <code>keyword value;</code>, as in <code>leaf</code>.</p></li>
<li><p>A <code>list</code>’s configuration is a sequence of 0 or more instances of the form <code>keyword { configuration... }</code>, again where <code>keyword</code> is the list name and <code>configuration...</code> indicates the configuration of child data nodes.</p></li>
</ul>
<p>Concretely, for the example configuration above, the above algorithm derives a configuration format of the following form:</p>
<pre><code>(active true|false;)?
(routes {
  (route { addr ipv4-address; port uint8; })*
})?</code></pre>
<p>In this grammar syntax, <code>(foo)?</code> indicates either 0 or 1 instances of <code>foo</code>, <code>(foo)*</code> is similar bit indicating 0 or more instances, and <code>|</code> expresses alternation.</p>
<p>An example configuration might be:</p>
<pre><code>active true;
routes {
  route { addr 1.2.3.4; port 1; }
  route { addr 2.3.4.5; port 10; }
  route { addr 3.4.5.6; port 2; }
}</code></pre>
<p>Except in special cases as described in RFC 6020, order is insignificant. You could have <code>active false;</code> at the end, for example, and <code>route { addr 1.2.3.4; port 1; }</code> is the same as <code>route { port 1; addr 1.2.3.4; }</code>.</p>
<p>The surface syntax of our configuration format is the same as for YANG schemas; <code>&quot;1.2.3.4&quot;</code> is the same as <code>1.2.3.4</code>. Snabb follows the XML mapping guidelines of how to represent data described by a YANG schema, except that it uses YANG syntax instead of XML syntax. We could generate XML instead, but we want to avoid bringing in the complexities of XML parsing to Snabb. We also think that the result is a syntax that is pleasant and approachable to write by hand; we want to make sure that everyone can use the same configuration format, regardless of whether they are configuring Snabb via an external daemon like <code>sysrepo</code> or whether they write configuration files by hand.</p>
<h4 id="compiled-configurations">Compiled configurations</h4>
<p>Loading a schema and using it to parse a data file can be a bit expensive, especially if the data file includes a large routing table or other big structure. It can be useful to pay for this this parsing and validation cost “offline”, without interrupting a running data plane.</p>
<p>For this reason, Snabb support compiling configurations to binary data. A data plane can load a compiled configuration without any validation, very cheaply. Users can explicitly call the <code>compile_config_for_schema</code> or <code>compile_config_for_schema_by_name</code> functions. Support is planned also for automatic compilation and of source configuration files as well, so that the user can just edit configurations as text and still take advantage of the speedy binary configuration loads when nothing has changed.</p>
<h4 id="querying-and-updating-configurations">Querying and updating configurations</h4>
<p>[TODO] We will need to be able to serialize a configuration back to source, for when a user asks what the configuration of a device is. We will also need to serialize partial configurations, for when the user asks for just a part of the configuration.</p>
<p>[TODO] We will need to support updating the configuration of a running snabb application. We plan to compile the candidate configuration in a non-worker process, then signal the worker to reload its configuration.</p>
<p>[TODO] We will need to support incremental configuration updates, for example to add or remove a binding table entry for the lwAFTR. In this way we can avoid a full reload of the configuration, minimizing packet loss.</p>
<h4 id="state-data">State data</h4>
<p>[TODO] We need to map the state data exported by a Snabb process (counters, etc) to YANG-format data. Perhaps this can be done in a similar way as configuration compilation: the configuration facility in the Snabb binary compiles a YANG state data file and periodically updates it by sampling the data plane, and then we re-use the configuration serialization facilities to serialize (potentially partial) state data.</p>
<h4 id="api-reference">API reference</h4>
<p>The public entry point to the YANG library is the <code>lib.yang.yang</code> module, which exports the following bindings. Note that unless you have special needs, probably the only one you want to use is <code>load_configuration</code>.</p>
<p>— Function <strong>load_configuration</strong> <em>filename</em> <em>parameters</em></p>
<p>Load a configuration from disk. If <em>filename</em> is a compiled configuration, load it directly. Otherwise it must be a source file. In that case, try to load a corresponding compiled file instead if possible. If all that fails, actually parse the source configuration, and try to residualize a corresponding compiled file so that we won’t have to go through the whole thing next time.</p>
<p><em>parameters</em> is a table of key/value pairs. The following key is required:</p>
<ul>
<li><code>schema_name</code>: The name of the YANG schema that describes the configuration. This is the name that appears as the <em>id</em> in <code>module    id { ... }</code> in the schema.</li>
</ul>
<p>Optional entries that may be present in the <em>parameters</em> table include:</p>
<ul>
<li><code>verbose</code>: Set to true to print verbose information about which files are being loaded and compiled.</li>
<li><code>revision_date</code>: If set, assert that the loaded configuration was built against this particular schema revision date.</li>
</ul>
<p>For more information on the format of the returned value, see the documentation below for <code>load_config_for_schema</code>.</p>
<p>— Function <strong>load_schema</strong> <em>src</em> <em>filename</em></p>
<p>Load a YANG schema from the string <em>src</em>. <em>filename</em> is an optional file name for use in error messages. Returns a YANG schema object.</p>
<p>Schema objects do have useful internal structure but they are not part of the documented interface.</p>
<p>— Function <strong>load_schema_file</strong> <em>filename</em></p>
<p>Load a YANG schema from the file named <em>filename</em>. Returns a YANG schema object.</p>
<p>— Function <strong>load_schema_by_name</strong> <em>name</em> <em>revision</em></p>
<p>Load the given named YANG schema. The <em>name</em> indicates the canonical name of the schema, which appears as <code>module *name* { ... }</code> in the YANG schema itself, or as <code>import *name* { ... }</code> in other YANG modules that import this module. <em>revision</em> optionally indicates that a certain revision data should be required.</p>
<p>— Function <strong>add_schema</strong> <em>src</em> <em>filename</em></p>
<p>Add the YANG schema from the string <em>src</em> to Snabb’s database of YANG schemas, making it available to <code>load_schema_by_name</code> and related functionality. <em>filename</em> is used when signalling any parse errors. Returns the name of the newly added schema.</p>
<p>— Function <strong>add_schema_file</strong> <em>filename</em></p>
<p>Like <code>add_schema</code>, but reads the YANG schema in from a file. Returns the name of the newly added schema.</p>
<p>— Function <strong>load_config_for_schema</strong> <em>schema</em> <em>src</em> <em>filename</em></p>
<p>Given the schema object <em>schema</em>, load the configuration from the string <em>src</em>. Returns a parsed configuration as a plain old Lua value that tries to represent configuration values using appropriate Lua types.</p>
<p>The top-level result from parsing will be a table whose keys are the top-level configuration options. For example in the above example:</p>
<pre><code>active true;
routes {
  route { addr 1.2.3.4; port 1; }
  route { addr 2.3.4.5; port 10; }
  route { addr 3.4.5.6; port 2; }
}</code></pre>
<p>In this case, the result would be a table with two keys, <code>active</code> and <code>routes</code>. The value of the <code>active</code> key would be Lua boolean <code>true</code>.</p>
<p>The <code>routes</code> container is just another table of the same kind.</p>
<p>Inside the <code>routes</code> container is the <code>route</code> list, which is represented as an associative array. The particular representation for the associative array depends on characteristics of the <code>list</code> type; see below for details. In this case the <code>route</code> list compiles to a <a href="../README.ctable.md"><code>ctable</code></a>. Therefore to get the port for address 1.2.3.4, you would do:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> yang <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'lib.yang.yang'</span><span class="ot">)</span>
<span class="kw">local</span> ipv4 <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'lib.protocol.ipv4'</span><span class="ot">)</span>
<span class="kw">local</span> data <span class="ot">=</span> yang<span class="ot">.</span>load_config_for_schema<span class="ot">(</span>router_schema<span class="ot">,</span> conf_str<span class="ot">)</span>
<span class="kw">local</span> port <span class="ot">=</span> data<span class="ot">.</span>routes<span class="ot">.</span>route:lookup_ptr<span class="ot">(</span>ipv4:pton<span class="ot">(</span><span class="st">'1.2.3.4'</span><span class="ot">)).</span>value<span class="ot">.</span>port
<span class="fu">assert</span><span class="ot">(</span>port <span class="ot">==</span> <span class="dv">1</span><span class="ot">)</span></code></pre></div>
<p>Here we see that integer values like the <code>port</code> leaves are represented directly as Lua numbers, if they fit within the <code>uint32</code> or <code>int32</code> range. Integers outside that range are represented as <code>uint64_t</code> if they are positive, or <code>int64_t</code> otherwise.</p>
<p>Boolean values are represented using normal Lua booleans, of course.</p>
<p>String values are just parsed to Lua strings, with the normal Lua limitation that UTF-8 data is not decoded. Lua strings look like strings but really they are byte arrays.</p>
<p>There is special support for the <code>ipv4-address</code>, <code>ipv4-prefix</code>, <code>ipv6-address</code>, and <code>ipv6-prefix</code> types from <code>ietf-inet-types</code>, and <code>mac-address</code> from <code>ietf-yang-types</code>. Values of these types are instead parsed to raw binary data that is compatible with the relevant parts of Snabb’s <code>lib.protocol</code> facility.</p>
<p>Let us return to the representation of compound configurations, like <code>list</code> instances. A compound configuration whose shape is <em>fixed</em> is compiled to raw FFI data. A configuration’s shape is determined by its schema. A schema node whose data will be fixed is either a leaf whose type is numeric or boolean and which is either mandatory or has a default value, or a container (<code>leaf-list</code>, <code>container</code>, or <code>list</code>) whose elements are all themselves fixed.</p>
<p>In practice this means that a fixed <code>container</code> will be compiled to an FFI <code>struct</code> type. This is mostly transparent from the user perspective, as in LuaJIT you access struct members by name in the same way as for normal Lua tables.</p>
<p>A fixed <code>leaf-list</code> will be compiled to an FFI array of its element type, but on the Lua side is given the normal 1-based indexing and support for the <code>#len</code> length operator via a wrapper. A non-fixed <code>leaf-list</code> is just a Lua array (a table with indexes starting from 1).</p>
<p>Instances of <code>list</code> nodes can have one of several representations. (Recall that in YANG, <code>list</code> is not a list in the sense that we normally think of it in programming languages, but rather is a kind of hash map.)</p>
<p>If there is only one key leaf, and that leaf has a string type, then a configuration list is represented as a normal Lua table whose keys are the key strings, and whose values are Lua structures holding the leaf values, as in containers. (In fact, it could be that the value of a string-key struct is represented as a C struct, as in raw containers.)</p>
<p>If all key and value types are fixed, then a <code>list</code> configuration compiles to an efficient <a href="../README.ctable.md"><code>ctable</code></a>.</p>
<p>If all keys are fixed but values are not, then a <code>list</code> configuration compiles to a <a href="../README.cltable.md"><code>cltable</code></a>.</p>
<p>Otherwise, a <code>list</code> configuration compiles to a Lua table whose keys are Lua tables containing the keys. This sounds good on the surface but really it’s a pain, because you can’t simply look up a value in the table like <code>foo[{key1=42,key2=50}]</code>, because lookup in such a table is by identity and not be value. Oh well. You can still do <code>for k,v in pairs(foo)</code>, which is often good enough in this case.</p>
<p>Note that there are a number of value types that are not implemented, including some important ones like <code>union</code>.</p>
<p>— Function <strong>load_config_for_schema_by_name</strong> <em>schema_name</em> <em>name</em> <em>filename</em></p>
<p>Like <code>load_config_for_schema</code>, but identifying the schema by name instead of by value, as in <code>load_schema_by_name</code>.</p>
<p>— Function <strong>print_config_for_schema</strong> <em>schema</em> <em>data</em> <em>file</em></p>
<p>Serialize the configuration <em>data</em> as text via repeated calls to the <code>write</code> method of <em>file</em>. At the end, the <code>flush</code> method is called on <em>file</em>. <em>schema</em> is the schema that describes <em>data</em>.</p>
<p>— Function <strong>compile_config_for_schema</strong> <em>schema</em> <em>data</em> <em>filename</em> <em>mtime</em></p>
<p>Compile <em>data</em>, using a compiler generated for <em>schema</em>, and write out the result to the file named <em>filename</em>. <em>mtime</em>, if given, should be a table with <code>secs</code> and <code>nsecs</code> keys indicating the modification time of the source file. This information will be serialized in the compiled file, and may be used when loading the file to determine whether the configuration is up to date.</p>
<p>— Function <strong>compile_config_for_schema_by_name</strong> <em>schema_name</em> <em>data</em> <em>filename</em> <em>mtime</em></p>
<p>Like <code>compile_config_for_schema_by_name</code>, but identifying the schema by name instead of by value, as in <code>load_schema_by_name</code>.</p>
<p>— Function <strong>load_compiled_data_file</strong> <em>filename</em></p>
<p>Load the compiled data file at <em>filename</em>. If the file is not a compiled YANG configuration, an error will be signalled. The return value will be table containing four keys:</p>
<ul>
<li><code>schema_name</code>: The name of the schema for which this file was compiled.</li>
<li><code>revision_date</code>: The revision date of the schema for which this file was compiled, or the empty string (<code>''</code>) if unknown.</li>
<li><code>source_mtime</code>: An <code>mtime</code> table, as for <code>compile_config_for_schema</code>. If no mtime was written into the file, both <code>secs</code> and <code>nsecs</code> will be zero.</li>
<li><code>data</code>: The configuration data, in the same format as returned by <code>load_config_for_schema</code>.</li>
</ul>
<h2 id="hardware">Hardware</h2>
<h3 id="pci-lib.hardware.pci">PCI (lib.hardware.pci)</h3>
<p>The <code>lib.hardware.pci</code> module provides functions that abstract common operations on PCI devices on Linux. In order to drive a PCI device using <a href="https://en.wikipedia.org/wiki/Direct_memory_access">Direct memory access (DMA)</a> one must:</p>
<ol style="list-style-type: decimal">
<li>Unbind the PCI device using <code>pci.unbind_device_from_linux</code>.</li>
<li>Enable PCI bus mastering for device using <code>pci.set_bus_master</code> in order to enable DMA.</li>
<li>Memory map PCI device configuration space using <code>pci.map_pci_memory</code>.</li>
<li>Control the PCI device by manipulating the memory referenced by the pointer returned by <code>pci.map_pci_memory</code>.</li>
<li>Disable PCI bus master for device using <code>pci.set_bus_master</code>.</li>
<li>Unmap PCI device configuration space using <code>pci.close_pci_resource</code>.</li>
</ol>
<p>The correct ordering of these steps is absolutely critical.</p>
<p>— Variable <strong>pci.devices</strong></p>
<p>An array of supported hardware devices. Must be populated by calling <code>pci.scan_devices</code>. Each entry is a table as returned by <code>pci.device_info</code>.</p>
<p>— Function <strong>pci.canonical</strong> <em>pciaddress</em></p>
<p>Returns the canonical representation of a PCI address. The canonical representation is preferred internally in Snabb and for presenting to users. It shortens addresses with leading zeros like this: <code>0000:01:00.0</code> becomes <code>01:00.0</code>.</p>
<p>— Function <strong>pci.qualified</strong> <em>pciaddress</em></p>
<p>Returns the fully qualified representation of a PCI address. Fully qualified addresses have the form <code>0000:01:00.0</code> and so this function undoes any abbreviation in the canonical representation.</p>
<p>— Function <strong>pci.scan_devices</strong></p>
<p>Scans for available PCI devices and populates the <code>pci.devices</code> table.</p>
<p>— Function <strong>pci.device_info</strong> <em>pciaddress</em></p>
<p>Returns a table containing information about the PCI device by <em>pciaddress</em>. The table has the following keys:</p>
<ul>
<li><code>pciaddress</code>—String denoting the PCI address of the device. E.g. <code>&quot;0000:83:00.1&quot;</code>.</li>
<li><code>vendor</code>—Identification string e.g. <code>&quot;0x8086&quot;</code> for Intel.</li>
<li><code>device</code>—Identification string e.g. <code>&quot;0x10fb&quot;</code> for 82599 chip.</li>
<li><code>interface</code>—Name of Linux interface using this device e.g. <code>&quot;eth0&quot;</code>.</li>
<li><code>status</code>—String denoting the Linux operational status, or <code>nil</code> if not known.</li>
<li><code>driver</code>—String denoting the Lua module that supports this hardware e.g. <code>&quot;apps.intel.intel10g&quot;</code>.</li>
<li><code>usable</code>—String denoting if the device was suitable to use when scanned. One of <code>&quot;yes&quot;</code> or <code>&quot;no&quot;</code>.</li>
</ul>
<p>— Function <strong>pci.which_driver</strong> <em>vendor</em>, <em>model</em></p>
<p>Returns the module name for a suitable device driver (if available) for a device of <em>model</em> from <em>vendor</em>.</p>
<p>— Function <strong>pci.unbind_device_from_linux</strong> <em>pciaddress</em></p>
<p>Forces Linux to unbind the device identified by <em>pciaddress</em> from any kernel drivers.</p>
<p>— Function <strong>pci.set_bus_master</strong> <em>pciaddress</em>, <em>enable</em></p>
<p>Enables or disables PCI bus mastering for device identified by <em>pciaddress</em> depending on whether <em>enable</em> is a true or a false value. PCI bus mastering must be enabled in order to perform DMA on the PCI device.</p>
<p>— Function <strong>pci.map_pci_memory_unlocked</strong> <em>pciaddress</em>, <em>n</em> — Function <strong>pci.map_pci_memory_locked</strong> <em>pciaddress</em>, <em>n</em></p>
<p>Memory maps configuration space <em>n</em> of PCI device identified by <em>pciaddress</em>. Returns a pointer to the memory mapped region and a file descriptor of the opened sysfs resource file. PCI bus mastering must be enabled on the device identified by <em>pciaddress</em> before calling this function. The 2 variants indicate if the underlying memory mapped file should be exclusively <code>flocked</code> or not.</p>
<p>— Function <strong>pci.close_pci_resource</strong> <em>file_descriptor</em>, <em>pointer</em></p>
<p>Closes memory mapped <em>file_descriptor</em> of sysfs resource file and unmaps it from <em>pointer</em> as returned by <code>pci.map_pci_memory</code>.</p>
<h3 id="register-lib.hardware.register">Register (lib.hardware.register)</h3>
<p>The <code>lib.hardware.register</code> module provides an abstraction for hardware device registers. This abstraction can be used to declaratively specify and conveniently manipulate structured memory regions via DMA. The functions <code>register.define</code> and <code>register.define_array</code> construct <code>Register</code> objects based on a <em>register description</em> string. The resulting <code>Register</code> objects can be used to manipulate the defined registers using the methods <code>Register:read</code>, <code>Register:write</code>, <code>Register:set</code>, <code>Register:clr</code>, <code>Register:wait</code> and <code>Register:reset</code> (exact set depends on the <em>register mode</em>).</p>
<p>A register description is a string with one <code>Register</code> object definition per line. A <code>Register</code> object definition must be expressed using the following grammar:</p>
<pre><code>Register   ::= Name Offset Indexing Mode Longname
Name       ::= &lt;identifier&gt;
Indexing   ::= &quot;-&quot;
           ::= &quot;+&quot; OffsetStep &quot;*&quot; Min &quot;..&quot; Max
Mode       ::= &quot;RO&quot; | &quot;RW&quot; | &quot;RC&quot; | &quot;RCR&quot; | &quot;RW64&quot; | &quot;RO64&quot; | &quot;RC64&quot; | &quot;RCR64&quot;
Longname   ::= &lt;string&gt;
Offset ::= OffsetStep ::= Min ::= Max ::= &lt;number&gt;</code></pre>
<p>A <code>Register</code> object definition is made up of the following properties:</p>
<ul>
<li><em>Name</em>—A string to be used to refer to the <code>Register</code> object. Must be a valid Lua identifier, e.g. <code>&quot;foo&quot;</code>, <code>&quot;foo_bar&quot;</code>, <code>&quot;FOO&quot;</code> etc.</li>
<li><em>Offset</em>—Integer specifying the offset from the base pointer (as supplied to <code>register.define</code> and <code>register.define_array</code>).</li>
<li><em>Indexing</em>—Optional. Three integers specifying the offset step as well as minimum and maximum indexes in bytes.</li>
<li><em>Mode</em>—One of <code>&quot;RO&quot;</code>, <code>&quot;RW&quot;</code>, <code>&quot;RC&quot;</code>, <code>&quot;RCR&quot;</code> <code>&quot;RO64&quot;</code>, <code>&quot;RW64&quot;</code>, <code>&quot;RC64&quot;</code>, <code>&quot;RCR64&quot;</code> standing for <em>read-only</em>, <em>read-write</em> and <em>counter</em> modes in 32bit and 64bit modes respectively. Counter mode is for counter registers that clear back to zero when read, RCR is for counters that wrap.</li>
<li><em>Longname</em>—A string describing the register (used for self-documentation).</li>
</ul>
<p>For instance, the following <code>Register</code> object definition defines a register range “TXDCTL” in read-write mode starting at offset 0x06028 with 128 registers each of length 0x40.</p>
<pre><code>TXDCTL 0x06028 +0x40*0..127 RW Transmit Descriptor Control</code></pre>
<p>The next example defines a singular register “TPT” in counter mode located at offset 0x01428.</p>
<pre><code>TPT 0x01428 - RC Total Packets Transmitted</code></pre>
<p>— Function <strong>register.define</strong> <em>description</em>, <em>table</em>, <em>base_pointer</em>, <em>n</em></p>
<p>Creates <code>Register</code> objects for <em>description</em> relative to <em>base_pointer</em>. The resulting <code>Register</code> objects will become a named entries in <em>table</em> using the names defined in <em>description</em>. If an entry in <em>description</em> defines an indexing range then <em>n</em> specifies the index of the register within that range. <em>N</em> defaults to 0.</p>
<p>— Function <strong>register.define_array</strong> <em>description</em>, <em>table</em>, <em>base_pointer</em></p>
<p>Creates <code>Register</code> objects for <em>description</em> relative to <em>base_pointer</em>. The resulting <code>Register</code> objects will become a named entries in <em>table</em> using the names defined in <em>description</em>. If an entry in <em>description</em> defines an indexing range, an array of <code>Register</code> objects will be created instead of a singular <code>Register</code> object.</p>
<p>— Function <strong>register.dump</strong> <em>table</em></p>
<p>Prints a pretty-printed register dump of a <em>table</em> of registers.</p>
<p>— Method <strong>Register:read</strong></p>
<p>Returns the value of register. For convenience register objects can be called without arguments instead of calling <code>Register:read</code>. E.g. <code>reg:read()</code> is equivalent to <code>reg()</code>.</p>
<p>— Method <strong>Register:write</strong> <em>value</em></p>
<p>Sets the value of register to <em>value</em>. Only available on registers in read-write mode. For convenience register objects can be called with an argument instead of calling <code>Register:write</code>. E.g. <code>reg:write(value)</code> is equivalent to <code>reg(value)</code>.</p>
<p>If register is in counter mode it is assumed that the register will be reset to zero upon reading. The read value is added to a <em>register accumulator</em> and the sum of all reads is returned.</p>
<p>— Method <strong>Register:set</strong> <em>bitmask</em></p>
<p>Sets bits of register according to <em>bitmask</em>. Only available on registers in read-write mode.</p>
<p>— Method <strong>Register:clr</strong> <em>bitmask</em></p>
<p>Clears bits of register according to <em>bitmask</em>. Only available on registers in read-write mode.</p>
<ul>
<li>Method <strong>Register:bits</strong> <em>offset</em>, <em>length</em>, <em>bits</em></li>
</ul>
<p>Get or set <em>length</em> bits at <em>offset</em> in register. Sets <em>length</em> bits at <em>offset</em> in register to <em>bits</em> if <em>bits</em> is supplied. Returns <em>length</em> bits at <em>offset</em> in register otherwise. Setting is only available on registers in read-write mode.</p>
<ul>
<li>Method <strong>Register:byte</strong> <em>offset</em>, <em>byte</em></li>
</ul>
<p>Get or set byte at <em>offset</em> in register. Sets byte at <em>offset</em> in register to <em>byte</em> if <em>byte</em> is supplied. Returns byte at <em>offset</em> in register otherwise. Setting is only available on registers in read-write mode.</p>
<p>— Method <strong>Register:wait</strong> <em>bitmask</em>, <em>value</em></p>
<p>Blocks until applying <em>bitmask</em> to the register equals <em>value</em>. If <em>value</em> is not supplied blocks until all bits in the mask are set instead. Only available on registers in read-write and read-only modes.</p>
<p>— Method <strong>Register:reset</strong></p>
<p>Reset the register accumulator to 0. Only available on registers in counter mode.</p>
<p>— Method <strong>Register:print</strong></p>
<p>Prints the register state to standard output.</p>
<h2 id="protocols">Protocols</h2>
<h3 id="protocol-header-lib.protocol.header">Protocol Header (lib.protocol.header)</h3>
<p>The <code>lib.protocol.header</code> module contains the base class from which the supported protocol classes are derived. It defines generic methods on all protocol subclasses.</p>
<p>— Method <strong>header:new_from_mem</strong> <em>memory</em>, <em>length</em></p>
<p>Creates and returns a header object by “overlaying” the respective header structure over <em>length</em> bytes of <em>memory</em>. Returns <code>nil</code> if <em>length</em> is too small to contain the header.</p>
<p>— Method <strong>header:header</strong></p>
<p>Returns the raw header as a <em>cdata</em> object.</p>
<p>— Method <strong>header:sizeof</strong></p>
<p>Returns the byte size of header.</p>
<p>— Method <strong>header:eq</strong> <em>header</em></p>
<p>Generic equality predicate. Returns <code>true</code> if <em>header</em> is equal to self and <code>false</code> otherwise.</p>
<p>— Method <strong>header:copy</strong> <em>destination</em>, <em>relocate</em></p>
<p>Copies the header to <em>destination</em>. The caller must ensure that there is enough space at <em>destination</em>. If <em>relocate</em> is a true value, <em>destination</em> is promoted to be the active storage for the header.</p>
<p>— Method <strong>header:clone</strong></p>
<p>Returns a copy of the header object.</p>
<p>— Method <strong>header:upper_layer</strong></p>
<p>Returns the protocol class that can handle the “upper layer protocol” or <code>nil</code> if the protocol is not supported or the protocol has no upper layer.</p>
<p>For instance, on an Ethernet header object this method might return a IPv4 or IPv6 header class.</p>
<h3 id="ethernet-lib.protocol.ethernet">Ethernet (lib.protocol.ethernet)</h3>
<p>The <code>lib.protocol.ethernet</code> module contains a class for representing <em>Ethernet headers</em>. The <code>ethernet</code> protocol class supports two upper layer protocols: <code>lib.protocol.ipv4</code> and <code>lib.protocol.ipv6</code>.</p>
<p>— Method <strong>ethernet:new</strong> <em>config</em></p>
<p>Returns a new Ethernet header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>dst</code> - Destination MAC (binary representation). Default is <code>00:00:00:00:00:00</code>.</li>
<li><code>src</code> - Source MAC (binary representation). Default is <code>00:00:00:00:00:00</code>.</li>
<li><code>type</code> - Either <code>0x0800</code> or <code>0x86dd</code> for IPv4/6 individually. Default is <code>0x0</code>.</li>
</ul>
<p>— Method <strong>ethernet:src</strong> <em>mac</em></p>
<p>— Method <strong>ethernet:dst</strong> <em>mac</em></p>
<p>— Method <strong>ethernet:type</strong> <em>type</em></p>
<p>Combined accessor and setter methods. These methods set the values of the source, destination and type fields of an Ethernet header. If no argument is given the current value is returned.</p>
<p>Example:</p>
<pre><code>local eth = ethernet:new({src = ethernet:pton(&quot;00:00:00:00:00:00&quot;),
                          dst = ethernet:pton(&quot;00:00:00:00:00:00&quot;),
                          type = 0x86dd})
eth:dst(ethernet:pton(&quot;54:52:00:01:00:00&quot;))
ethernet:ntop(eth:dst()) =&gt; &quot;54:52:00:01:00:00&quot;</code></pre>
<p>— Method <strong>ethernet:src_eq</strong> <em>mac</em></p>
<p>— Method <strong>ethernet:dst_eq</strong> <em>mac</em></p>
<p>Predicate methods to test if <em>mac</em> is equal to the source or destination addresses individually.</p>
<p>— Method <strong>ethernet:swap</strong></p>
<p>Swaps the values of the source and destination fields.</p>
<p>— Function <strong>ethernet:pton</strong> <em>string</em></p>
<p>Returns the binary representation of MAC address denoted by <em>string</em>.</p>
<p>— Function <strong>ethernet:ntop</strong> <em>mac</em></p>
<p>Returns the string representation of <em>mac</em> address.</p>
<p>— Function <strong>ethernet:is_mcast</strong> <em>mac</em></p>
<p>Returns a true value if <em>mac</em> address denotes a <a href="https://en.wikipedia.org/wiki/Multicast_address#Ethernet">Multicast address</a>.</p>
<p>— Function <strong>ethernet:is_bcast</strong> <em>mac</em></p>
<p>Returns a true value if <em>mac</em> address denotes a <a href="https://en.wikipedia.org/wiki/Broadcast_address#Ethernet">Broadcast address</a>.</p>
<p>— Function <strong>ethernet:ipv6_mcast</strong> <em>ip</em></p>
<p>Returns the MAC address for IPv6 multicast <em>ip</em> as defined by RFC2464, section 7.</p>
<h3 id="ipv4-lib.protocol.ipv4">IPv4 (lib.protocol.ipv4)</h3>
<p>The <code>lib.protocol.ipv4</code> module contains a class for representing <em>IPv4 headers</em>. The <code>ipv4</code> protocol class supports four upper layer protocols: <code>lib.protocol.tcp</code>, <code>lib.protocol.udp</code>, <code>lib.protocol.gre</code> and <code>lib.protocol.icmp.header</code>.</p>
<p>— Method <strong>ipv4:new</strong> <em>config</em></p>
<p>Returns a new IPv4 header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>dst</code> - Destination IPv4 address (binary representation). Default is <code>0.0.0.0</code>.</li>
<li><code>src</code> - Source IPv4 address (binary representation). Default is <code>0.0.0.0</code>.</li>
<li><code>protocol</code> - The upper layer protocol, can be 6 (TCP), 17 (UDP), 47 (GRE) or 58 (ICMP). Default is 255.</li>
<li><code>dscp</code> - “Differentiated Services Code Point” field (6 bit unsigned integer). Default is 0.</li>
<li><code>ecn</code> - “Explicit Congestion Notification” field (2 bit unsigned integer). Default is 0.</li>
<li><code>id</code> - “Identification” field (16 bit unsigned integer). Default is 0.</li>
<li><code>flags</code> - “Don’t Fragment (DF)” and “More Fragments (MF)” fields (3 bit unsigned integer). Default is 0.</li>
<li><code>frag_off</code> - “Fragment Offset” field (13 bit unsigned integer). Default is 0.</li>
<li><code>ttl</code> - “Time To Live” field (8 bit unsigned integer). Default is 0.</li>
</ul>
<p>— Method <strong>ipv4:dst</strong> <em>ip</em></p>
<p>— Method <strong>ipv4:src</strong> <em>ip</em></p>
<p>— Method <strong>ipv4:protocol</strong> <em>protocol</em></p>
<p>— Method <strong>ipv4:dscp</strong> <em>dscp</em></p>
<p>— Method <strong>ipv4:ecn</strong> <em>ecn</em></p>
<p>— Method <strong>ipv4:id</strong> <em>id</em></p>
<p>— Method <strong>ipv4:flags</strong> <em>flags</em></p>
<p>— Method <strong>ipv4:frag_off</strong> <em>frag_off</em></p>
<p>— Method <strong>ipv4:ttl</strong> <em>ttl</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of an IPv4 header. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv4:version</strong> <em>version</em></p>
<p>Combined accessor and setter method for the “Version” field (4 bit unsigned integer). Defaults to 4 (set automatically by <code>new</code>). Sets the “Version” field to <em>version</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv4:ihl</strong> <em>ihl</em></p>
<p>Combined accessor and setter method for the “Internet Header Length” field (4 bit unsigned integer). Set automatically by <code>new</code>. Sets the “Internet Header Length” field to <em>ihl</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv4:total_length</strong> <em>length</em></p>
<p>Combined accessor and setter method for the “Total Length” field (16 bit unsigned integer). Defaults to header length (set automatically by <code>new</code>). Sets the “Total Length” field to <em>length</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv4:checksum</strong></p>
<p>Computes and sets the IPv4 header checksum. Its called automatically by <code>new</code> but must be called after the header is changed.</p>
<p>— Method <strong>ipv4:dst_eq</strong> <em>ip</em></p>
<p>— Method <strong>ipv4:src_eq</strong> <em>ip</em></p>
<p>Predicate methods to test if <em>ip</em> is equal to the source or destination addresses individually.</p>
<p>— Function <strong>ipv4:pton</strong> <em>string</em></p>
<p>Returns the binary representation of IPv4 address denoted by <em>string</em>.</p>
<p>— Function <strong>ipv4:ntop</strong> <em>ip</em></p>
<p>Returns the string representation of <em>ip</em> address.</p>
<h3 id="ipv6-lib.protocol.ipv6">IPv6 (lib.protocol.ipv6)</h3>
<p>The <code>lib.protocol.ipv6</code> module contains a class for representing <em>IPv6 headers</em>. The <code>ipv6</code> protocol class supports four upper layer protocols: <code>lib.protocol.tcp</code>, <code>lib.protocol.udp</code>, <code>lib.protocol.gre</code> and <code>lib.protocol.icmp.header</code>.</p>
<p>— Method <strong>ipv6:new</strong> <em>config</em></p>
<p>Returns a new IPv6 header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>dst</code> - Destination IPv6 address (binary representation). Default is <code>0::0</code>.</li>
<li><code>src</code> - Source IPv6 address (binary representation). Default is <code>0::0</code>.</li>
<li><code>traffic_class</code> - “Traffic Class” field (8 bit unsigned integer). Default is 0.</li>
<li><code>flow_label</code> - “Flow Label” field (20 bit unsigned integer). Default is 0.</li>
<li><code>next_header</code> - “Next Header” field (8 bit unsigned integer). Default is 0.</li>
<li><code>hop_limit</code> - “Hop Limit” field (8 bit unsigned integer). Default is 0.</li>
</ul>
<p>— Method <strong>ipv6:dst</strong> <em>ip</em></p>
<p>— Method <strong>ipv6:src</strong> <em>ip</em></p>
<p>— Method <strong>ipv6:traffic_class</strong> <em>traffic_class</em></p>
<p>— Method <strong>ipv6:flow_label</strong> <em>flow_label</em></p>
<p>— Method <strong>ipv6:next_header</strong> <em>next_header</em></p>
<p>— Method <strong>ipv6:hop_limit</strong> <em>hop_limit</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of an IPv6 header. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:version</strong> <em>version</em></p>
<p>Combined accessor and setter method for the version field (4 bit unsigned integer). Defaults to 6 (set automatically by <code>new</code>). Sets the “Version” field to <em>version</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:dscp</strong> <em>dscp</em></p>
<p>Combined accessor and setter method for the “Differentiated Services Code Point” field (6 bit unsigned integer). Default is 0. This is a sub-field of the “Traffic Class” field. Sets the “Differentiated Services Code Point” field to <em>dscp</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:ecn</strong> <em>ecn</em></p>
<p>Combined accessor and setter method for the “Explicit Congestion Notification” (2 bit unsigned integer). Default is 0. This is a sub-field of the “Traffic Class” field. Sets the “Explicit Congestion Notification” field to <em>ecn</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:payload_length</strong> <em>length</em></p>
<p>Combined accessor and setter method for the “Payload Length” field (16 bit unsigned integer). Default is 0. Sets the “Payload Length” field to <em>length</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ipv6:dst_eq</strong> <em>ip</em></p>
<p>— Method <strong>ipv6:src_eq</strong> <em>ip</em></p>
<p>Predicate methods to test if <em>ip</em> is equal to the source or destination addresses individually.</p>
<p>— Function <strong>ipv6:pton</strong> <em>string</em></p>
<p>Returns the binary representation of IPv6 address denoted by <em>string</em>.</p>
<p>— Function <strong>ipv6:ntop</strong> <em>ip</em></p>
<p>Returns the string representation of <em>ip</em> address.</p>
<p>— Function <strong>ipv6:solicited_node_mcast</strong> <em>ip</em></p>
<p>Returns the solicited-node multicast address from the given unicast <em>ip</em>.</p>
<h3 id="tcp-lib.protocol.tcp">TCP (lib.protocol.tcp)</h3>
<p>The <code>lib.protocol.tcp</code> module contains a class for representing <em>TCP headers</em>.</p>
<p>— Method <strong>tcp:new</strong> <em>config</em></p>
<p>Returns a new TCP header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>src_port</code> - “Source Port Number” field (16 bit unsigned integer). Default is 0.</li>
<li><code>dst_port</code> - “Destination Port Number” field (16 bit unsigned integer). Default is 0.</li>
<li><code>seq_num</code> - “Sequence Number” field (32 bit unsigned integer). Default is 0.</li>
<li><code>ack_num</code> - “Acknowledgement Number” field (32 bit unsigned integer). Default is 0.</li>
<li><code>window_size</code> - “Window Size” field (16 bit unsigned integer). Default is 0.</li>
<li><code>offset</code> - “Data Offset” field (4 bit unsigned integer). Default is 0.</li>
<li><code>ns</code> - “NS” flag (1 bit). Default is 0.</li>
<li><code>cwr</code> - “CWR” flag (1 bit). Default is 0.</li>
<li><code>ece</code> - “ECE” flag (1 bit). Default is 0.</li>
<li><code>urg</code> - “URG” flag (1 bit). Default is 0.</li>
<li><code>ack</code> - “ACK” flag (1 bit). Default is 0.</li>
<li><code>psh</code> - “PSH” flag (1 bit). Default is 0.</li>
<li><code>rst</code> - “RST” flag (1 bit). Default is 0.</li>
<li><code>syn</code> - “SYN” flag (1 bit). Default is 0.</li>
<li><code>fin</code> - “FIN” flag (1 bit). Default is 0.</li>
</ul>
<p>— Method <strong>tcp:src_port</strong> <em>port</em></p>
<p>— Method <strong>tcp:dst_port</strong> <em>port</em></p>
<p>— Method <strong>tcp:seq_num</strong> <em>seq_num</em></p>
<p>— Method <strong>tcp:ack_num</strong> <em>ack_num</em></p>
<p>— Method <strong>tcp:window_size</strong> <em>window_size</em></p>
<p>— Method <strong>tcp:offset</strong> <em>offset</em></p>
<p>— Method <strong>tcp:ns</strong> <em>ns</em></p>
<p>— Method <strong>tcp:cwr</strong> <em>cwr</em></p>
<p>— Method <strong>tcp:ece</strong> <em>ece</em></p>
<p>— Method <strong>tcp:urg</strong> <em>urg</em></p>
<p>— Method <strong>tcp:ack</strong> <em>ack</em></p>
<p>— Method <strong>tcp:psh</strong> <em>psh</em></p>
<p>— Method <strong>tcp:rst</strong> <em>rst</em></p>
<p>— Method <strong>tcp:syn</strong> <em>syn</em></p>
<p>— Method <strong>tcp:fin</strong> <em>fin</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of a TCP header. If no argument is given the current value is returned.</p>
<p>— Method <strong>tcp:flags</strong> <em>flags</em></p>
<p>Combined accessor and setter method for the TCP header flags (NS, CRW, ECE, URG, ACK, PSH, RST, SYN and FIN). Sets the header’s flags accoring to <em>flags</em> (9 bit unsigned intetger). If no argument is given the current flags are returned.</p>
<p>— Method <strong>tcp:checksum</strong> <em>payload</em>, <em>length</em>, <em>ip</em></p>
<p>Computes and sets the “Checksum” field for <em>length</em> bytes of <em>payload</em> and optionally <em>ip</em>. If no argument is given the current value of the “Checksum” field is returned.</p>
<h3 id="udp-lib.protocol.udp">UDP (lib.protocol.udp)</h3>
<p>The <code>lib.protocol.udp</code> module contains a class for representing <em>UDP headers</em>.</p>
<p>— Method <strong>udp:new</strong> <em>config</em></p>
<p>Returns a new UDP header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>src_port</code> - “Source Port Number” field (16 bit unsigned integer). Default is 0.</li>
<li><code>dst_port</code> - “Destination Port Number” field (16 bit unsigned integer). Default is 0.</li>
</ul>
<p>— Method <strong>udp:src_port</strong> <em>port</em></p>
<p>— Method <strong>udp:dst_port</strong> <em>port</em></p>
<p>Combined accessor and setter methods for the source and destination port fields. Sets the source or destination port individually. Returns the current port if called without arguments. Default is 8 (the UDP header length).</p>
<p>— Method <strong>udp:length</strong> <em>length</em></p>
<p>Combined accessor and setter method for the “Length” field. Sets the “Length” field* to <em>length</em> (a 16 bit unsigned integer). If no argument is given the current value of the “Length” field is returned.</p>
<p>— Method <strong>udp:checksum</strong> <em>payload</em>, <em>length</em>, <em>ip</em></p>
<p>Computes and sets the “Checksum” field for <em>length</em> bytes of <em>payload</em> and optionally <em>ip</em>. If no argument is given the current value of the “Checksum” field is returned.</p>
<h3 id="gre-lib.protocol.gre">GRE (lib.protocol.gre)</h3>
<p>The <code>lib.protocol.gre</code> module contains a class for representing <em>GRE headers</em>. The <code>gre</code> protocol class only supports the checksum and key extensions and the <code>lib.protocol.ethernet</code> upper layer protocol.</p>
<p>— Method <strong>gre:new</strong> <em>config</em></p>
<p>Returns a new GRE header for <em>config</em>. <em>Config</em> must a be a table which may contain the following keys:</p>
<ul>
<li><code>protocol</code> - Upper layer protocol. May be <code>0x6558</code> (Ethernet). Default is <code>nil</code>.</li>
<li><code>checksum</code> - Set to <code>true</code> to enable checksumming. Default is <code>false</code>.</li>
<li><code>key</code> - 32 bit unsigned integer. Enables keying if supplied. Default is <code>nil</code>.</li>
</ul>
<p>— Method <strong>gre:checksum</strong> <em>payload</em>, <em>length</em></p>
<p>Combined accessor and setter method for the checksum field. Computes and sets the checksum field for <em>length</em> bytes of <em>payload</em>. If no argument is given the current checksum is returned. Returns <code>nil</code> if checksumming is disabled.</p>
<p>— Method <strong>gre:checksum_check</strong> <em>payload</em>, <em>length</em></p>
<p>Predicate to verify <em>length</em> bytes of <em>payload</em> against the header checkum. Return <code>nil</code> if checksumming is disabled.</p>
<p>— Method <strong>gre:key</strong> <em>key</em></p>
<p>Combined accessor and setter method for the key field. Sets the key field to <em>key</em>. If no argument is given the current key is returned. Returns <code>nil</code> if keying is disabled.</p>
<p>— Method <strong>gre:protocol</strong> <em>protocol</em></p>
<p>Combined accessor and setter method for the upper layer protocol. Sets the upper layer protocol to <em>protocol</em>. If no argument is given the current upper layer protocol is returned.</p>
<h3 id="icmp-lib.protocol.icmp.header">ICMP (lib.protocol.icmp.header)</h3>
<p>The <code>lib.protocol.icmp.header</code> module contains a class for representing <em>ICMP headers</em>. The <code>icmp</code> protocol class currently supports two upper layer protocols: <code>lib.protocol.icmp.nd.ns</code> and <code>lib.protocol.icmp.nd.na</code>. These upper layer protocols implement the headers necessary to perform “Neighbor Discovery”.</p>
<p>— Method <strong>icmp:new</strong> <em>type</em>, <em>code</em></p>
<p>Returns a new ICMP header of <em>type</em> which may be either 135 or 136 for <code>lib.protocol.icmp.nd.ns</code> or <code>lib.protocol.icmp.nd.na</code> respectively. Optionally <em>code</em> can be supplied to set the “Code” field for the type.</p>
<p>— Method <strong>icmp:type</strong> <em>type</em></p>
<p>— Method <strong>icmp:code</strong> <em>code</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of an ICMP header. If no argument is given the current value is returned.</p>
<p>— Method <strong>icmp:checksum</strong> <em>payload</em>, <em>length</em>, <em>ipv6</em></p>
<p>Computes and sets the “Checksum” field for <em>length</em> bytes of <em>payload</em>. If the lower protocol layer is <code>lib.protocol.ipv6</code> then <em>ipv6</em> must be set to a true value.</p>
<p>— Method <strong>icmp:checksum_check</strong> <em>payload</em>, <em>length</em>, <em>ipv6</em></p>
<p>Predicate to test if the header’s “Checksum” field matches <em>length</em> bytes of <em>payload</em>. If the lower protocol layer is <code>lib.protocol.ipv6</code> then <em>ipv6</em> must be set to a true value.</p>
<h4 id="neighbor-solicitation-lib.protocol.icmp.nd.ns">Neighbor Solicitation (lib.protocol.icmp.nd.ns)</h4>
<p>— Method <strong>ns:new</strong> <em>target</em></p>
<p>Returns a new <em>Neighbor Solicitation</em> header. <em>Target</em> is the IP address used for the “Target Address” field.</p>
<p>— Method <strong>ns:target</strong> <em>target</em></p>
<p>Combined accessor and setter method for the “Target Address” field. Sets the “Target Address” field to <em>target</em>. If no argument is given the current value is returned.</p>
<p>— Method <strong>ns:target_eq</strong> <em>target</em></p>
<p>Predicate to test if the header’s value in the “Target Address” field is equivalent to <em>target</em>.</p>
<h4 id="neighbor-advertisement-lib.protocol.icmp.nd.na">Neighbor Advertisement (lib.protocol.icmp.nd.na)</h4>
<p>— Method <strong>na:new</strong> <em>target</em>, <em>router</em>, <em>solicited</em>, <em>override</em></p>
<p>Returns a new <em>Neighbor Advertisement</em> header. <em>Target</em> is the IP address used for the “Target Address” field. <em>Router</em>, <em>solicited</em> and <em>override</em> can be boolean values to set the “Router”, “Solicited” and “Override” flags respectively. The default for the flags is 0.</p>
<p>— Method <strong>ns:target</strong> <em>target</em></p>
<p>— Method <strong>ns:router</strong> <em>router</em></p>
<p>— Method <strong>ns:solicited</strong> <em>solicited</em></p>
<p>— Method <strong>ns:override</strong> <em>override</em></p>
<p>Combined accessor and setter methods. These methods set the values of the instance fields (see <code>new</code>) of an Neighbor Advertisement header. If no argument is given the current value is returned.</p>
<p>— Method <strong>ns:target_eq</strong> <em>target</em></p>
<p>Predicate to test if the header’s value in the “Target Address” field is equivalent to <em>target</em>.</p>
<h4 id="neighbor-discovery-options-lib.protocol.icmp.nd.header">Neighbor Discovery Options (lib.protocol.icmp.nd.header)</h4>
<p>Both Neighbor Solicitation and Advertisement (<code>lib.protocol.icmp.nd.ns</code> and <code>lib.protocol.icmp.nd.na</code>) headers implement an <code>options</code> method for parsing <em>TLV Options</em> contained in the their payloads.</p>
<p>Example:</p>
<pre><code> -- Parse datagram with ICMP/NA packet
local na = dgram:parse()
 -- Parse TLV Options
local options = na:options(dgram:payload())</code></pre>
<p>— Method <strong>nd:options</strong> <em>payload</em>, <em>length</em></p>
<p>Parses and returns an array of TLV Options (see <code>lib.protocol.icmp.nd.options.tlv</code>) from <em>length</em> bytes of <em>payload</em>.</p>
<h4 id="tlv-option-lib.protocol.icmp.nd.options.tlv">TLV Option (lib.protocol.icmp.nd.options.tlv)</h4>
<p>The <code>lib.protocol.icmp.nd.options.tlv</code> module contains a class for representing TLV Options. Currently only two types of options are implemented: “Source Link-Layer Address” (<code>&quot;src_ll_addr&quot;</code>) and “Target Link-Layer Address” (<code>&quot;tgt_ll_address&quot;</code>). Both are represented by the <code>lladdr</code> class (see <code>lib.protocol.icmp.nd.options.lladdr</code>).</p>
<p>— Method <strong>tlv:new</strong> <em>type</em>, <em>data</em></p>
<p>Returns a new TLV Option object for <em>data</em> of <em>type</em>. <em>Type</em> may be either 1 for “Source Link-Layer Address” or 2 for “Target Link-Layer Address”. <em>Data</em> must be a <code>lladdr</code> object.</p>
<p>— Method <strong>tlv:name</strong></p>
<p>Returns a string denoting the type of the option. Either <code>&quot;src_ll_addr&quot;</code> for “Source Link-Layer Address” or <code>&quot;tgt_ll_address&quot;</code> for “Target Link-Layer Address”.</p>
<p>— Method <strong>tlv:length</strong></p>
<p>Returns the the size of the TLV Option as multiples of 8 bytes.</p>
<p>— Method <strong>tlv:type</strong> <em>type</em></p>
<p>Combined accessor and setter method. Sets the type field (see <code>new</code>) to <em>type</em>. If no argument is given the current value of the type field is returned.</p>
<p>— Method <strong>tlv:option</strong></p>
<p>Returns an object of the class denoted by the type field. Currently that only includes <code>lladdr</code> instances.</p>
<h4 id="link-layer-address-option-lib.protocol.icmp.nd.options.lladdr">Link-Layer Address Option (lib.protocol.icmp.nd.options.lladdr)</h4>
<p>The <code>lib.protocol.icmp.nd.options.lladdr</code> module contains a class for representing Link-Layer Address Options.</p>
<p>— Method <strong>lladdr:new</strong> <em>address</em></p>
<p>Returns a new Link-Layer Option object for MAC <em>address</em> in binary representation.</p>
<p>— Method <strong>lladdr:name</strong></p>
<p>Returns the string <code>&quot;ll_addr&quot;</code>.</p>
<p>— Method <strong>lladdr:addr</strong> <em>address</em></p>
<p>Combined accessor and setter method. Sets the address field (see <code>new</code>) to <em>address</em>. If no argument is given the current value of the address field is returned.</p>
<h3 id="datagram-lib.protocol.datagram">Datagram (lib.protocol.datagram)</h3>
<p>The <code>lib.protocol.datagram</code> module provides basic mechanisms for parsing, building and manipulating a hierarchy of protocol headers and the associated payload contained in a data packet. In particular, it supports:</p>
<ul>
<li>Parsing and in-place manipulation of protocol headers in a received packet</li>
<li>In-place decapsulation by removing leading protocol headers</li>
<li>Adding headers to an existing packet</li>
<li>Creation of a new packet</li>
<li>Appending payload to a packet</li>
</ul>
<p>It mediates between packets as defined in <code>core.packet</code> and <em>protocol classes</em> which are defined as classes derived from the protocol header base class in the <code>lib.protocol.header</code> module.</p>
<p>The contents of a datagram instance are logically divided into three areas: The payload, parsed headers and pushed headers. The datagram payload is a sequence of bytes either inherited from the packet given to <code>datagram:new</code> or appended using <code>datagram:payload</code>. The headers in the payload can be parsed using <code>datagram:parse_match</code>, which will shrink the payload by the header. Finally, synthetic headers can be prepended to the datagram using <code>datagram:push</code>. To get the whole datagram as a packet use <code>datagram:packet</code>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="Datagram" />
<p class="caption">Datagram</p>
</div>
<p>A datagram can be used in two modes of operation, called “immediate commit” and “delayed commit”. In immediate commit mode, the <code>push</code> and <code>pop</code> methods immediately modify the underlying packet. However, this can be undesireable.</p>
<p>Even though the manipulations are relatively fast by using SIMD instructions to move and copy data when possible, performance-aware applications usually try to avoid as much of them as possible. This creates a conflict if the caller performs operations to push or parse a sequence of protocol headers in immediate commit mode.</p>
<p>This problem can be avoided by using delayed commit mode. In this mode, the <code>push</code> methods add the data to a separate buffer as intermediate storage. The buffer is prepended to the actual packet in a single operation by calling <code>datagram:commit</code>.</p>
<p>The <code>pop</code> methods are made light-weight in delayed commit mode as well by keeping track of an additional offset that indicates where the actual packet starts in the packet buffer. Each call to one of the <code>pop</code> methods simply increases the offset by the size of the popped piece of data. The accumulated actions will be applied as a single operation by <code>datagram:commit</code>.</p>
<p>The <code>push</code> and <code>pop</code> methods can be freely mixed in delayed commit mode.</p>
<p>Due to the destructive nature of these methods in immediate commit mode, they cannot be applied when the parse stack is not empty, because moving the data in the packet buffer will invalidate the parsed headers. The <code>push</code> and <code>pop</code> methods will raise an error in that case.</p>
<p>The buffer used in delayed commit mode has a fixed size of 512 bytes. This limits the size of data that can be pushed in a single operation. A sequence of push/commit operations can be used to push an arbitrary amount of data in chunks of up to 512 bytes.</p>
<p>— Method <strong>datagram:new</strong> <em>packet</em>, <em>protocol</em>, <em>options</em></p>
<p>Creates a datagram for <em>packet</em> or from scratch if <em>packet</em> is <code>nil</code>. <em>Protocol</em> will be used by <code>parse_match</code> to parse the packet payload. If <em>protocol</em> is not <code>nil</code> it is set as the initial upper layer protocol. If <em>options</em> is not <code>nil</code> it must be a table that selects configurable properties of the class. Currently, the only option is the selection of immediate or delayed commit mode by setting the key <code>delayed_commit</code> to <code>false</code> or <code>true</code>, respectively. The default is immediate commit mode.</p>
<p>— Method <strong>datagram:push</strong> <em>header</em></p>
<p>Prepends <em>header</em> to the front of the datagram. This method destructively modifies the underlying packet in immediate commit mode and raises an error if the parse stack is not empty.</p>
<p>In delayed commit mode, <em>header</em> is prepended to an intermediate buffer.</p>
<p>— Method <strong>datagram:push_raw</strong> <em>data</em>, <em>length</em></p>
<p>This method behaves like the <em>datagram:push</em> method for an arbitrary chunk of memory of length <em>length</em> located at the address pointed to by <em>data</em>.</p>
<p>— Method <strong>datagram:parse_match</strong> <em>protocol</em>, <em>check</em></p>
<p>Attempts to parse the next header in the datagram, thereby removing it from the payload. Returns a header instance of class <em>protocol</em> on success. If <em>protocol</em> is <code>nil</code> the current upper layer protocol as set by <code>datagram:new</code> or previous calls to <code>parse_match</code> is used.</p>
<p>If neither <em>protocol</em> nor the upper layer protocol is set or the constructor of the protocol class returns <code>nil</code>, the parsing operation has failed and <code>parse_match</code> returns <code>nil</code>. The datagram remains unchanged.</p>
<p>If the protocol class instance has been created successfully, it is passed as single argument to the anonymous function <em>check</em>.</p>
<p>If <em>check</em> returns a false value, the parsing has failed and <code>parse_match</code> returns <code>nil</code>. The packet remains unchanged.</p>
<p>If <em>check</em> is not supplied or if it returned a true value, the parsing has succeeded and the current upper layer protocol of the datagram is set to the value returned by <code>header:upper_layer</code>.</p>
<p>— Method <strong>datagram:parse</strong> <em>protocols_and_checks</em></p>
<p>A wrapper around <code>parse_match</code> that allows parsing of a sequence of headers with a single method call.</p>
<p>If <em>protocols_and_checks</em> is a sequence of protocol class and check function pairs, <code>parse_match</code> is called for each pair. Returns the header object of the last header parsed or <code>nil</code> if any of the calls to <code>parse_match</code> return <code>nil</code>.</p>
<p>If called with a <code>nil</code> argument, this method is equivalent to <code>parse_match</code> called without arguments.</p>
<p>— Method <strong>datagram:parse_n</strong> <em>n</em></p>
<p>A wrapper around <code>parse_match</code> that parses the next <em>n</em> protocol headers using the current upper layer protocol and subsequent values of <code>header:upper_layer</code>. It returns the last header object or <code>nil</code> if less than <em>n</em> headers could be parsed successfully.</p>
<p>— Method <strong>datagram:unparse</strong> <em>n</em></p>
<p>Undoes the last <em>n</em> calls to <code>parse_match</code> on the datagram. E.g. prepends <em>n</em> parsed headers back to the payload. The sequence of parsed headers can be obtained by calling <code>stack</code>.</p>
<p>— Method <strong>datagram:pop</strong> <em>n</em></p>
<p>Removes the leading <em>n</em> parsed headers from the datagram. Note that headers added via <code>push</code> can not be removed using <code>pop</code>. The caller has to ensure that the datagram contains at least <em>n</em> headers that were parsed using <code>parse_match</code>. The sequence of parsed headers can be obtained by calling <code>stack</code>. This method destructively modifies the underlying packet in immediate commit mode and raises an error if the parse stack is not empty.</p>
<p>In delayed commit mode, the packet is not modified and the parse stack remains valid.</p>
<p>For instance let <em>d</em> be an datagram with an Ethernet header followed by an IPv6 header. Assuming we have parsed both headers using <code>d:parse_n(2)</code>, we could call <code>d:pop(1)</code> to decapsulate the IPv6 packet from its Ethernet header.</p>
<p>— Method <strong>datagram:pop_raw</strong> <em>length</em>, <em>ulp</em></p>
<p>Removes <em>length</em> bytes from the beginning of the datagram. If <em>ulp</em> is given it is set as the current upper layer protocol. This method destructively modifies the underlying packet in immediate commit mode and raises an error if the parse stack is not empty.</p>
<p>In delayed commit mode, the packet is not modified and the parse stack remains valid.</p>
<p>— Method <strong>datagram:stack</strong></p>
<p>Returns the parsed header objects as a sequence.</p>
<p>— Method <strong>datagram:packet</strong></p>
<p>Returns a packet (see <code>core.packet</code>) containing the datagram (including pushed headers).</p>
<p>— Method <strong>datagram:payload</strong> <em>pointer</em>, <em>length</em></p>
<p>Combined payload accessor and setter method. Returns a pointer to the datagram payload and its byte size.</p>
<p>If <em>pointer</em> and <em>length</em> are supplied then <em>length</em> bytes starting from <em>pointer</em> are appended to the datagram’s payload.</p>
<p>— Method <strong>datagram:data</strong></p>
<p>Returns <code>data</code> and <code>length</code> of the underlying packet.</p>
<ul>
<li>Method <strong>datagram:commit</strong></li>
</ul>
<p>If called in delayed commit mode, the operations accumulated by the <code>push</code> and <code>pop</code> methods since the creation of the datagram or the last invocation of <em>datagram:commit</em> are commited to the underlying packet. An error is raised if the parse stack is not empty.</p>
<p>The method can be safely called in immediate commit mode.</p>
<h2 id="ipsec">IPsec</h2>
<h3 id="encapsulating-security-payload-lib.ipsec.esp">Encapsulating Security Payload (lib.ipsec.esp)</h3>
<p>The <code>lib.ipsec.esp</code> module contains two classes <code>encrypt</code> and <code>decrypt</code> which implement packet encryption and decryption with IPsec ESP in both tunnel and transport modes. Currently, the only supported cipher is AES-GCM cipher with 128‑bit keys, 4 bytes of salt, and a 12 byte authentication code. These classes do not implement any key exchange protocol.</p>
<p>References:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/IPsec">IPsec Wikipedia page</a>.</li>
<li><a href="https://tools.ietf.org/html/rfc4303">RFC 4303</a> on IPsec ESP.</li>
<li><a href="https://tools.ietf.org/html/rfc4106">RFC 4106</a> on using AES-GCM with IPsec ESP.</li>
<li><a href="https://tools.ietf.org/html/draft-ietf-lisp-crypto-02">LISP Data-Plane Confidentiality</a> example of a software layer above these apps that includes key exchange.</li>
</ul>
<p>— Method <strong>encrypt:new</strong> <em>config</em></p>
<p>— Method <strong>decrypt:new</strong> <em>config</em></p>
<p>Returns a new encryption/decryption context respectively. <em>Config</em> must a be a table with the following keys:</p>
<ul>
<li><code>mode</code> - Encryption mode (string). The only accepted value is <code>&quot;aes-gcm-128-12&quot;</code>.</li>
<li><code>spi</code> - A 32 bit integer denoting the “Security Parameters Index” as specified in RFC 4303.</li>
<li><code>key</code> - Hexadecimal string of 32 digits (two digits for each byte, most significant digit first) that denotes 16 bytes of high-entropy key material as specified in RFC 4106.</li>
<li><code>salt</code> - Hexadecimal string of eight digits (two digits for each byte) that denotes four bytes of salt as specified in RFC 4106.</li>
<li><code>window_size</code> - <em>Optional</em>. Minimum width of the window in which out of order packets are accepted as specified in RFC 4303. The default is 128. (<code>decrypt</code> only.)</li>
<li><code>resync_threshold</code> - <em>Optional</em>. Number of consecutive packets allowed to fail decapsulation before attempting “Re-synchronization” as specified in RFC 4303. The default is 1024. (<code>decrypt</code> only.)</li>
<li><code>resync_attempts</code> - <em>Optional</em>. Number of attempts to re-synchronize a packet that triggered “Re-synchronization” as specified in RFC 4303. The default is 8. (<code>decrypt</code> only.)</li>
<li><code>auditing</code> - <em>Optional.</em> A boolean value indicating whether to enable or disable “Auditing” as specified in RFC 4303. The default is <code>nil</code> (no auditing). (<code>decrypt</code> only.)</li>
</ul>
<h4 id="tunnel-mode">Tunnel mode</h4>
<p>In tunnel mode, encapsulation accepts packets of any format and wraps them in an ESP frame, encrypting the original packet contents. Decapsulation reverses the process: it removes the ESP frame and returns the original input packet.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="ESP-Tunnel" />
<p class="caption">ESP-Tunnel</p>
</div>
<p>— Method <strong>encrypt:encapsulate_tunnel</strong> <em>packet</em>, <em>next_header</em></p>
<p>Encapsulates <em>packet</em> and encrypts its payload. The ESP header’s <em>Next Header</em> field is set to <em>next_header</em>. Takes ownership of <em>packet</em> and returns a new packet.</p>
<p>— Method <strong>decrypt:decapsulate_transport6</strong> <em>packet</em></p>
<p>Decapsulates <em>packet</em> and decrypts its payload. On success, takes ownership of <em>packet</em> and returns a new packet and the value of the ESP header’s <em>Next Header</em> field. Otherwise returns <code>nil</code>.</p>
<h4 id="transport-mode">Transport mode</h4>
<p>In transport mode, encapsulation accepts IPv6 packets and inserts a new ESP header between the outer IPv6 header and the inner protocol header (e.g. TCP, UDP, L2TPv3) and also encrypts the contents of the inner protocol header. Decapsulation does the reverse: it decrypts the inner protocol header and removes the ESP protocol header. In this mode it is expected that an Ethernet header precedes the outer IPv6 header.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="ESP-Transport" />
<p class="caption">ESP-Transport</p>
</div>
<p>— Method <strong>encrypt:encapsulate_transport6</strong> <em>packet</em></p>
<p>Encapsulates <em>packet</em> and encrypts its payload. On success, takes ownership of <em>packet</em> and returns a new packet. Otherwise returns <code>nil</code>.</p>
<p>— Method <strong>decrypt:decapsulate_transport6</strong> <em>packet</em></p>
<p>Decapsulates <em>packet</em> and decrypts its payload. On success, takes ownership of <em>packet</em> and returns a new packet. Otherwise returns <code>nil</code>.</p>
<h2 id="snabb-nfv">Snabb NFV</h2>
<h3 id="nfv-config-program.snabbnfv.nfvconfig">NFV config (program.snabbnfv.nfvconfig)</h3>
<p>The <code>program.snabbnfv.nfvconfig</code> module implements a <a href="https://en.wikipedia.org/wiki/Network_Functions_Virtualization">Network Functions Virtualization</a> component based on Snabb. It introduces a simple configuration file format to describe NFV configurations which it then compiles to app networks. This NFV component is compatible with <a href="https://wiki.openstack.org/wiki/Neutron">OpenStack Neutron</a>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="NFV" />
<p class="caption">NFV</p>
</div>
<p>— Function <strong>nfvconfig.load</strong> <em>file</em>, <em>pci_address</em>, <em>socket_path</em></p>
<p>Loads the NFV configuration from <em>file</em> and compiles an app network using <em>pci_address</em> and <em>socket_path</em> for the underlying NIC driver and <code>VhostUser</code> apps. Returns the resulting engine configuration.</p>
<h4 id="nfv-configuration-format">NFV Configuration Format</h4>
<p>The configuration file format understood by <code>program.snabbnfv.nfvconfig</code> is based on <em>Lua expressions</em>. Initially, it contains a list of NFV <em>ports</em>:</p>
<pre><code>return { &lt;port-1&gt;, ..., &lt;port-n&gt; }</code></pre>
<p>Each port is defined by a range of properties which correspond to the configuration parameters of the underlying apps (NIC driver, <code>VhostUser</code>, <code>PcapFilter</code>, <code>RateLimiter</code>, <code>nd_light</code> and <code>SimpleKeyedTunnel</code>):</p>
<pre><code>port := { port_id        = &lt;id&gt;,          -- A unique string
          mac_address    = &lt;mac-address&gt;, -- MAC address as a string
          vlan           = &lt;vlan-id&gt;,     -- ..
          ingress_filter = &lt;filter&gt;,       -- A pcap-filter(7) expression
          egress_filter  = &lt;filter&gt;,       -- ..
          tunnel         = &lt;tunnel-conf&gt;,
          crypto         = &lt;crypto-conf&gt;,
          rx_police      = &lt;n&gt;,           -- Allowed input rate in Gbps
          tx_police      = &lt;n&gt; }          -- Allowed output rate in Gbps</code></pre>
<p>The <code>tunnel</code> section deviates a little from <code>SimpleKeyedTunnel</code>’s terminology:</p>
<pre><code>tunnel := { type          = &quot;L2TPv3&quot;,     -- The only type (for now)
            local_cookie  = &lt;cookie&gt;,     -- As for SimpleKeyedTunnel
            remote_cookie = &lt;cookie&gt;,     -- ..
            next_hop      = &lt;ip-address&gt;, -- Gateway IP
            local_ip      = &lt;ip-address&gt;, -- ~ `local_address'
            remote_ip     = &lt;ip-address&gt;, -- ~ `remote_address'
            session       = &lt;32bit-int&gt; } -- ~ `session_id'</code></pre>
<p>The <code>crypto</code> section allows configuration of traffic encryption based on <code>apps.ipsec.esp</code>:</p>
<pre><code>crypto := { type          = &quot;esp-aes-128-gcm&quot;, -- The only type (for now)
            spi           = &lt;spi&gt;,             -- As for AES128gcm
            transmit_key  = &lt;key&gt;,
            transmit_salt = &lt;salt&gt;,
            receive_key   = &lt;key&gt;,
            receive_salt  = &lt;salt&gt;,
            auditing      = &lt;boolean&gt; }</code></pre>
<h3 id="snabbnfv-traffic">snabbnfv traffic</h3>
<p>The <code>snabbnfv traffic</code> program loads and runs a NFV configuration using <code>program.snabbnfv.nfvconfig</code>. It can be invoked like so:</p>
<pre><code>./snabb snabbnfv traffic &lt;file&gt; &lt;pci-address&gt; &lt;socket-path&gt;</code></pre>
<p><code>snabbnfv traffic</code> runs the loaded configuration indefinitely and automatically reloads the configuration file if it changes (at most once every second).</p>
<h3 id="snabbnfv-neutron2snabb">snabbnfv neutron2snabb</h3>
<p>The <code>snabbnfv neutron2snabb</code> program converts Neutron database CSV dumps to the format used by <code>program.snabbnfv.nfvconfig</code>. For more info see <a href="doc/architecture.md">Snabb NFV Architecture</a>. It can be invoked like so:</p>
<pre><code>./snabb snabbnfv neutron2snabb &lt;csv-directory&gt; &lt;output-directory&gt; [&lt;hostname&gt;]</code></pre>
<p><code>snabbnfv neutron2snabb</code> reads the Neutron configuration <em>csv-directory</em> and translates them to one <code>lib.nfv.conig</code> configuration file per physical network. If <em>hostname</em> is given, it overrides the hostname provided by <code>hostname(1)</code>.</p>
<h2 id="lisper">LISPER</h2>
<h3 id="lisper-program.lisper">LISPER (program.lisper)</h3>
<p>Snabb Switch program for overlaying Ethernet networks on the IPv6 Internet or a local IPv6 network. For transporting L2 networks over the Internet, LISPER requires the use of external LISP (RFC 6830) controllers.</p>
<h4 id="overview-1">Overview</h4>
<p>LISPER transports L2 networks over an IPv6 network by connecting together Ethernet networks and L2TPv3 point-to-point tunnels that are on different locations on the transport network.</p>
<p>Each location runs an instance of LISPER and an instance of a LISP controller to which multiple network interfaces can be connected.</p>
<p>Some of the interfaces can connect to physical Ethernet networks, others can connect to IPv6 networks (routed or not). The IPv6 interfaces carry packets to/from L2TPv3 tunnels and to/from remote LISPER instances. The same IPv6 interface can connect to multiple tunnels and/or LISPER instances so a single interface is sufficient to connect everything at one location, unless there are direct Etherent networks which need connecting too which require separate interfaces.</p>
<p>LISPER can work with to any Linux eth interface via raw sockets or it can use its built-in Intel10G driver to work with Intel 82599 network cards directly. The Intel10G driver also supports 802.1Q which allows multiple virtual interfaces to be configured on a single network card.</p>
<h4 id="download">Download</h4>
<p>https://github.com/capr/snabbswitch/archive/master.zip</p>
<h4 id="compile">Compile</h4>
<pre><code>make</code></pre>
<h4 id="quick-demo">Quick Demo</h4>
<blockquote>
<p>Tested on Ubuntu 14.04 and NixOS 15.09.</p>
</blockquote>
<pre><code>cd src/program/lisper/dev-env

./net-bringup      # create a test network and start everything
./ping-all         # run ping tests
./net-bringdown    # kill everything and clean up</code></pre>
<p><strong>NOTE:</strong> The test network creates network namespaces <code>r2</code> and <code>nodeN</code> where <code>N=01..08</code> so make sure you don’t use these namespaces already.</p>
<h4 id="run">Run</h4>
<pre><code>src/snabb lisper -c &lt;config.file&gt;</code></pre>
<h4 id="configure">Configure</h4>
<p>The config file is a JSON file that looks like this:</p>
<pre><code>{
   &quot;control_sock&quot; : &quot;/var/tmp/lisp-ipc-map-cache04&quot;,
   &quot;punt_sock&quot;    : &quot;/var/tmp/lispers.net-itr04&quot;,
   &quot;arp_timeout&quot;  : 60, // seconds

   &quot;interfaces&quot;: [
      { &quot;name&quot;: &quot;e0&quot;,  &quot;mac&quot;: &quot;00:00:00:00:01:04&quot;,
                        &quot;pci&quot;: &quot;0000:05:00.0&quot;, &quot;vlan_id&quot;: 2 },
      { &quot;name&quot;: &quot;e03&quot;, &quot;mac&quot;: &quot;00:00:00:00:01:03&quot; },
      { &quot;name&quot;: &quot;e13&quot;, &quot;mac&quot;: &quot;00:00:00:00:01:13&quot; }
   ],

   &quot;exits&quot;: [
      { &quot;name&quot;: &quot;e0&quot;, &quot;ip&quot;: &quot;fd80:4::2&quot;, &quot;interface&quot;: &quot;e0&quot;,
         &quot;next_hop&quot;: &quot;fd80:4::1&quot; }
   ],

   &quot;lispers&quot;: [
      { &quot;ip&quot;: &quot;fd80:8::2&quot;, &quot;exit&quot;: &quot;e0&quot; }
   ],

   &quot;local_networks&quot;: [
      { &quot;iid&quot;: 1, &quot;type&quot;: &quot;L2TPv3&quot;, &quot;ip&quot;: &quot;fd80:1::2&quot;, &quot;exit&quot;: &quot;e0&quot;,
         &quot;session_id&quot;: 1, &quot;cookie&quot;: &quot;&quot; },
      { &quot;iid&quot;: 1, &quot;type&quot;: &quot;L2TPv3&quot;, &quot;ip&quot;: &quot;fd80:2::2&quot;, &quot;exit&quot;: &quot;e0&quot;,
         &quot;session_id&quot;: 2, &quot;cookie&quot;: &quot;&quot; },
      { &quot;iid&quot;: 1, &quot;interface&quot;: &quot;e03&quot; },
      { &quot;iid&quot;: 1, &quot;interface&quot;: &quot;e13&quot; }
   ]
}</code></pre>
<p>Connectivity with the LISP controller requires <code>control_sock</code> and <code>punt_sock</code>, two named sockets that must be the same sockets that the LISP controller was configured with. These can be skipped if there’s no LISP controller.</p>
<p><code>interface</code> is an array defining the physical interfaces. <code>name</code> and <code>mac</code> are required. If <code>pci</code> is given, the Intel10G driver is used. If <code>vlan_id</code> is given, the interface is assumed to be a 802.1Q trunk.</p>
<p><code>exits</code> is an array defining the IPv6 exit points (if any) which are used for connecting to remote LISPER instances and to L2TPv3 tunnels. <code>name</code>, <code>ip</code>, <code>interface</code>, <code>next_hop</code> are all required fields.</p>
<p><code>lispers</code> is an array defining remote LISPER instances, if any. <code>ip</code> and <code>exit</code> are required.</p>
<p><code>local_networks</code> is an array defining the local L2 networks connected to this LISPER instance. These can be either local networks (in which case only <code>interface</code> is required) or L2TPv3 end-points (in which case <code>type</code> must be “L2TPv3”, and <code>ip</code>, <code>session_id</code>, <code>cookie</code> and <code>exit</code> are required).</p>
<p>–</p>
<h4 id="demotest-suite">Demo/Test Suite</h4>
<h5 id="tldr">TL;DR</h5>
<pre><code>cd src/program/lisper/dev-env

./net-bringup             # create a test network and start everything
./net-bringup-intel10g    # create a test network using Intel10G cards
./ping-all                # run ping tests
./nsnode N                # get a shell in the network namespace of a node
./nsr2                    # get a shell in the network namespace of R2
./net-teardown            # kill everything and clean up</code></pre>
<p><strong>NOTE:</strong> <code>net-bringup-intel10g</code> requires 4 network cards with loopback cables between cards 1,2 and 3,4. Edit the script to set their names and PCI addresses and also edit <code>lisperXX.conf.intel10g</code> config files and change the <code>pci</code> and <code>vlan_id</code> fields as needed. You can find the PCI addresses of the cards in your machine with <code>lspci | grep 82599</code>.</p>
<p><code>./ping-all</code> sends 2000 IPv4 pings 1000-byte each between various nodes. It’s output should look like this:</p>
<pre><code>l2tp-l2tp
2000 packets transmitted, 2000 received, 0% packet loss, time 443ms
2000 packets transmitted, 2000 received, 0% packet loss, time 603ms
l2tp-eth
2000 packets transmitted, 2000 received, 0% packet loss, time 358ms
2000 packets transmitted, 2000 received, 0% packet loss, time 502ms
eth-l2tp
2000 packets transmitted, 2000 received, 0% packet loss, time 354ms
2000 packets transmitted, 2000 received, 0% packet loss, time 507ms
l2tp-lisper-l2tp
2000 packets transmitted, 2000 received, 0% packet loss, time 1026ms
2000 packets transmitted, 2000 received, 0% packet loss, time 1037ms
eth-lisper-eth
2000 packets transmitted, 2000 received, 0% packet loss, time 926ms
2000 packets transmitted, 2000 received, 0% packet loss, time 876ms</code></pre>
<h5 id="what-does-it-do">What does it do</h5>
<p>The test network is comprised of multiple network nodes that are all connected to an R2 IPv6 router. The nodes are in different network namespaces and are assigned IPs in different IPv6 subnets to simulate physical locations.</p>
<p>Node namespaces are named <code>nodeXX</code> where XX is 01, 02, 04, 05, 06 and 08. The router lives in the <code>r2</code> namespace.</p>
<p>Nodes 01, 02, 05, 06 each contain both endpoints of an L2TPv3 tunnel.</p>
<p>Nodes 04, 08 each contain one LISPER instance and one local Ethernet network.</p>
<p>Each node has at least one interface in the L2 overlay network with ip 10.0.0.N/24. You should be able to ping between any of them (see <code>ping-all</code>).</p>
<p>Note the speed differences between nodes. The worst case is if you go to node 01 (which contains 10.0.0.1 which is a L2TPv3 tunnel) and from there ping 10.0.0.5 (which is itself on a L2TPv3 tunnel on a remote LISPER).</p>
<h4 id="bugs-and-limitations">Bugs and Limitations</h4>
<ul>
<li>encryption between LISPER nodes is not implemented.</li>
<li>L2 multicast is not implemented.</li>
<li><code>arp_timeout</code> config option is not followed.</li>
<li>more testing with MAC addresses moving between locations is required.</li>
<li>more performance testing and tuning is required.</li>
<li>only one IPv6 exit-point per interface is supported.</li>
</ul>
<h2 id="ptree">Ptree</h2>
<h3 id="ptree-program.ptree">Ptree (program.ptree)</h3>
<p>Example Snabb program for prototyping multi-process YANG-based network functions.</p>
<h4 id="overview-2">Overview</h4>
<p>The <a href="../../lib/ptree/README.md"><code>lib.ptree</code></a> facility in Snabb allows network engineers to build a network function out of a tree of processes described by a <a href="../../lib/yang/README.md">YANG schema</a>. The root process runs the management plane, and the leaf processes (the “workers”) run the data plane. The apps and links in the workers are declaratively created as a function of a YANG configuration.</p>
<p>This <code>snabb ptree</code> program is a tool to allow quick prototyping of network functions using the ptree facilities. The invocation syntax of <code>snabb ptree</code> is as follows:</p>
<pre><code>snabb ptree [OPTION...] SCHEMA.YANG SETUP.LUA CONF</code></pre>
<p>The <em>schema.yang</em> file contains a YANG schema describing the network function’s configuration. <em>setup.lua</em> defines a Lua function mapping a configuration to apps and links for a set of worker processes. <em>conf</em> is the initial configuration of the network function.</p>
<h4 id="example-simple-packet-filter">Example: Simple packet filter</h4>
<p>Let’s say we’re going to make a packet filter application. We can use Snabb’s built-in support for filters expressed in pflang, the language used by <code>tcpdump</code>, and just hook that filter up to a full-duplex NIC.</p>
<p>To begin with, we have to think about how to represent the configuration of the network function. If we simply want to be able to specify the PCI device of a NIC, an RSS queue, and a filter string, we could describe it with a YANG schema like this:</p>
<pre class="yang"><code>module snabb-pf-v1 {
  namespace snabb:pf-v1;
  prefix pf-v1;

  leaf device { type string; mandatory true; }
  leaf rss-queue { type uint8; default 0; }
  leaf filter { type string; default &quot;&quot;; }
}</code></pre>
<p>We throw this into a file <code>pf-v1.yang</code>. In YANG, a <code>module</code>’s body contains configuration declarations, most importantly <code>leaf</code>, <code>container</code>, and <code>list</code>. In our <code>snabb-pf-v1</code> schema, there is a <code>module</code> containing three <code>leaf</code>s: <code>device</code>, <code>rss-queue</code>, and <code>filter</code>. Snabb effectively generates a validating parser for configurations following this YANG schema; a configuration file must contain exactly one <code>device FOO;</code> declaration and may contain one <code>rss-queue</code> statement and one <code>filter</code> statement. Thus a concrete configuration following this YANG schema might look like this:</p>
<pre><code>device 83:00.0;
rss-queue 0;
filter &quot;tcp port 80&quot;;</code></pre>
<p>So let’s just drop that into a file <code>pf-v1.cfg</code> and use that as our initial configuration.</p>
<p>Now we just need to map from this configuration to app graphs in some set of workers. The <em>setup.lua</em> file should define this function.</p>
<pre><code>-- Function taking a snabb-pf-v1 configuration and
-- returning a table mapping worker ID to app graph.
return function (conf)
   -- Write me :)
end</code></pre>
<p>The <code>conf</code> parameter to the setup function is a Lua representation of config data for this network function. In our case it will be a table containing the keys <code>device</code>, <code>rss_queue</code>, and <code>filter</code>. (Note that Snabb’s YANG support maps dashes to underscores for the Lua data, so it really is <code>rss_queue</code> and not <code>rss-queue</code>.)</p>
<p>The return value of the setup function is a table whose keys are “worker IDs”, and whose values are the corresponding app graphs. A worker ID can be any Lua value, for example a number or a string or whatever. If the user later reconfigures the network function (perhaps setting a different filter string), the manager will re-run the setup function to produce a new set of worker IDs and app graphs. The manager will then stop workers whose ID is no longer present, start new workers, and reconfigure workers whose ID is still present.</p>
<p>In our case we’re just going to have one worker, so we can use any worker ID. If the user reconfigures the filter but keeps the same device and RSS queue, we don’t want to interrupt packet flow, so we want to use a worker ID that won’t change. But if the user changes the device, probably we do want to restart the worker, so maybe we make the worker ID a function of the device name.</p>
<p>With all of these considerations, we are ready to actually write the setup function.</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> app_graph <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'core.config'</span><span class="ot">)</span>
<span class="kw">local</span> pci <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'lib.hardware.pci'</span><span class="ot">)</span>
<span class="kw">local</span> pcap_filter <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'apps.packet_filter.pcap_filter'</span><span class="ot">)</span>

<span class="co">-- Function taking a snabb-pf-v1 configuration and</span>
<span class="co">-- returning a table mapping worker ID to app graph.</span>
<span class="kw">return</span> <span class="kw">function</span> <span class="ot">(</span>conf<span class="ot">)</span>
   <span class="co">-- Load NIC driver for PCI address.</span>
   <span class="kw">local</span> device_info <span class="ot">=</span> pci<span class="ot">.</span>device_info<span class="ot">(</span>conf<span class="ot">.</span>device<span class="ot">)</span>
   <span class="kw">local</span> driver <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span>device_info<span class="ot">.</span>driver<span class="ot">).</span>driver

   <span class="co">-- Make a new app graph for this configuration.</span>
   <span class="kw">local</span> graph <span class="ot">=</span> app_graph<span class="ot">.</span>new<span class="ot">()</span>
   app_graph<span class="ot">.</span>app<span class="ot">(</span>graph<span class="ot">,</span> <span class="st">&quot;nic&quot;</span><span class="ot">,</span> driver<span class="ot">,</span>
                 <span class="ot">{</span>pciaddr<span class="ot">=</span>conf<span class="ot">.</span>device<span class="ot">,</span> rxq<span class="ot">=</span>conf<span class="ot">.</span>rss_queue<span class="ot">,</span>
                  txq<span class="ot">=</span>conf<span class="ot">.</span>rss_queue<span class="ot">})</span>
   app_graph<span class="ot">.</span>app<span class="ot">(</span>graph<span class="ot">,</span> <span class="st">&quot;filter&quot;</span><span class="ot">,</span> pcap_filter<span class="ot">.</span>PcapFilter<span class="ot">,</span>
                 <span class="ot">{</span>filter<span class="ot">=</span>conf<span class="ot">.</span>filter<span class="ot">})</span>
   app_graph<span class="ot">.</span>link<span class="ot">(</span>graph<span class="ot">,</span> <span class="st">&quot;nic.&quot;</span><span class="ot">..</span>device_info<span class="ot">.</span>tx<span class="ot">..</span><span class="st">&quot; -&gt; filter.input&quot;</span><span class="ot">)</span>
   app_graph<span class="ot">.</span>link<span class="ot">(</span>graph<span class="ot">,</span> <span class="st">&quot;filter.output -&gt; nic.&quot;</span><span class="ot">..</span>device_info<span class="ot">.</span>rx<span class="ot">)</span>

   <span class="co">-- Use DEVICE/QUEUE as the worker ID.</span>
   <span class="kw">local</span> id <span class="ot">=</span> conf<span class="ot">.</span>device<span class="ot">..</span><span class="st">'/'</span><span class="ot">..</span>conf<span class="ot">.</span>rss_queue

   <span class="co">-- One worker with the given ID and the given app graph.</span>
   <span class="kw">return</span> <span class="ot">{[</span>id<span class="ot">]=</span>graph<span class="ot">}</span>
<span class="kw">end</span></code></pre></div>
<p>Put this in, say, <code>pf-v1.lua</code>, and we’re good to go. The network function can be run like this:</p>
<pre><code>$ snabb ptree --name my-filter pf-v1.yang pf-v1.lua pf-v1.cfg</code></pre>
<p>See <a href="./README"><code>snabb ptree --help</code></a> for full details on arguments like <code>--name</code>.</p>
<h4 id="tuning">Tuning</h4>
<p>The <code>snabb ptree</code> program also takes a number of options that apply to the data-plane processes.</p>
<p>— <strong>–cpu</strong> <em>cpus</em></p>
<p>Allocate <em>cpus</em> to the data-plane processes. The manager of the process tree will allocate CPUs from this set to data-plane workers. For example, For example, <code>--cpu 3-5,7-9</code> assigns CPUs 3, 4, 5, 7, 8, and 9 to the network function. The manager will try to allocate a CPU for a worker that is NUMA-local to the PCI devices used by the worker.</p>
<p>— <strong>–real-time</strong></p>
<p>Use the <code>SCHED_FIFO</code> real-time scheduler for the data-plane processes.</p>
<p>— <strong>–on-ingress-drop</strong> <em>action</em></p>
<p>If a data-plane process detects too many dropped packets (by default, 100K packets over 30 seconds), perform <em>action</em>. Available <em>action</em>s are <code>flush</code>, which tells Snabb to re-optimize the code; <code>warn</code>, which simply prints a warning and raises an alarm; and <code>off</code>, which does nothing.</p>
<p>— <strong>-j</strong> <em>arg</em></p>
<p>Enable profiling in the data-plane. Useful when you are trying to isolate a performance problem. It is thought that this will be reworked when Snabb switches to RaptorJIT, so we leave this somewhat complicated option undocumented at present :)</p>
<h4 id="reconfiguration">Reconfiguration</h4>
<p>The manager of a ptree-based Snabb network function also listens to configuration queries and updates on a local socket. The user-facing side of this interface is <a href="../config/README.md"><code>snabb config</code></a>. A <code>snabb config</code> user can address a local ptree network function by PID, but it’s easier to do so by name, so the above example passed <code>--name my-filter</code> to the <code>snabb ptree</code> invocation.</p>
<p>For example, we can get the configuration of a running network function with <code>snabb config get</code>:</p>
<pre><code>$ snabb config get my-filter /
device 83:00.0;
rss-queue 0;
filter &quot;tcp port 80&quot;;</code></pre>
<p>You can also update the configuration. For example, to move this network function over to device <code>82:00.0</code>, do:</p>
<pre><code>$ snabb config set my-filter /device 82:00.0
$ snabb config get my-filter /
device 82:00.0;
rss-queue 0;
filter &quot;tcp port 80&quot;;</code></pre>
<p>The ptree manager takes the necessary actions to update the dataplane to match the specified configuration.</p>
<h4 id="multi-process">Multi-process</h4>
<p>Let’s say your clients are really loving this network function, so much so that they are running an instance on each network card on your server. Whenever the filter string updates though they are getting tired of having to <code>snabb config set</code> all of the different processes. Well you can make them even happier by refactoring the network function to be multi-process.</p>
<pre class="yang"><code>module snabb-pf-v2 {
  namespace snabb:pf-v2;
  prefix pf-v2;

  /* Default filter string.  */
  leaf filter { type string; default &quot;&quot;; }

  list worker {
    key &quot;device rss-queue&quot;;
    leaf device { type string; }
    leaf rss-queue { type uint8; }
    /* Optional worker-specific filter string.  */
    leaf filter { type string; }
  }
}</code></pre>
<p>Here we declare a new YANG model that instead of having one device and RSS queue, it has a whole list of them. The <code>key &quot;device rss-queue&quot;</code> declaration says that the combination of device and RSS queue should be unique – you can’t have two different workers on the same device+queue pair, logically. We declare a default <code>filter</code> at the top level, and also allow each worker to override with their own filter declaration.</p>
<p>A configuration might look like this:</p>
<pre><code>filter &quot;tcp port 80&quot;;
worker {
  device 83:00.0;
  rss-queue 0;
}
worker {
  device 83:00.0;
  rss-queue 1;
}
worker {
  device 83:00.1;
  rss-queue 0;
  filter &quot;tcp port 443&quot;;
}
worker {
  device 83:00.1;
  rss-queue 1;
  filter &quot;tcp port 443&quot;;
}</code></pre>
<p>Finally, we need a new setup function as well:</p>
<div class="sourceCode"><pre class="sourceCode lua"><code class="sourceCode lua"><span class="kw">local</span> app_graph <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'core.config'</span><span class="ot">)</span>
<span class="kw">local</span> pci <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'lib.hardware.pci'</span><span class="ot">)</span>
<span class="kw">local</span> pcap_filter <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span><span class="st">'apps.packet_filter.pcap_filter'</span><span class="ot">)</span>

<span class="co">-- Function taking a snabb-pf-v2 configuration and</span>
<span class="co">-- returning a table mapping worker ID to app graph.</span>
<span class="kw">return</span> <span class="kw">function</span> <span class="ot">(</span>conf<span class="ot">)</span>
   <span class="kw">local</span> workers <span class="ot">=</span> <span class="ot">{}</span>
   <span class="kw">for</span> k<span class="ot">,</span> v <span class="kw">in</span> <span class="fu">pairs</span><span class="ot">(</span>conf<span class="ot">.</span>worker<span class="ot">)</span> <span class="kw">do</span>
      <span class="co">-- Load NIC driver for PCI address.</span>
      <span class="kw">local</span> device_info <span class="ot">=</span> pci<span class="ot">.</span>device_info<span class="ot">(</span>k<span class="ot">.</span>device<span class="ot">)</span>
      <span class="kw">local</span> driver <span class="ot">=</span> <span class="fu">require</span><span class="ot">(</span>device_info<span class="ot">.</span>driver<span class="ot">).</span>driver

      <span class="co">-- Make a new app graph for this worker.</span>
      <span class="kw">local</span> graph <span class="ot">=</span> app_graph<span class="ot">.</span>new<span class="ot">()</span>
      app_graph<span class="ot">.</span>app<span class="ot">(</span>graph<span class="ot">,</span> <span class="st">&quot;nic&quot;</span><span class="ot">,</span> driver<span class="ot">,</span>
                    <span class="ot">{</span>pciaddr<span class="ot">=</span>k<span class="ot">.</span>device<span class="ot">,</span> rxq<span class="ot">=</span>k<span class="ot">.</span>rss_queue<span class="ot">,</span>
                     txq<span class="ot">=</span>k<span class="ot">.</span>rss_queue<span class="ot">})</span>
      app_graph<span class="ot">.</span>app<span class="ot">(</span>graph<span class="ot">,</span> <span class="st">&quot;filter&quot;</span><span class="ot">,</span> pcap_filter<span class="ot">.</span>PcapFilter<span class="ot">,</span>
                    <span class="ot">{</span>filter<span class="ot">=</span>v<span class="ot">.</span>filter <span class="kw">or</span> conf<span class="ot">.</span>filter<span class="ot">})</span>
      app_graph<span class="ot">.</span>link<span class="ot">(</span>graph<span class="ot">,</span> <span class="st">&quot;nic.&quot;</span><span class="ot">..</span>device_info<span class="ot">.</span>tx<span class="ot">..</span><span class="st">&quot; -&gt; filter.input&quot;</span><span class="ot">)</span>
      app_graph<span class="ot">.</span>link<span class="ot">(</span>graph<span class="ot">,</span> <span class="st">&quot;filter.output -&gt; nic.&quot;</span><span class="ot">..</span>device_info<span class="ot">.</span>rx<span class="ot">)</span>

      <span class="co">-- Use DEVICE/QUEUE as the worker ID.</span>
      <span class="kw">local</span> id <span class="ot">=</span> k<span class="ot">.</span>device<span class="ot">..</span><span class="st">'/'</span><span class="ot">..</span>k<span class="ot">.</span>rss_queue

      <span class="co">-- Add worker with the given ID and the given app graph.</span>
      workers<span class="ot">[</span>id<span class="ot">]</span> <span class="ot">=</span> graph
   <span class="kw">end</span>
   <span class="kw">return</span> workers
<span class="kw">end</span></code></pre></div>
<p>If we place these into analogously named files, we have a multiprocess network function:</p>
<pre><code>$ snabb ptree --name my-filter pf-v2.yang pf-v2.lua pf-v2.cfg</code></pre>
<p>If you change the root filter string via <code>snabb config</code>, it propagates to all workers, except those that have their own overrides of course:</p>
<pre><code>$ snabb config set my-filter /filter &quot;'tcp port 666'&quot;
$ snabb config get my-filter /filter
&quot;tcp port 666&quot;</code></pre>
<p>The syntax to get at a particular worker is a little gnarly; it’s based on XPath, for compatibility with existing NETCONF NCS systems. See <a href="../config/README.md">the <code>snabb config</code> documentation</a> for full details.</p>
<pre><code>$ snabb config get my-filter '/worker[device=83:00.1][rss-queue=1]'
filter &quot;tcp port 443&quot;;</code></pre>
<p>You can stop a worker with <code>snabb config remove</code>:</p>
<pre><code>$ snabb config remove my-filter '/worker[device=83:00.1][rss-queue=1]'
$ snabb config get my-filter /
filter &quot;tcp port 666&quot;;
worker {
  device 83:00.0;
  rss-queue 0;
}
worker {
  device 83:00.0;
  rss-queue 1;
}
worker {
  device 83:00.1;
  rss-queue 0;
  filter &quot;tcp port 443&quot;;
}</code></pre>
<p>Start up a new one with <code>snabb config add</code>:</p>
<pre><code>$ snabb config add my-filter /worker &lt;&lt;EOF
{
  device 83:00.1;
  rss-queue 1;
  filter &quot;tcp port 8000&quot;;
}
EOF</code></pre>
<p>Voilà! Now your clients will think you are a wizard!</p>
<h2 id="watchdog-lib.watchdog.watchdog">Watchdog (lib.watchdog.watchdog)</h2>
<p>The <code>lib.watchdog.watchdog</code> module implements a per-thread watchdog functionality. Its purpose is to watch and kill processes which fail to call the watchdog periodically (e.g. hang).</p>
<p>It does so by using <em>alarm(3)</em> and <em>ualarm(3)</em> to have the OS send a <em>SIGALRM</em> to the process after a specified timeout. Because the process does not handle the signal it will be killed and exit with status <em>142</em>.</p>
<p>— Function <strong>watchdog.set</strong> <em>milliseconds</em></p>
<p>Set watchdog timeout to <em>milliseconds</em>. Values for <em>milliseconds</em> greater than 1,000 are truncated to the next second. For example:</p>
<pre><code>watchdog.set(1100) == watchdog.set(2000)</code></pre>
<p>— Function <strong>watchdog.reset</strong></p>
<p>Starts the timout if the watchdog has not yet been started and resets the timeout otherwise. If the timeout is reached the process will be killed.</p>
<p>— Function <strong>watchdog.stop</strong></p>
<p>Disables the timeout.</p>
<h1 id="snabblab">Snabblab</h1>
<p>Servers devoted to the Snabb project and usable by all known developers.</p>
<p>Want to be a known developer? Sure! Just edit the <a href="https://github.com/snabblab/snabblab-nixos/blob/master/modules/users.nix">user account list</a> with your user and send a pull request. No fuss.</p>
<h2 id="guidelines">Guidelines</h2>
<ul>
<li>Feel at home. These servers are here for you to play with and enjoy.</li>
<li>Please run Snabb processes like this: <code>sudo lock ./snabb ...</code>. The <code>lock</code> command will automatically wait if somebody else is running a Snabb process on the same machine and that helps us avoid conflicts for access to hardware resources.</li>
<li>Tell <code>luke@snabb.co</code> your email address(es) to get an invitation to the <a href="http://snabb.slack.com/">Lab Slack</a>.</li>
<li>Don’t keep precious data on the servers. We might want to reinstall them at short notice.</li>
</ul>
<h2 id="servers">Servers</h2>
<table style="width:100%;">
<colgroup>
<col width="8%"></col>
<col width="34%"></col>
<col width="17%"></col>
<col width="6%"></col>
<col width="32%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Purpose</th>
<th align="left">SSH</th>
<th align="left">Intel CPU</th>
<th align="left">NICs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lugano-1</td>
<td align="left">General use</td>
<td align="left">lugano-1.snabb.co</td>
<td align="left">E5 1650v3</td>
<td align="left">2 x 10G (82599), 4 x 10G (X710), 2 x 40G (XL710)</td>
</tr>
<tr class="even">
<td align="left">lugano-2</td>
<td align="left">General use</td>
<td align="left">lugano-2.snabb.co</td>
<td align="left">E5 1650v3</td>
<td align="left">2 x 10G (82599), 4 x 10G (X710), 2 x 40G (XL710)</td>
</tr>
<tr class="odd">
<td align="left">lugano-3</td>
<td align="left">General use</td>
<td align="left">lugano-3.snabb.co</td>
<td align="left">E5 1650v3</td>
<td align="left">2 x 10G (82599), 2 x 100G (ConnectX-4)</td>
</tr>
<tr class="even">
<td align="left">lugano-4</td>
<td align="left">General use</td>
<td align="left">lugano-4.snabb.co</td>
<td align="left">E5 1650v3</td>
<td align="left">2 x 10G (82599), 2 x 100G (ConnectX-4)</td>
</tr>
<tr class="odd">
<td align="left">davos</td>
<td align="left">Continuous Integration tests &amp; driver development</td>
<td align="left">lab1.snabb.co port 2000</td>
<td align="left">2x E5 2603</td>
<td align="left">Diverse 10G/40G: Intel, SolarFlare, Mellanox, Chelsio, Broadcom. Installed upon request.</td>
</tr>
<tr class="even">
<td align="left">grindelwald</td>
<td align="left">Snabb NFV testing</td>
<td align="left">lab1.snabb.co port 2010</td>
<td align="left">2x E5 2697v2</td>
<td align="left">12 x 10G (Intel 82599)</td>
</tr>
<tr class="odd">
<td align="left">interlaken</td>
<td align="left">Haswell/AVX2 testing</td>
<td align="left">lab1.snabb.co port 2030</td>
<td align="left">2x E5 2620v3</td>
<td align="left">12 x 10G (Intel 82599)</td>
</tr>
<tr class="even">
<td align="left">murren-*</td>
<td align="left">Hydra fleet for tests without NICs</td>
<td align="left">(none)</td>
<td align="left">i7-6700</td>
<td align="left">(none)</td>
</tr>
</tbody>
</table>
<h2 id="get-started">Get started</h2>
<p>You are welcome to play, test, and develop on the <code>lugano-1</code> .. <code>lugano-4</code> servers. Once your account is added you can connect like this:</p>
<pre><code>$ ssh user@lugano-1.snabb.co</code></pre>
<p>and check the PCI devices and their addresses with <code>lspci</code>.</p>
<p>Certain cards (82599 and ConnectX-4) are cabled to themselves. That is, dual-port cards have their ports connected to each other. Certain other cards (X710/XL710) are currently not cabled. If you have special cabling needs then please open an issue on the <a href="https://github.com/snabblab/snabblab-nixos">snabblab-nixos</a>.</p>
<h2 id="using-the-lab">Using the lab</h2>
<p>All servers run the latest stable version of <a href="http://nixos.org/nixos/about.html">NixOS Linux distribution</a>.</p>
<p>To quickly install a package:</p>
<pre><code>$ nox &lt;search string&gt;</code></pre>
<p>For other operations such as uninstalling a package, refer to <code>man nix-env</code>.</p>
<h2 id="questions">Questions</h2>
<p>If you have any questions or trouble, ask on <a href="https://snabb.slack.com/messages/lab/">the #lab channel</a> or <a href="https://github.com/snabblab/snabblab-nixos">open an issue</a>.</p>
<h2 id="thanks">Thanks</h2>
<p>We are grateful to <a href="http://www.silicom-usa.com/">Silicom</a> for their sponsorship in the form of discounted network cards for <code>chur</code> and to <a href="http://www.netgate.com/">Netgate</a> for giving us <code>jura</code>. Thanks gang!</p>
</body>
</html>
